<!DOCTYPE html>
<meta charset="utf-8">

<head>
  <script type="text/javascript" src="js/DataTables-1.10.4/media/js/jquery.js"></script>
  <script type="text/javascript" src="js/d3.v3.min.js"></script>
  <title>Small Logo Forest </title>
  <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
</head>


<style>

        .node {
                cursor: pointer;
        }

	.node circle {
		//fill: #fff;
		//stroke: steelblue;
		stroke-width: 2px;
	}


	.node {
		font: 12px sans-serif;
	}


	.link {
		fill: none;
		//stroke: #0D86D7;
		stroke-width: 1.5px;
	}
	
	svg {
		pointer-events: all;
		background-color: white;
		overflow: scroll;
	}

        #Logo_forest_header{
	   float: left;
	   margin: 7px 5px 7px 5px;
	   width: 1280px;
	   height: 380px;
	   position: relative;
	   display: block;
	   text-align: left;
	   clear : both;
	   color: black;
	   font-size: 16px;
	   border-radius:5px;
           background: #B1D4F9;
        }

	.legend {
	   text-align: left;
	   border-radius:5px;       
      	   text-align: center;
	   margin: 3px 5px 5px 5px;
	   width: 130px;
	   height: 20px;
	   padding: 4px;
	   cursor: pointer;
	   border-radius:5px;
           color: #ffffff;
           background:#cc0000;

	   display: inline-block;
	   position:relative;
	}

	.legend:active {
	   position:relative;
	   top:2px;
	}

</style>


<body>	

<div id="Logo_forest_header">
   <div><h2 style="text-align:center">Dynamic Logo Forest</h2></div>
   <ul>
      <li type="square" style="color:red;">We reccomend to use Firefox to display this page.</li>
      <li type="square">All the clusters with their respective motifs are represented as  a collection of hierarchical trees (Forest).</li>
      <li type="square">Each cluster has a different color and contains the following components:</li>
   </ul>
   <ol>
      <li>The hierarchical tree.</li>
      <li>At each collapsed node, the Branch motif (the summary of the descendant motifs of that branch, also known as Familial Binding Profile (FBP) ).</li>
      <li>The motif ID + other optional motif features are depicted in the leaves.</li>
      <li>The aligned logos are shown in the leaves.</li>
   </ol>
   <ul>
   <p><h3>Dynamic Features</h3>
      <ol>
         <li type="square">Click on each node to collapse it and display the Branch motif.</li>
         <li type="square">Click on the node again to expand the tree and show the descendant motifs.</li>
         <li type="square">Click on the buttons to change the logo (Direct|Reverse) orientation.</li>
         <li type="square">Click on the buttons to show the IC content at each branch.</li>
      </ol>
   </p>
   </ul>
</div>
.<br><br><br>

<div id="cluster_1" style="clear:both;border-left:100px;float:left;"><h2>cluster_1</h2></div>
<br><br><br>
<div id="cluster_10" style="clear:both;border-left:100px;float:left;"><h2>cluster_10</h2></div>
<br><br><br>
<div id="cluster_100" style="clear:both;border-left:100px;float:left;"><h2>cluster_100</h2></div>
<br><br><br>
<div id="cluster_101" style="clear:both;border-left:100px;float:left;"><h2>cluster_101</h2></div>
<br><br><br>
<div id="cluster_102" style="clear:both;border-left:100px;float:left;"><h2>cluster_102</h2></div>
<br><br><br>
<div id="cluster_103" style="clear:both;border-left:100px;float:left;"><h2>cluster_103</h2></div>
<br><br><br>
<div id="cluster_104" style="clear:both;border-left:100px;float:left;"><h2>cluster_104</h2></div>
<br><br><br>
<div id="cluster_105" style="clear:both;border-left:100px;float:left;"><h2>cluster_105</h2></div>
<br><br><br>
<div id="cluster_106" style="clear:both;border-left:100px;float:left;"><h2>cluster_106</h2></div>
<br><br><br>
<div id="cluster_107" style="clear:both;border-left:100px;float:left;"><h2>cluster_107</h2></div>
<br><br><br>
<div id="cluster_108" style="clear:both;border-left:100px;float:left;"><h2>cluster_108</h2></div>
<br><br><br>
<div id="cluster_109" style="clear:both;border-left:100px;float:left;"><h2>cluster_109</h2></div>
<br><br><br>
<div id="cluster_11" style="clear:both;border-left:100px;float:left;"><h2>cluster_11</h2></div>
<br><br><br>
<div id="cluster_110" style="clear:both;border-left:100px;float:left;"><h2>cluster_110</h2></div>
<br><br><br>
<div id="cluster_111" style="clear:both;border-left:100px;float:left;"><h2>cluster_111</h2></div>
<br><br><br>
<div id="cluster_112" style="clear:both;border-left:100px;float:left;"><h2>cluster_112</h2></div>
<br><br><br>
<div id="cluster_113" style="clear:both;border-left:100px;float:left;"><h2>cluster_113</h2></div>
<br><br><br>
<div id="cluster_114" style="clear:both;border-left:100px;float:left;"><h2>cluster_114</h2></div>
<br><br><br>
<div id="cluster_115" style="clear:both;border-left:100px;float:left;"><h2>cluster_115</h2></div>
<br><br><br>
<div id="cluster_116" style="clear:both;border-left:100px;float:left;"><h2>cluster_116</h2></div>
<br><br><br>
<div id="cluster_117" style="clear:both;border-left:100px;float:left;"><h2>cluster_117</h2></div>
<br><br><br>
<div id="cluster_118" style="clear:both;border-left:100px;float:left;"><h2>cluster_118</h2></div>
<br><br><br>
<div id="cluster_119" style="clear:both;border-left:100px;float:left;"><h2>cluster_119</h2></div>
<br><br><br>
<div id="cluster_12" style="clear:both;border-left:100px;float:left;"><h2>cluster_12</h2></div>
<br><br><br>
<div id="cluster_120" style="clear:both;border-left:100px;float:left;"><h2>cluster_120</h2></div>
<br><br><br>
<div id="cluster_121" style="clear:both;border-left:100px;float:left;"><h2>cluster_121</h2></div>
<br><br><br>
<div id="cluster_122" style="clear:both;border-left:100px;float:left;"><h2>cluster_122</h2></div>
<br><br><br>
<div id="cluster_123" style="clear:both;border-left:100px;float:left;"><h2>cluster_123</h2></div>
<br><br><br>
<div id="cluster_124" style="clear:both;border-left:100px;float:left;"><h2>cluster_124</h2></div>
<br><br><br>
<div id="cluster_125" style="clear:both;border-left:100px;float:left;"><h2>cluster_125</h2></div>
<br><br><br>
<div id="cluster_126" style="clear:both;border-left:100px;float:left;"><h2>cluster_126</h2></div>
<br><br><br>
<div id="cluster_127" style="clear:both;border-left:100px;float:left;"><h2>cluster_127</h2></div>
<br><br><br>
<div id="cluster_128" style="clear:both;border-left:100px;float:left;"><h2>cluster_128</h2></div>
<br><br><br>
<div id="cluster_129" style="clear:both;border-left:100px;float:left;"><h2>cluster_129</h2></div>
<br><br><br>
<div id="cluster_13" style="clear:both;border-left:100px;float:left;"><h2>cluster_13</h2></div>
<br><br><br>
<div id="cluster_130" style="clear:both;border-left:100px;float:left;"><h2>cluster_130</h2></div>
<br><br><br>
<div id="cluster_131" style="clear:both;border-left:100px;float:left;"><h2>cluster_131</h2></div>
<br><br><br>
<div id="cluster_132" style="clear:both;border-left:100px;float:left;"><h2>cluster_132</h2></div>
<br><br><br>
<div id="cluster_133" style="clear:both;border-left:100px;float:left;"><h2>cluster_133</h2></div>
<br><br><br>
<div id="cluster_134" style="clear:both;border-left:100px;float:left;"><h2>cluster_134</h2></div>
<br><br><br>
<div id="cluster_135" style="clear:both;border-left:100px;float:left;"><h2>cluster_135</h2></div>
<br><br><br>
<div id="cluster_136" style="clear:both;border-left:100px;float:left;"><h2>cluster_136</h2></div>
<br><br><br>
<div id="cluster_137" style="clear:both;border-left:100px;float:left;"><h2>cluster_137</h2></div>
<br><br><br>
<div id="cluster_138" style="clear:both;border-left:100px;float:left;"><h2>cluster_138</h2></div>
<br><br><br>
<div id="cluster_139" style="clear:both;border-left:100px;float:left;"><h2>cluster_139</h2></div>
<br><br><br>
<div id="cluster_14" style="clear:both;border-left:100px;float:left;"><h2>cluster_14</h2></div>
<br><br><br>
<div id="cluster_140" style="clear:both;border-left:100px;float:left;"><h2>cluster_140</h2></div>
<br><br><br>
<div id="cluster_141" style="clear:both;border-left:100px;float:left;"><h2>cluster_141</h2></div>
<br><br><br>
<div id="cluster_142" style="clear:both;border-left:100px;float:left;"><h2>cluster_142</h2></div>
<br><br><br>
<div id="cluster_143" style="clear:both;border-left:100px;float:left;"><h2>cluster_143</h2></div>
<br><br><br>
<div id="cluster_144" style="clear:both;border-left:100px;float:left;"><h2>cluster_144</h2></div>
<br><br><br>
<div id="cluster_145" style="clear:both;border-left:100px;float:left;"><h2>cluster_145</h2></div>
<br><br><br>
<div id="cluster_146" style="clear:both;border-left:100px;float:left;"><h2>cluster_146</h2></div>
<br><br><br>
<div id="cluster_147" style="clear:both;border-left:100px;float:left;"><h2>cluster_147</h2></div>
<br><br><br>
<div id="cluster_148" style="clear:both;border-left:100px;float:left;"><h2>cluster_148</h2></div>
<br><br><br>
<div id="cluster_149" style="clear:both;border-left:100px;float:left;"><h2>cluster_149</h2></div>
<br><br><br>
<div id="cluster_15" style="clear:both;border-left:100px;float:left;"><h2>cluster_15</h2></div>
<br><br><br>
<div id="cluster_150" style="clear:both;border-left:100px;float:left;"><h2>cluster_150</h2></div>
<br><br><br>
<div id="cluster_151" style="clear:both;border-left:100px;float:left;"><h2>cluster_151</h2></div>
<br><br><br>
<div id="cluster_152" style="clear:both;border-left:100px;float:left;"><h2>cluster_152</h2></div>
<br><br><br>
<div id="cluster_153" style="clear:both;border-left:100px;float:left;"><h2>cluster_153</h2></div>
<br><br><br>
<div id="cluster_154" style="clear:both;border-left:100px;float:left;"><h2>cluster_154</h2></div>
<br><br><br>
<div id="cluster_155" style="clear:both;border-left:100px;float:left;"><h2>cluster_155</h2></div>
<br><br><br>
<div id="cluster_156" style="clear:both;border-left:100px;float:left;"><h2>cluster_156</h2></div>
<br><br><br>
<div id="cluster_157" style="clear:both;border-left:100px;float:left;"><h2>cluster_157</h2></div>
<br><br><br>
<div id="cluster_158" style="clear:both;border-left:100px;float:left;"><h2>cluster_158</h2></div>
<br><br><br>
<div id="cluster_159" style="clear:both;border-left:100px;float:left;"><h2>cluster_159</h2></div>
<br><br><br>
<div id="cluster_16" style="clear:both;border-left:100px;float:left;"><h2>cluster_16</h2></div>
<br><br><br>
<div id="cluster_160" style="clear:both;border-left:100px;float:left;"><h2>cluster_160</h2></div>
<br><br><br>
<div id="cluster_161" style="clear:both;border-left:100px;float:left;"><h2>cluster_161</h2></div>
<br><br><br>
<div id="cluster_162" style="clear:both;border-left:100px;float:left;"><h2>cluster_162</h2></div>
<br><br><br>
<div id="cluster_163" style="clear:both;border-left:100px;float:left;"><h2>cluster_163</h2></div>
<br><br><br>
<div id="cluster_17" style="clear:both;border-left:100px;float:left;"><h2>cluster_17</h2></div>
<br><br><br>
<div id="cluster_18" style="clear:both;border-left:100px;float:left;"><h2>cluster_18</h2></div>
<br><br><br>
<div id="cluster_19" style="clear:both;border-left:100px;float:left;"><h2>cluster_19</h2></div>
<br><br><br>
<div id="cluster_2" style="clear:both;border-left:100px;float:left;"><h2>cluster_2</h2></div>
<br><br><br>
<div id="cluster_20" style="clear:both;border-left:100px;float:left;"><h2>cluster_20</h2></div>
<br><br><br>
<div id="cluster_21" style="clear:both;border-left:100px;float:left;"><h2>cluster_21</h2></div>
<br><br><br>
<div id="cluster_22" style="clear:both;border-left:100px;float:left;"><h2>cluster_22</h2></div>
<br><br><br>
<div id="cluster_23" style="clear:both;border-left:100px;float:left;"><h2>cluster_23</h2></div>
<br><br><br>
<div id="cluster_24" style="clear:both;border-left:100px;float:left;"><h2>cluster_24</h2></div>
<br><br><br>
<div id="cluster_25" style="clear:both;border-left:100px;float:left;"><h2>cluster_25</h2></div>
<br><br><br>
<div id="cluster_26" style="clear:both;border-left:100px;float:left;"><h2>cluster_26</h2></div>
<br><br><br>
<div id="cluster_27" style="clear:both;border-left:100px;float:left;"><h2>cluster_27</h2></div>
<br><br><br>
<div id="cluster_28" style="clear:both;border-left:100px;float:left;"><h2>cluster_28</h2></div>
<br><br><br>
<div id="cluster_29" style="clear:both;border-left:100px;float:left;"><h2>cluster_29</h2></div>
<br><br><br>
<div id="cluster_3" style="clear:both;border-left:100px;float:left;"><h2>cluster_3</h2></div>
<br><br><br>
<div id="cluster_30" style="clear:both;border-left:100px;float:left;"><h2>cluster_30</h2></div>
<br><br><br>
<div id="cluster_31" style="clear:both;border-left:100px;float:left;"><h2>cluster_31</h2></div>
<br><br><br>
<div id="cluster_32" style="clear:both;border-left:100px;float:left;"><h2>cluster_32</h2></div>
<br><br><br>
<div id="cluster_33" style="clear:both;border-left:100px;float:left;"><h2>cluster_33</h2></div>
<br><br><br>
<div id="cluster_34" style="clear:both;border-left:100px;float:left;"><h2>cluster_34</h2></div>
<br><br><br>
<div id="cluster_35" style="clear:both;border-left:100px;float:left;"><h2>cluster_35</h2></div>
<br><br><br>
<div id="cluster_36" style="clear:both;border-left:100px;float:left;"><h2>cluster_36</h2></div>
<br><br><br>
<div id="cluster_37" style="clear:both;border-left:100px;float:left;"><h2>cluster_37</h2></div>
<br><br><br>
<div id="cluster_38" style="clear:both;border-left:100px;float:left;"><h2>cluster_38</h2></div>
<br><br><br>
<div id="cluster_39" style="clear:both;border-left:100px;float:left;"><h2>cluster_39</h2></div>
<br><br><br>
<div id="cluster_4" style="clear:both;border-left:100px;float:left;"><h2>cluster_4</h2></div>
<br><br><br>
<div id="cluster_40" style="clear:both;border-left:100px;float:left;"><h2>cluster_40</h2></div>
<br><br><br>
<div id="cluster_41" style="clear:both;border-left:100px;float:left;"><h2>cluster_41</h2></div>
<br><br><br>
<div id="cluster_42" style="clear:both;border-left:100px;float:left;"><h2>cluster_42</h2></div>
<br><br><br>
<div id="cluster_43" style="clear:both;border-left:100px;float:left;"><h2>cluster_43</h2></div>
<br><br><br>
<div id="cluster_44" style="clear:both;border-left:100px;float:left;"><h2>cluster_44</h2></div>
<br><br><br>
<div id="cluster_45" style="clear:both;border-left:100px;float:left;"><h2>cluster_45</h2></div>
<br><br><br>
<div id="cluster_46" style="clear:both;border-left:100px;float:left;"><h2>cluster_46</h2></div>
<br><br><br>
<div id="cluster_47" style="clear:both;border-left:100px;float:left;"><h2>cluster_47</h2></div>
<br><br><br>
<div id="cluster_48" style="clear:both;border-left:100px;float:left;"><h2>cluster_48</h2></div>
<br><br><br>
<div id="cluster_49" style="clear:both;border-left:100px;float:left;"><h2>cluster_49</h2></div>
<br><br><br>
<div id="cluster_5" style="clear:both;border-left:100px;float:left;"><h2>cluster_5</h2></div>
<br><br><br>
<div id="cluster_50" style="clear:both;border-left:100px;float:left;"><h2>cluster_50</h2></div>
<br><br><br>
<div id="cluster_51" style="clear:both;border-left:100px;float:left;"><h2>cluster_51</h2></div>
<br><br><br>
<div id="cluster_52" style="clear:both;border-left:100px;float:left;"><h2>cluster_52</h2></div>
<br><br><br>
<div id="cluster_53" style="clear:both;border-left:100px;float:left;"><h2>cluster_53</h2></div>
<br><br><br>
<div id="cluster_54" style="clear:both;border-left:100px;float:left;"><h2>cluster_54</h2></div>
<br><br><br>
<div id="cluster_55" style="clear:both;border-left:100px;float:left;"><h2>cluster_55</h2></div>
<br><br><br>
<div id="cluster_56" style="clear:both;border-left:100px;float:left;"><h2>cluster_56</h2></div>
<br><br><br>
<div id="cluster_57" style="clear:both;border-left:100px;float:left;"><h2>cluster_57</h2></div>
<br><br><br>
<div id="cluster_58" style="clear:both;border-left:100px;float:left;"><h2>cluster_58</h2></div>
<br><br><br>
<div id="cluster_59" style="clear:both;border-left:100px;float:left;"><h2>cluster_59</h2></div>
<br><br><br>
<div id="cluster_6" style="clear:both;border-left:100px;float:left;"><h2>cluster_6</h2></div>
<br><br><br>
<div id="cluster_60" style="clear:both;border-left:100px;float:left;"><h2>cluster_60</h2></div>
<br><br><br>
<div id="cluster_61" style="clear:both;border-left:100px;float:left;"><h2>cluster_61</h2></div>
<br><br><br>
<div id="cluster_62" style="clear:both;border-left:100px;float:left;"><h2>cluster_62</h2></div>
<br><br><br>
<div id="cluster_63" style="clear:both;border-left:100px;float:left;"><h2>cluster_63</h2></div>
<br><br><br>
<div id="cluster_64" style="clear:both;border-left:100px;float:left;"><h2>cluster_64</h2></div>
<br><br><br>
<div id="cluster_65" style="clear:both;border-left:100px;float:left;"><h2>cluster_65</h2></div>
<br><br><br>
<div id="cluster_66" style="clear:both;border-left:100px;float:left;"><h2>cluster_66</h2></div>
<br><br><br>
<div id="cluster_67" style="clear:both;border-left:100px;float:left;"><h2>cluster_67</h2></div>
<br><br><br>
<div id="cluster_68" style="clear:both;border-left:100px;float:left;"><h2>cluster_68</h2></div>
<br><br><br>
<div id="cluster_69" style="clear:both;border-left:100px;float:left;"><h2>cluster_69</h2></div>
<br><br><br>
<div id="cluster_7" style="clear:both;border-left:100px;float:left;"><h2>cluster_7</h2></div>
<br><br><br>
<div id="cluster_70" style="clear:both;border-left:100px;float:left;"><h2>cluster_70</h2></div>
<br><br><br>
<div id="cluster_71" style="clear:both;border-left:100px;float:left;"><h2>cluster_71</h2></div>
<br><br><br>
<div id="cluster_72" style="clear:both;border-left:100px;float:left;"><h2>cluster_72</h2></div>
<br><br><br>
<div id="cluster_73" style="clear:both;border-left:100px;float:left;"><h2>cluster_73</h2></div>
<br><br><br>
<div id="cluster_74" style="clear:both;border-left:100px;float:left;"><h2>cluster_74</h2></div>
<br><br><br>
<div id="cluster_75" style="clear:both;border-left:100px;float:left;"><h2>cluster_75</h2></div>
<br><br><br>
<div id="cluster_76" style="clear:both;border-left:100px;float:left;"><h2>cluster_76</h2></div>
<br><br><br>
<div id="cluster_77" style="clear:both;border-left:100px;float:left;"><h2>cluster_77</h2></div>
<br><br><br>
<div id="cluster_78" style="clear:both;border-left:100px;float:left;"><h2>cluster_78</h2></div>
<br><br><br>
<div id="cluster_79" style="clear:both;border-left:100px;float:left;"><h2>cluster_79</h2></div>
<br><br><br>
<div id="cluster_8" style="clear:both;border-left:100px;float:left;"><h2>cluster_8</h2></div>
<br><br><br>
<div id="cluster_80" style="clear:both;border-left:100px;float:left;"><h2>cluster_80</h2></div>
<br><br><br>
<div id="cluster_81" style="clear:both;border-left:100px;float:left;"><h2>cluster_81</h2></div>
<br><br><br>
<div id="cluster_82" style="clear:both;border-left:100px;float:left;"><h2>cluster_82</h2></div>
<br><br><br>
<div id="cluster_83" style="clear:both;border-left:100px;float:left;"><h2>cluster_83</h2></div>
<br><br><br>
<div id="cluster_84" style="clear:both;border-left:100px;float:left;"><h2>cluster_84</h2></div>
<br><br><br>
<div id="cluster_85" style="clear:both;border-left:100px;float:left;"><h2>cluster_85</h2></div>
<br><br><br>
<div id="cluster_86" style="clear:both;border-left:100px;float:left;"><h2>cluster_86</h2></div>
<br><br><br>
<div id="cluster_87" style="clear:both;border-left:100px;float:left;"><h2>cluster_87</h2></div>
<br><br><br>
<div id="cluster_88" style="clear:both;border-left:100px;float:left;"><h2>cluster_88</h2></div>
<br><br><br>
<div id="cluster_89" style="clear:both;border-left:100px;float:left;"><h2>cluster_89</h2></div>
<br><br><br>
<div id="cluster_9" style="clear:both;border-left:100px;float:left;"><h2>cluster_9</h2></div>
<br><br><br>
<div id="cluster_90" style="clear:both;border-left:100px;float:left;"><h2>cluster_90</h2></div>
<br><br><br>
<div id="cluster_91" style="clear:both;border-left:100px;float:left;"><h2>cluster_91</h2></div>
<br><br><br>
<div id="cluster_92" style="clear:both;border-left:100px;float:left;"><h2>cluster_92</h2></div>
<br><br><br>
<div id="cluster_93" style="clear:both;border-left:100px;float:left;"><h2>cluster_93</h2></div>
<br><br><br>
<div id="cluster_94" style="clear:both;border-left:100px;float:left;"><h2>cluster_94</h2></div>
<br><br><br>
<div id="cluster_95" style="clear:both;border-left:100px;float:left;"><h2>cluster_95</h2></div>
<br><br><br>
<div id="cluster_96" style="clear:both;border-left:100px;float:left;"><h2>cluster_96</h2></div>
<br><br><br>
<div id="cluster_97" style="clear:both;border-left:100px;float:left;"><h2>cluster_97</h2></div>
<br><br><br>
<div id="cluster_98" style="clear:both;border-left:100px;float:left;"><h2>cluster_98</h2></div>
<br><br><br>
<div id="cluster_99" style="clear:both;border-left:100px;float:left;"><h2>cluster_99</h2></div>
<br><br><br>



	<script type="text/javascript">



	(function() {
        var width = 2500,
	height = 50 + 87 * 11;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_1").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "TGAsTCA",
 "branch" : 8,
 "id" : "cluster_1_node_8",
 "ic" : "5.66",
 "size" : 7,
 "name" : "cluster_1",
 "image" : "matrix-clustering_aligned_logos/cluster_1_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_logo_rc.png",

  "children": [
  {
  "consensus" : "TGAsTCA",
 "branch" : 7,
 "id" : "cluster_1_node_7",
 "ic" : "5.90",
 "size" : 7,
 "name" : "cluster_1_node_7_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_7_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_7_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TGAsTCA",
 "branch" : 6,
 "id" : "cluster_1_node_6",
 "ic" : "6.02",
 "size" : 7,
 "name" : "cluster_1_node_6_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_6_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_6_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TGAsTCA",
 "branch" : 5,
 "id" : "cluster_1_node_5",
 "ic" : "6.28",
 "size" : 7,
 "name" : "cluster_1_node_5_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_5_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_5_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TGAsTCA",
 "branch" : 4,
 "id" : "cluster_1_node_4",
 "ic" : "6.45",
 "size" : 7,
 "name" : "cluster_1_node_4_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_4_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_4_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TGAsTCA",
 "branch" : 3,
 "id" : "cluster_1_node_3",
 "ic" : "6.58",
 "size" : 7,
 "name" : "cluster_1_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TGAsTCA",
 "branch" : 2,
 "id" : "cluster_1_node_2",
 "ic" : "6.91",
 "size" : 7,
 "name" : "cluster_1_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m259_kernel_701_number_of_sequence_5308", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m259_kernel_701_number_of_sequence_5308_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m259_kernel_701_number_of_sequence_5308_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m259_kernel_701_number_of_sequence_5308_logo.png",
 "name" : "kernel_701_number_of_sequence_5308",
 "ic" : "6.80",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGASTCA"
 },
 {
  "label": "2020-03-04t14-27-25z_m104_kernel_272_number_of_sequence_4521", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m104_kernel_272_number_of_sequence_4521_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m104_kernel_272_number_of_sequence_4521_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m104_kernel_272_number_of_sequence_4521_logo.png",
 "name" : "kernel_272_number_of_sequence_4521",
 "ic" : "7.16",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGASTCA"
 } 
 ] 
 },
 {
  "consensus" : "TGAsTCA",
 "branch" : 1,
 "id" : "cluster_1_node_1",
 "ic" : "6.39",
 "size" : 7,
 "name" : "cluster_1_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m10_kernel_25_number_of_sequence_5805", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m10_kernel_25_number_of_sequence_5805_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m10_kernel_25_number_of_sequence_5805_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m10_kernel_25_number_of_sequence_5805_logo.png",
 "name" : "kernel_25_number_of_sequence_5805",
 "ic" : "6.16",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGASTCA"
 },
 {
  "label": "2020-03-04t14-27-25z_m16_kernel_52_number_of_sequence_5735", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m16_kernel_52_number_of_sequence_5735_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m16_kernel_52_number_of_sequence_5735_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m16_kernel_52_number_of_sequence_5735_logo.png",
 "name" : "kernel_52_number_of_sequence_5735",
 "ic" : "6.69",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGASTCA"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m243_kernel_668_number_of_sequence_5552", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m243_kernel_668_number_of_sequence_5552_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m243_kernel_668_number_of_sequence_5552_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m243_kernel_668_number_of_sequence_5552_logo.png",
 "name" : "kernel_668_number_of_sequence_5552",
 "ic" : "6.12",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGASTCA"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m21_kernel_62_number_of_sequence_5151", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m21_kernel_62_number_of_sequence_5151_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m21_kernel_62_number_of_sequence_5151_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m21_kernel_62_number_of_sequence_5151_logo.png",
 "name" : "kernel_62_number_of_sequence_5151",
 "ic" : "5.68",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGASTCA"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m106_kernel_276_number_of_sequence_6377", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m106_kernel_276_number_of_sequence_6377_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m106_kernel_276_number_of_sequence_6377_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m106_kernel_276_number_of_sequence_6377_logo.png",
 "name" : "kernel_276_number_of_sequence_6377",
 "ic" : "5.15",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGASTCA"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m216_kernel_583_number_of_sequence_5430", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m216_kernel_583_number_of_sequence_5430_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m216_kernel_583_number_of_sequence_5430_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m216_kernel_583_number_of_sequence_5430_logo.png",
 "name" : "kernel_583_number_of_sequence_5430",
 "ic" : "4.45",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GASTCA"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m76_kernel_206_number_of_sequence_1982", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m76_kernel_206_number_of_sequence_1982_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m76_kernel_206_number_of_sequence_1982_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m76_kernel_206_number_of_sequence_1982_logo.png",
 "name" : "kernel_206_number_of_sequence_1982",
 "ic" : "3.25",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGARTYA"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_1").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#1A9E77");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_1"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#1A9E77"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_1" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#1A9E77")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_1").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_1").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_1").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_1").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 67;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_2").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GGGGssGGGCG",
 "branch" : 64,
 "id" : "cluster_2_node_64",
 "ic" : "6.67",
 "size" : 11,
 "name" : "cluster_2",
 "image" : "matrix-clustering_aligned_logos/cluster_2_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGgsGGG",
 "branch" : 60,
 "id" : "cluster_2_node_60",
 "ic" : "4.56",
 "size" : 11,
 "name" : "cluster_2_node_60_52motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_60_52motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_60_52motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGgsGGG",
 "branch" : 57,
 "id" : "cluster_2_node_57",
 "ic" : "4.58",
 "size" : 11,
 "name" : "cluster_2_node_57_51motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_57_51motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_57_51motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGgsGGG",
 "branch" : 56,
 "id" : "cluster_2_node_56",
 "ic" : "4.63",
 "size" : 11,
 "name" : "cluster_2_node_56_49motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_56_49motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_56_49motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGgsGGG",
 "branch" : 55,
 "id" : "cluster_2_node_55",
 "ic" : "4.12",
 "size" : 11,
 "name" : "cluster_2_node_55_34motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_55_34motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_55_34motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGG",
 "branch" : 54,
 "id" : "cluster_2_node_54",
 "ic" : "4.36",
 "size" : 11,
 "name" : "cluster_2_node_54_26motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_54_26motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_54_26motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGgsGG",
 "branch" : 51,
 "id" : "cluster_2_node_51",
 "ic" : "3.48",
 "size" : 11,
 "name" : "cluster_2_node_51_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_51_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_51_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcgG",
 "branch" : 50,
 "id" : "cluster_2_node_50",
 "ic" : "3.68",
 "size" : 11,
 "name" : "cluster_2_node_50_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_50_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_50_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGmgG",
 "branch" : 49,
 "id" : "cluster_2_node_49",
 "ic" : "3.89",
 "size" : 11,
 "name" : "cluster_2_node_49_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_49_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_49_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcgG",
 "branch" : 43,
 "id" : "cluster_2_node_43",
 "ic" : "4.09",
 "size" : 11,
 "name" : "cluster_2_node_43_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_43_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_43_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGsrG",
 "branch" : 40,
 "id" : "cluster_2_node_40",
 "ic" : "3.53",
 "size" : 11,
 "name" : "cluster_2_node_40_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_40_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_40_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGsrG",
 "branch" : 39,
 "id" : "cluster_2_node_39",
 "ic" : "3.29",
 "size" : 11,
 "name" : "cluster_2_node_39_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_39_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_39_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m247_kernel_673_number_of_sequence_6216", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m247_kernel_673_number_of_sequence_6216_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m247_kernel_673_number_of_sequence_6216_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m247_kernel_673_number_of_sequence_6216_logo.png",
 "name" : "kernel_673_number_of_sequence_6216",
 "ic" : "4.04",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYGCSC"
 },
 {
  "label": "2020-03-04t14-27-25z_m124_kernel_320_number_of_sequence_11465", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m124_kernel_320_number_of_sequence_11465_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m124_kernel_320_number_of_sequence_11465_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m124_kernel_320_number_of_sequence_11465_logo.png",
 "name" : "kernel_320_number_of_sequence_11465",
 "ic" : "3.17",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYSCCC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m319_kernel_864_number_of_sequence_11093", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m319_kernel_864_number_of_sequence_11093_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m319_kernel_864_number_of_sequence_11093_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m319_kernel_864_number_of_sequence_11093_logo.png",
 "name" : "kernel_864_number_of_sequence_11093",
 "ic" : "4.44",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGCKG"
 } 
 ] 
 },
 {
  "consensus" : "GGGmGG",
 "branch" : 5,
 "id" : "cluster_2_node_5",
 "ic" : "5.37",
 "size" : 11,
 "name" : "cluster_2_node_5_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_5_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_5_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m35_kernel_93_number_of_sequence_6190", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m35_kernel_93_number_of_sequence_6190_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m35_kernel_93_number_of_sequence_6190_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m35_kernel_93_number_of_sequence_6190_logo.png",
 "name" : "kernel_93_number_of_sequence_6190",
 "ic" : "5.41",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGMGG"
 },
 {
  "consensus" : "GGGmGG",
 "branch" : 2,
 "id" : "cluster_2_node_2",
 "ic" : "5.44",
 "size" : 11,
 "name" : "cluster_2_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m195_kernel_520_number_of_sequence_14102", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m195_kernel_520_number_of_sequence_14102_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m195_kernel_520_number_of_sequence_14102_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m195_kernel_520_number_of_sequence_14102_logo.png",
 "name" : "kernel_520_number_of_sequence_14102",
 "ic" : "5.66",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCGCCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m197_kernel_523_number_of_sequence_8615", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m197_kernel_523_number_of_sequence_8615_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m197_kernel_523_number_of_sequence_8615_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m197_kernel_523_number_of_sequence_8615_logo.png",
 "name" : "kernel_523_number_of_sequence_8615",
 "ic" : "5.29",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCKCCC"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GGrrGG",
 "branch" : 13,
 "id" : "cluster_2_node_13",
 "ic" : "4.02",
 "size" : 11,
 "name" : "cluster_2_node_13_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_13_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_13_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m19_kernel_57_number_of_sequence_9348", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m19_kernel_57_number_of_sequence_9348_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m19_kernel_57_number_of_sequence_9348_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m19_kernel_57_number_of_sequence_9348_logo.png",
 "name" : "kernel_57_number_of_sequence_9348",
 "ic" : "3.96",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCYYCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m255_kernel_687_number_of_sequence_4677", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m255_kernel_687_number_of_sequence_4677_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m255_kernel_687_number_of_sequence_4677_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m255_kernel_687_number_of_sequence_4677_logo.png",
 "name" : "kernel_687_number_of_sequence_4677",
 "ic" : "4.53",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCYSCC"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m173_kernel_463_number_of_sequence_9880", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m173_kernel_463_number_of_sequence_9880_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m173_kernel_463_number_of_sequence_9880_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m173_kernel_463_number_of_sequence_9880_logo.png",
 "name" : "kernel_463_number_of_sequence_9880",
 "ic" : "3.52",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCMCCC"
 } 
 ] 
 },
 {
  "consensus" : "GGmGGG",
 "branch" : 22,
 "id" : "cluster_2_node_22",
 "ic" : "4.44",
 "size" : 11,
 "name" : "cluster_2_node_22_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_22_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_22_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m172_kernel_462_number_of_sequence_9933", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m172_kernel_462_number_of_sequence_9933_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m172_kernel_462_number_of_sequence_9933_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m172_kernel_462_number_of_sequence_9933_logo.png",
 "name" : "kernel_462_number_of_sequence_9933",
 "ic" : "4.38",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGMGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m114_kernel_300_number_of_sequence_12564", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m114_kernel_300_number_of_sequence_12564_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m114_kernel_300_number_of_sequence_12564_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m114_kernel_300_number_of_sequence_12564_logo.png",
 "name" : "kernel_300_number_of_sequence_12564",
 "ic" : "4.77",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGMGGG"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GGGcGgG",
 "branch" : 47,
 "id" : "cluster_2_node_47",
 "ic" : "4.62",
 "size" : 11,
 "name" : "cluster_2_node_47_15motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_47_15motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_47_15motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGgG",
 "branch" : 35,
 "id" : "cluster_2_node_35",
 "ic" : "4.94",
 "size" : 11,
 "name" : "cluster_2_node_35_14motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_35_14motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_35_14motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGgG",
 "branch" : 31,
 "id" : "cluster_2_node_31",
 "ic" : "4.94",
 "size" : 11,
 "name" : "cluster_2_node_31_13motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_31_13motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_31_13motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGG",
 "branch" : 27,
 "id" : "cluster_2_node_27",
 "ic" : "5.21",
 "size" : 11,
 "name" : "cluster_2_node_27_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_27_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_27_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGG",
 "branch" : 19,
 "id" : "cluster_2_node_19",
 "ic" : "5.27",
 "size" : 11,
 "name" : "cluster_2_node_19_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_19_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_19_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGG",
 "branch" : 18,
 "id" : "cluster_2_node_18",
 "ic" : "5.44",
 "size" : 11,
 "name" : "cluster_2_node_18_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_18_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_18_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGgG",
 "branch" : 14,
 "id" : "cluster_2_node_14",
 "ic" : "5.43",
 "size" : 11,
 "name" : "cluster_2_node_14_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_14_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_14_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGyGGG",
 "branch" : 10,
 "id" : "cluster_2_node_10",
 "ic" : "5.65",
 "size" : 11,
 "name" : "cluster_2_node_10_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_10_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_10_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGG",
 "branch" : 9,
 "id" : "cluster_2_node_9",
 "ic" : "5.59",
 "size" : 11,
 "name" : "cluster_2_node_9_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_9_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_9_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGG",
 "branch" : 6,
 "id" : "cluster_2_node_6",
 "ic" : "5.95",
 "size" : 11,
 "name" : "cluster_2_node_6_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_6_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_6_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGG",
 "branch" : 1,
 "id" : "cluster_2_node_1",
 "ic" : "6.55",
 "size" : 11,
 "name" : "cluster_2_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m26_kernel_70_number_of_sequence_12916", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m26_kernel_70_number_of_sequence_12916_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m26_kernel_70_number_of_sequence_12916_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m26_kernel_70_number_of_sequence_12916_logo.png",
 "name" : "kernel_70_number_of_sequence_12916",
 "ic" : "6.70",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGCGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m256_kernel_689_number_of_sequence_7229", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m256_kernel_689_number_of_sequence_7229_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m256_kernel_689_number_of_sequence_7229_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m256_kernel_689_number_of_sequence_7229_logo.png",
 "name" : "kernel_689_number_of_sequence_7229",
 "ic" : "6.39",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCRCCC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m64_kernel_174_number_of_sequence_12165", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m64_kernel_174_number_of_sequence_12165_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m64_kernel_174_number_of_sequence_12165_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m64_kernel_174_number_of_sequence_12165_logo.png",
 "name" : "kernel_174_number_of_sequence_12165",
 "ic" : "5.41",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGCGGG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m82_kernel_215_number_of_sequence_5877", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m82_kernel_215_number_of_sequence_5877_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m82_kernel_215_number_of_sequence_5877_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m82_kernel_215_number_of_sequence_5877_logo.png",
 "name" : "kernel_215_number_of_sequence_5877",
 "ic" : "4.29",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGYGGG"
 } 
 ] 
 },
 {
  "consensus" : "GGGyGgG",
 "branch" : 7,
 "id" : "cluster_2_node_7",
 "ic" : "5.98",
 "size" : 11,
 "name" : "cluster_2_node_7_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_7_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_7_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGyGgG",
 "branch" : 3,
 "id" : "cluster_2_node_3",
 "ic" : "5.99",
 "size" : 11,
 "name" : "cluster_2_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m123_kernel_319_number_of_sequence_8848", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m123_kernel_319_number_of_sequence_8848_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m123_kernel_319_number_of_sequence_8848_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m123_kernel_319_number_of_sequence_8848_logo.png",
 "name" : "kernel_319_number_of_sequence_8848",
 "ic" : "5.79",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGYGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m100_kernel_264_number_of_sequence_10224", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m100_kernel_264_number_of_sequence_10224_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m100_kernel_264_number_of_sequence_10224_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m100_kernel_264_number_of_sequence_10224_logo.png",
 "name" : "kernel_264_number_of_sequence_10224",
 "ic" : "6.36",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMCRCCC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m48_kernel_138_number_of_sequence_5122", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m48_kernel_138_number_of_sequence_5122_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m48_kernel_138_number_of_sequence_5122_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m48_kernel_138_number_of_sequence_5122_logo.png",
 "name" : "kernel_138_number_of_sequence_5122",
 "ic" : "6.46",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGYGGG"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m136_kernel_346_number_of_sequence_12620", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m136_kernel_346_number_of_sequence_12620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m136_kernel_346_number_of_sequence_12620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m136_kernel_346_number_of_sequence_12620_logo.png",
 "name" : "kernel_346_number_of_sequence_12620",
 "ic" : "4.86",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCKCCC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m141_kernel_356_number_of_sequence_9762", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m141_kernel_356_number_of_sequence_9762_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m141_kernel_356_number_of_sequence_9762_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m141_kernel_356_number_of_sequence_9762_logo.png",
 "name" : "kernel_356_number_of_sequence_9762",
 "ic" : "5.95",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGCGGG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m292_kernel_788_number_of_sequence_10857", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m292_kernel_788_number_of_sequence_10857_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m292_kernel_788_number_of_sequence_10857_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m292_kernel_788_number_of_sequence_10857_logo.png",
 "name" : "kernel_788_number_of_sequence_10857",
 "ic" : "4.78",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCGCSC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m184_kernel_487_number_of_sequence_3841", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m184_kernel_487_number_of_sequence_3841_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m184_kernel_487_number_of_sequence_3841_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m184_kernel_487_number_of_sequence_3841_logo.png",
 "name" : "kernel_487_number_of_sequence_3841",
 "ic" : "5.17",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGSRGG"
 } 
 ] 
 },
 {
  "consensus" : "GGGmGgG",
 "branch" : 30,
 "id" : "cluster_2_node_30",
 "ic" : "4.29",
 "size" : 11,
 "name" : "cluster_2_node_30_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_30_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_30_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m151_kernel_398_number_of_sequence_8797", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m151_kernel_398_number_of_sequence_8797_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m151_kernel_398_number_of_sequence_8797_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m151_kernel_398_number_of_sequence_8797_logo.png",
 "name" : "kernel_398_number_of_sequence_8797",
 "ic" : "4.65",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGSGSG"
 },
 {
  "label": "2020-03-04t14-27-25z_m268_kernel_722_number_of_sequence_12815", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m268_kernel_722_number_of_sequence_12815_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m268_kernel_722_number_of_sequence_12815_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m268_kernel_722_number_of_sequence_12815_logo.png",
 "name" : "kernel_722_number_of_sequence_12815",
 "ic" : "4.48",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMCKCCC"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m294_kernel_797_number_of_sequence_8253", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m294_kernel_797_number_of_sequence_8253_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m294_kernel_797_number_of_sequence_8253_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m294_kernel_797_number_of_sequence_8253_logo.png",
 "name" : "kernel_797_number_of_sequence_8253",
 "ic" : "5.88",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGYGKG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m271_kernel_731_number_of_sequence_15587", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m271_kernel_731_number_of_sequence_15587_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m271_kernel_731_number_of_sequence_15587_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m271_kernel_731_number_of_sequence_15587_logo.png",
 "name" : "kernel_731_number_of_sequence_15587",
 "ic" : "3.17",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSKYSGG"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GGsgGGG",
 "branch" : 36,
 "id" : "cluster_2_node_36",
 "ic" : "4.38",
 "size" : 11,
 "name" : "cluster_2_node_36_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_36_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_36_8motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m304_kernel_827_number_of_sequence_16150", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m304_kernel_827_number_of_sequence_16150_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m304_kernel_827_number_of_sequence_16150_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m304_kernel_827_number_of_sequence_16150_logo.png",
 "name" : "kernel_827_number_of_sequence_16150",
 "ic" : "4.60",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSCCSCS"
 },
 {
  "consensus" : "GGsgGGG",
 "branch" : 33,
 "id" : "cluster_2_node_33",
 "ic" : "4.52",
 "size" : 11,
 "name" : "cluster_2_node_33_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_33_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_33_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGskGGG",
 "branch" : 29,
 "id" : "cluster_2_node_29",
 "ic" : "4.45",
 "size" : 11,
 "name" : "cluster_2_node_29_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_29_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_29_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGskGGG",
 "branch" : 16,
 "id" : "cluster_2_node_16",
 "ic" : "4.49",
 "size" : 11,
 "name" : "cluster_2_node_16_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_16_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_16_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m276_kernel_748_number_of_sequence_11283", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m276_kernel_748_number_of_sequence_11283_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m276_kernel_748_number_of_sequence_11283_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m276_kernel_748_number_of_sequence_11283_logo.png",
 "name" : "kernel_748_number_of_sequence_11283",
 "ic" : "4.80",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGSGGGG"
 },
 {
  "consensus" : "GGskGGG",
 "branch" : 15,
 "id" : "cluster_2_node_15",
 "ic" : "4.58",
 "size" : 11,
 "name" : "cluster_2_node_15_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_15_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_15_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m297_kernel_801_number_of_sequence_7932", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m297_kernel_801_number_of_sequence_7932_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m297_kernel_801_number_of_sequence_7932_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m297_kernel_801_number_of_sequence_7932_logo.png",
 "name" : "kernel_801_number_of_sequence_7932",
 "ic" : "4.83",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCMCCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m193_kernel_511_number_of_sequence_9016", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m193_kernel_511_number_of_sequence_9016_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m193_kernel_511_number_of_sequence_9016_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m193_kernel_511_number_of_sequence_9016_logo.png",
 "name" : "kernel_511_number_of_sequence_9016",
 "ic" : "4.73",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCMSCC"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m262_kernel_707_number_of_sequence_10640", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m262_kernel_707_number_of_sequence_10640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m262_kernel_707_number_of_sequence_10640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m262_kernel_707_number_of_sequence_10640_logo.png",
 "name" : "kernel_707_number_of_sequence_10640",
 "ic" : "5.02",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGSGGGR"
 } 
 ] 
 },
 {
  "consensus" : "GGyGGgG",
 "branch" : 12,
 "id" : "cluster_2_node_12",
 "ic" : "5.26",
 "size" : 11,
 "name" : "cluster_2_node_12_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_12_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_12_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m310_kernel_840_number_of_sequence_7648", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m310_kernel_840_number_of_sequence_7648_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m310_kernel_840_number_of_sequence_7648_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m310_kernel_840_number_of_sequence_7648_logo.png",
 "name" : "kernel_840_number_of_sequence_7648",
 "ic" : "5.47",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGHGGGG"
 },
 {
  "consensus" : "GGyGGgG",
 "branch" : 11,
 "id" : "cluster_2_node_11",
 "ic" : "5.41",
 "size" : 11,
 "name" : "cluster_2_node_11_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_11_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_11_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m179_kernel_477_number_of_sequence_8700", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m179_kernel_477_number_of_sequence_8700_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m179_kernel_477_number_of_sequence_8700_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m179_kernel_477_number_of_sequence_8700_logo.png",
 "name" : "kernel_477_number_of_sequence_8700",
 "ic" : "5.02",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGYGGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m153_kernel_402_number_of_sequence_11840", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m153_kernel_402_number_of_sequence_11840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m153_kernel_402_number_of_sequence_11840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m153_kernel_402_number_of_sequence_11840_logo.png",
 "name" : "kernel_402_number_of_sequence_11840",
 "ic" : "6.01",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGYGGGG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GGGsgGGG",
 "branch" : 53,
 "id" : "cluster_2_node_53",
 "ic" : "4.51",
 "size" : 11,
 "name" : "cluster_2_node_53_15motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_53_15motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_53_15motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGsgGGG",
 "branch" : 46,
 "id" : "cluster_2_node_46",
 "ic" : "4.66",
 "size" : 11,
 "name" : "cluster_2_node_46_13motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_46_13motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_46_13motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGsgGGG",
 "branch" : 42,
 "id" : "cluster_2_node_42",
 "ic" : "4.82",
 "size" : 11,
 "name" : "cluster_2_node_42_12motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_42_12motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_42_12motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGGG",
 "branch" : 37,
 "id" : "cluster_2_node_37",
 "ic" : "5.14",
 "size" : 11,
 "name" : "cluster_2_node_37_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_37_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_37_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGkgGGG",
 "branch" : 32,
 "id" : "cluster_2_node_32",
 "ic" : "4.81",
 "size" : 11,
 "name" : "cluster_2_node_32_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_32_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_32_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m225_kernel_617_number_of_sequence_10758", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m225_kernel_617_number_of_sequence_10758_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m225_kernel_617_number_of_sequence_10758_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m225_kernel_617_number_of_sequence_10758_logo.png",
 "name" : "kernel_617_number_of_sequence_10758",
 "ic" : "4.43",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGRKGGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m66_kernel_176_number_of_sequence_6802", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m66_kernel_176_number_of_sequence_6802_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m66_kernel_176_number_of_sequence_6802_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m66_kernel_176_number_of_sequence_6802_logo.png",
 "name" : "kernel_176_number_of_sequence_6802",
 "ic" : "6.30",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGKGGGG"
 } 
 ] 
 },
 {
  "consensus" : "GGGcGGGG",
 "branch" : 28,
 "id" : "cluster_2_node_28",
 "ic" : "5.39",
 "size" : 11,
 "name" : "cluster_2_node_28_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_28_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_28_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGGG",
 "branch" : 24,
 "id" : "cluster_2_node_24",
 "ic" : "5.52",
 "size" : 11,
 "name" : "cluster_2_node_24_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_24_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_24_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGGG",
 "branch" : 23,
 "id" : "cluster_2_node_23",
 "ic" : "5.55",
 "size" : 11,
 "name" : "cluster_2_node_23_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_23_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_23_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGGG",
 "branch" : 21,
 "id" : "cluster_2_node_21",
 "ic" : "5.69",
 "size" : 11,
 "name" : "cluster_2_node_21_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_21_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_21_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGgG",
 "branch" : 20,
 "id" : "cluster_2_node_20",
 "ic" : "6.34",
 "size" : 11,
 "name" : "cluster_2_node_20_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_20_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_20_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m267_kernel_720_number_of_sequence_12635", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m267_kernel_720_number_of_sequence_12635_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m267_kernel_720_number_of_sequence_12635_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m267_kernel_720_number_of_sequence_12635_logo.png",
 "name" : "kernel_720_number_of_sequence_12635",
 "ic" : "6.57",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGMGGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m245_kernel_670_number_of_sequence_14644", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m245_kernel_670_number_of_sequence_14644_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m245_kernel_670_number_of_sequence_14644_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m245_kernel_670_number_of_sequence_14644_logo.png",
 "name" : "kernel_670_number_of_sequence_14644",
 "ic" : "6.58",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGYGGGG"
 } 
 ] 
 },
 {
  "consensus" : "GGGcgGGG",
 "branch" : 17,
 "id" : "cluster_2_node_17",
 "ic" : "5.40",
 "size" : 11,
 "name" : "cluster_2_node_17_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_17_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_17_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m75_kernel_204_number_of_sequence_10915", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m75_kernel_204_number_of_sequence_10915_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m75_kernel_204_number_of_sequence_10915_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m75_kernel_204_number_of_sequence_10915_logo.png",
 "name" : "kernel_204_number_of_sequence_10915",
 "ic" : "5.57",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGCSGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m176_kernel_467_number_of_sequence_10686", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m176_kernel_467_number_of_sequence_10686_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m176_kernel_467_number_of_sequence_10686_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m176_kernel_467_number_of_sequence_10686_logo.png",
 "name" : "kernel_467_number_of_sequence_10686",
 "ic" : "5.65",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGCGGRG"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m200_kernel_534_number_of_sequence_11602", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m200_kernel_534_number_of_sequence_11602_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m200_kernel_534_number_of_sequence_11602_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m200_kernel_534_number_of_sequence_11602_logo.png",
 "name" : "kernel_534_number_of_sequence_11602",
 "ic" : "5.76",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCCSCCC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m52_kernel_148_number_of_sequence_13048", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m52_kernel_148_number_of_sequence_13048_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m52_kernel_148_number_of_sequence_13048_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m52_kernel_148_number_of_sequence_13048_logo.png",
 "name" : "kernel_148_number_of_sequence_13048",
 "ic" : "5.96",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYCCGCSC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m148_kernel_384_number_of_sequence_6036", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m148_kernel_384_number_of_sequence_6036_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m148_kernel_384_number_of_sequence_6036_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m148_kernel_384_number_of_sequence_6036_logo.png",
 "name" : "kernel_384_number_of_sequence_6036",
 "ic" : "5.08",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCCSCSC"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GGGgsGgG",
 "branch" : 34,
 "id" : "cluster_2_node_34",
 "ic" : "4.58",
 "size" : 11,
 "name" : "cluster_2_node_34_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_34_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_34_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m263_kernel_708_number_of_sequence_11226", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m263_kernel_708_number_of_sequence_11226_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m263_kernel_708_number_of_sequence_11226_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m263_kernel_708_number_of_sequence_11226_logo.png",
 "name" : "kernel_708_number_of_sequence_11226",
 "ic" : "5.00",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "YCCVSCCC"
 },
 {
  "consensus" : "GGGGsGgG",
 "branch" : 25,
 "id" : "cluster_2_node_25",
 "ic" : "4.74",
 "size" : 11,
 "name" : "cluster_2_node_25_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_25_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_25_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m224_kernel_615_number_of_sequence_7348", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m224_kernel_615_number_of_sequence_7348_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m224_kernel_615_number_of_sequence_7348_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m224_kernel_615_number_of_sequence_7348_logo.png",
 "name" : "kernel_615_number_of_sequence_7348",
 "ic" : "5.27",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGGSGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m161_kernel_433_number_of_sequence_8983", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m161_kernel_433_number_of_sequence_8983_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m161_kernel_433_number_of_sequence_8983_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m161_kernel_433_number_of_sequence_8983_logo.png",
 "name" : "kernel_433_number_of_sequence_8983",
 "ic" : "4.82",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCSCCCC"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m286_kernel_770_number_of_sequence_11475", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m286_kernel_770_number_of_sequence_11475_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m286_kernel_770_number_of_sequence_11475_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m286_kernel_770_number_of_sequence_11475_logo.png",
 "name" : "kernel_770_number_of_sequence_11475",
 "ic" : "4.90",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRGSSGGG"
 } 
 ] 
 },
 {
  "consensus" : "GsggssGG",
 "branch" : 44,
 "id" : "cluster_2_node_44",
 "ic" : "4.63",
 "size" : 11,
 "name" : "cluster_2_node_44_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_44_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_44_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m160_kernel_430_number_of_sequence_9215", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m160_kernel_430_number_of_sequence_9215_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m160_kernel_430_number_of_sequence_9215_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m160_kernel_430_number_of_sequence_9215_logo.png",
 "name" : "kernel_430_number_of_sequence_9215",
 "ic" : "5.08",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSSCCSC"
 },
 {
  "label": "2020-03-04t14-27-25z_m101_kernel_265_number_of_sequence_6248", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m101_kernel_265_number_of_sequence_6248_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m101_kernel_265_number_of_sequence_6248_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m101_kernel_265_number_of_sequence_6248_logo.png",
 "name" : "kernel_265_number_of_sequence_6248",
 "ic" : "4.59",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSCMCSC"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GgGGsgG",
 "branch" : 45,
 "id" : "cluster_2_node_45",
 "ic" : "4.29",
 "size" : 11,
 "name" : "cluster_2_node_45_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_45_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_45_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m316_kernel_854_number_of_sequence_7331", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m316_kernel_854_number_of_sequence_7331_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m316_kernel_854_number_of_sequence_7331_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m316_kernel_854_number_of_sequence_7331_logo.png",
 "name" : "kernel_854_number_of_sequence_7331",
 "ic" : "4.67",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGRMRG"
 },
 {
  "label": "2020-03-04t14-27-25z_m183_kernel_486_number_of_sequence_11749", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m183_kernel_486_number_of_sequence_11749_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m183_kernel_486_number_of_sequence_11749_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m183_kernel_486_number_of_sequence_11749_logo.png",
 "name" : "kernel_486_number_of_sequence_11749",
 "ic" : "4.55",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSCCYC"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m187_kernel_496_number_of_sequence_4461", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m187_kernel_496_number_of_sequence_4461_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m187_kernel_496_number_of_sequence_4461_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m187_kernel_496_number_of_sequence_4461_logo.png",
 "name" : "kernel_496_number_of_sequence_4461",
 "ic" : "3.11",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCYCTC"
 } 
 ] 
 },
 {
  "consensus" : "GGGGcGGGGCG",
 "branch" : 63,
 "id" : "cluster_2_node_63",
 "ic" : "6.45",
 "size" : 11,
 "name" : "cluster_2_node_63_13motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_63_13motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_63_13motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m115_kernel_303_number_of_sequence_8613", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m115_kernel_303_number_of_sequence_8613_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m115_kernel_303_number_of_sequence_8613_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m115_kernel_303_number_of_sequence_8613_logo.png",
 "name" : "kernel_303_number_of_sequence_8613",
 "ic" : "6.51",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CTCCKCCC"
 },
 {
  "consensus" : "GGGGcGgGGCG",
 "branch" : 62,
 "id" : "cluster_2_node_62",
 "ic" : "6.38",
 "size" : 11,
 "name" : "cluster_2_node_62_12motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_62_12motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_62_12motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGGcGGGgCG",
 "branch" : 59,
 "id" : "cluster_2_node_59",
 "ic" : "6.85",
 "size" : 11,
 "name" : "cluster_2_node_59_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_59_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_59_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGGyGgGgC",
 "branch" : 58,
 "id" : "cluster_2_node_58",
 "ic" : "5.96",
 "size" : 11,
 "name" : "cluster_2_node_58_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_58_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_58_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGyGgGgC",
 "branch" : 52,
 "id" : "cluster_2_node_52",
 "ic" : "5.45",
 "size" : 11,
 "name" : "cluster_2_node_52_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_52_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_52_8motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m252_kernel_680_number_of_sequence_7694", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m252_kernel_680_number_of_sequence_7694_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m252_kernel_680_number_of_sequence_7694_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m252_kernel_680_number_of_sequence_7694_logo.png",
 "name" : "kernel_680_number_of_sequence_7694",
 "ic" : "5.23",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCCSSSMSC"
 },
 {
  "consensus" : "GGGyGGGgC",
 "branch" : 48,
 "id" : "cluster_2_node_48",
 "ic" : "5.73",
 "size" : 11,
 "name" : "cluster_2_node_48_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_48_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_48_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGyGgGgC",
 "branch" : 41,
 "id" : "cluster_2_node_41",
 "ic" : "4.35",
 "size" : 11,
 "name" : "cluster_2_node_41_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_41_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_41_4motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m238_kernel_644_number_of_sequence_7362", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m238_kernel_644_number_of_sequence_7362_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m238_kernel_644_number_of_sequence_7362_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m238_kernel_644_number_of_sequence_7362_logo.png",
 "name" : "kernel_644_number_of_sequence_7362",
 "ic" : "5.53",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGCGGRGC"
 },
 {
  "consensus" : "GGyGkGgC",
 "branch" : 38,
 "id" : "cluster_2_node_38",
 "ic" : "4.34",
 "size" : 11,
 "name" : "cluster_2_node_38_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_38_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_38_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGhGkGgC",
 "branch" : 26,
 "id" : "cluster_2_node_26",
 "ic" : "4.65",
 "size" : 11,
 "name" : "cluster_2_node_26_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_26_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_26_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m33_kernel_88_number_of_sequence_11530", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m33_kernel_88_number_of_sequence_11530_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m33_kernel_88_number_of_sequence_11530_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m33_kernel_88_number_of_sequence_11530_logo.png",
 "name" : "kernel_88_number_of_sequence_11530",
 "ic" : "4.70",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GMCMCDCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m79_kernel_210_number_of_sequence_11872", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m79_kernel_210_number_of_sequence_11872_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m79_kernel_210_number_of_sequence_11872_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m79_kernel_210_number_of_sequence_11872_logo.png",
 "name" : "kernel_210_number_of_sequence_11872",
 "ic" : "5.03",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCCMCDCC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m2_kernel_5_number_of_sequence_8632", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m2_kernel_5_number_of_sequence_8632_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m2_kernel_5_number_of_sequence_8632_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m2_kernel_5_number_of_sequence_8632_logo.png",
 "name" : "kernel_5_number_of_sequence_8632",
 "ic" : "4.35",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GKYKGGRC"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GGGcGGGGC",
 "branch" : 8,
 "id" : "cluster_2_node_8",
 "ic" : "7.09",
 "size" : 11,
 "name" : "cluster_2_node_8_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_8_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_8_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGcGGGGC",
 "branch" : 4,
 "id" : "cluster_2_node_4",
 "ic" : "7.42",
 "size" : 11,
 "name" : "cluster_2_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m210_kernel_562_number_of_sequence_7574", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m210_kernel_562_number_of_sequence_7574_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m210_kernel_562_number_of_sequence_7574_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m210_kernel_562_number_of_sequence_7574_logo.png",
 "name" : "kernel_562_number_of_sequence_7574",
 "ic" : "7.94",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGCGGGGC"
 },
 {
  "label": "2020-03-04t14-27-25z_m194_kernel_513_number_of_sequence_11238", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m194_kernel_513_number_of_sequence_11238_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m194_kernel_513_number_of_sequence_11238_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m194_kernel_513_number_of_sequence_11238_logo.png",
 "name" : "kernel_513_number_of_sequence_11238",
 "ic" : "7.30",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCCCCGCCY"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m154_kernel_405_number_of_sequence_9159", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m154_kernel_405_number_of_sequence_9159_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m154_kernel_405_number_of_sequence_9159_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m154_kernel_405_number_of_sequence_9159_logo.png",
 "name" : "kernel_405_number_of_sequence_9159",
 "ic" : "6.81",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCCCCRCCC"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m31_kernel_86_number_of_sequence_14821", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m31_kernel_86_number_of_sequence_14821_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m31_kernel_86_number_of_sequence_14821_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m31_kernel_86_number_of_sequence_14821_logo.png",
 "name" : "kernel_86_number_of_sequence_14821",
 "ic" : "5.76",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSGSCGGGGC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m168_kernel_446_number_of_sequence_7981", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m168_kernel_446_number_of_sequence_7981_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m168_kernel_446_number_of_sequence_7981_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m168_kernel_446_number_of_sequence_7981_logo.png",
 "name" : "kernel_446_number_of_sequence_7981",
 "ic" : "6.76",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSCCCCGCCC"
 } 
 ] 
 },
 {
  "consensus" : "GgGsrggGG",
 "branch" : 61,
 "id" : "cluster_2_node_61",
 "ic" : "4.36",
 "size" : 11,
 "name" : "cluster_2_node_61_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_61_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_61_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m293_kernel_790_number_of_sequence_5629", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m293_kernel_790_number_of_sequence_5629_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m293_kernel_790_number_of_sequence_5629_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m293_kernel_790_number_of_sequence_5629_logo.png",
 "name" : "kernel_790_number_of_sequence_5629",
 "ic" : "5.63",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGGGGRGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m8_kernel_21_number_of_sequence_14540", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m8_kernel_21_number_of_sequence_14540_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m8_kernel_21_number_of_sequence_14540_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m8_kernel_21_number_of_sequence_14540_logo.png",
 "name" : "kernel_21_number_of_sequence_14540",
 "ic" : "4.43",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGSRGGGG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 420; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_2").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#369C72");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_2"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#369C72"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_2" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#369C72")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_2").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_2").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_2").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_2").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 21;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_3").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GGssssG",
 "branch" : 18,
 "id" : "cluster_3_node_18",
 "ic" : "3.14",
 "size" : 7,
 "name" : "cluster_3",
 "image" : "matrix-clustering_aligned_logos/cluster_3_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_logo_rc.png",

  "children": [
  {
  "consensus" : "GssssG",
 "branch" : 17,
 "id" : "cluster_3_node_17",
 "ic" : "2.52",
 "size" : 7,
 "name" : "cluster_3_node_17_17motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_17_17motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_17_17motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GssgsG",
 "branch" : 15,
 "id" : "cluster_3_node_15",
 "ic" : "2.53",
 "size" : 7,
 "name" : "cluster_3_node_15_16motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_15_16motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_15_16motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GssgsG",
 "branch" : 14,
 "id" : "cluster_3_node_14",
 "ic" : "2.65",
 "size" : 7,
 "name" : "cluster_3_node_14_15motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_14_15motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_14_15motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GssssG",
 "branch" : 13,
 "id" : "cluster_3_node_13",
 "ic" : "2.59",
 "size" : 7,
 "name" : "cluster_3_node_13_14motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_13_14motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_13_14motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GssssG",
 "branch" : 12,
 "id" : "cluster_3_node_12",
 "ic" : "3.00",
 "size" : 7,
 "name" : "cluster_3_node_12_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_12_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_12_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GssGCG",
 "branch" : 7,
 "id" : "cluster_3_node_7",
 "ic" : "4.08",
 "size" : 7,
 "name" : "cluster_3_node_7_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_7_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_7_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m171_kernel_456_number_of_sequence_14636", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m171_kernel_456_number_of_sequence_14636_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m171_kernel_456_number_of_sequence_14636_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m171_kernel_456_number_of_sequence_14636_logo.png",
 "name" : "kernel_456_number_of_sequence_14636",
 "ic" : "4.45",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSSGCG"
 },
 {
  "consensus" : "GGgGCG",
 "branch" : 1,
 "id" : "cluster_3_node_1",
 "ic" : "4.25",
 "size" : 7,
 "name" : "cluster_3_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m164_kernel_439_number_of_sequence_10400", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m164_kernel_439_number_of_sequence_10400_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m164_kernel_439_number_of_sequence_10400_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m164_kernel_439_number_of_sequence_10400_logo.png",
 "name" : "kernel_439_number_of_sequence_10400",
 "ic" : "4.30",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CGCCCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m126_kernel_329_number_of_sequence_7530", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m126_kernel_329_number_of_sequence_7530_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m126_kernel_329_number_of_sequence_7530_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m126_kernel_329_number_of_sequence_7530_logo.png",
 "name" : "kernel_329_number_of_sequence_7530",
 "ic" : "4.73",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGSGCG"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GssssG",
 "branch" : 11,
 "id" : "cluster_3_node_11",
 "ic" : "2.97",
 "size" : 7,
 "name" : "cluster_3_node_11_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_11_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_11_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GsGssG",
 "branch" : 10,
 "id" : "cluster_3_node_10",
 "ic" : "3.02",
 "size" : 7,
 "name" : "cluster_3_node_10_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_10_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_10_5motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m43_kernel_111_number_of_sequence_10005", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m43_kernel_111_number_of_sequence_10005_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m43_kernel_111_number_of_sequence_10005_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m43_kernel_111_number_of_sequence_10005_logo.png",
 "name" : "kernel_111_number_of_sequence_10005",
 "ic" : "3.23",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CBSSSC"
 },
 {
  "consensus" : "GcGssG",
 "branch" : 6,
 "id" : "cluster_3_node_6",
 "ic" : "3.26",
 "size" : 7,
 "name" : "cluster_3_node_6_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_6_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_6_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GcGsgG",
 "branch" : 3,
 "id" : "cluster_3_node_3",
 "ic" : "3.55",
 "size" : 7,
 "name" : "cluster_3_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GCgsGG",
 "branch" : 2,
 "id" : "cluster_3_node_2",
 "ic" : "3.74",
 "size" : 7,
 "name" : "cluster_3_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m220_kernel_600_number_of_sequence_9528", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m220_kernel_600_number_of_sequence_9528_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m220_kernel_600_number_of_sequence_9528_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m220_kernel_600_number_of_sequence_9528_logo.png",
 "name" : "kernel_600_number_of_sequence_9528",
 "ic" : "4.26",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSSGC"
 },
 {
  "label": "2020-03-04t14-27-25z_m181_kernel_480_number_of_sequence_8643", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m181_kernel_480_number_of_sequence_8643_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m181_kernel_480_number_of_sequence_8643_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m181_kernel_480_number_of_sequence_8643_logo.png",
 "name" : "kernel_480_number_of_sequence_8643",
 "ic" : "3.65",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSCGC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m59_kernel_166_number_of_sequence_8964", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m59_kernel_166_number_of_sequence_8964_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m59_kernel_166_number_of_sequence_8964_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m59_kernel_166_number_of_sequence_8964_logo.png",
 "name" : "kernel_166_number_of_sequence_8964",
 "ic" : "3.81",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSGCSG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m116_kernel_305_number_of_sequence_6548", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m116_kernel_305_number_of_sequence_6548_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m116_kernel_305_number_of_sequence_6548_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m116_kernel_305_number_of_sequence_6548_logo.png",
 "name" : "kernel_305_number_of_sequence_6548",
 "ic" : "2.93",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GMSCSG"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GssssG",
 "branch" : 5,
 "id" : "cluster_3_node_5",
 "ic" : "3.44",
 "size" : 7,
 "name" : "cluster_3_node_5_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_5_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_5_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GssGgG",
 "branch" : 4,
 "id" : "cluster_3_node_4",
 "ic" : "3.47",
 "size" : 7,
 "name" : "cluster_3_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m231_kernel_629_number_of_sequence_10591", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m231_kernel_629_number_of_sequence_10591_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m231_kernel_629_number_of_sequence_10591_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m231_kernel_629_number_of_sequence_10591_logo.png",
 "name" : "kernel_629_number_of_sequence_10591",
 "ic" : "3.87",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSSGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m278_kernel_751_number_of_sequence_3530", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m278_kernel_751_number_of_sequence_3530_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m278_kernel_751_number_of_sequence_3530_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m278_kernel_751_number_of_sequence_3530_logo.png",
 "name" : "kernel_751_number_of_sequence_3530",
 "ic" : "3.02",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSSSGG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m305_kernel_830_number_of_sequence_14608", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m305_kernel_830_number_of_sequence_14608_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m305_kernel_830_number_of_sequence_14608_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m305_kernel_830_number_of_sequence_14608_logo.png",
 "name" : "kernel_830_number_of_sequence_14608",
 "ic" : "3.86",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSCSSG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GrggvG",
 "branch" : 9,
 "id" : "cluster_3_node_9",
 "ic" : "1.99",
 "size" : 7,
 "name" : "cluster_3_node_9_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_9_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_9_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GrggrG",
 "branch" : 8,
 "id" : "cluster_3_node_8",
 "ic" : "2.61",
 "size" : 7,
 "name" : "cluster_3_node_8_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_8_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_8_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m74_kernel_203_number_of_sequence_7400", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m74_kernel_203_number_of_sequence_7400_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m74_kernel_203_number_of_sequence_7400_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m74_kernel_203_number_of_sequence_7400_logo.png",
 "name" : "kernel_203_number_of_sequence_7400",
 "ic" : "2.65",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYCYYC"
 },
 {
  "label": "2020-03-04t14-27-25z_m270_kernel_727_number_of_sequence_4725", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m270_kernel_727_number_of_sequence_4725_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m270_kernel_727_number_of_sequence_4725_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m270_kernel_727_number_of_sequence_4725_logo.png",
 "name" : "kernel_727_number_of_sequence_4725",
 "ic" : "3.44",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRGRVG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m191_kernel_507_number_of_sequence_12697", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m191_kernel_507_number_of_sequence_12697_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m191_kernel_507_number_of_sequence_12697_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m191_kernel_507_number_of_sequence_12697_logo.png",
 "name" : "kernel_507_number_of_sequence_12697",
 "ic" : "1.89",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GAKGCG"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m110_kernel_284_number_of_sequence_14441", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m110_kernel_284_number_of_sequence_14441_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m110_kernel_284_number_of_sequence_14441_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m110_kernel_284_number_of_sequence_14441_logo.png",
 "name" : "kernel_284_number_of_sequence_14441",
 "ic" : "4.42",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCGGGG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m209_kernel_555_number_of_sequence_12332", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m209_kernel_555_number_of_sequence_12332_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m209_kernel_555_number_of_sequence_12332_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m209_kernel_555_number_of_sequence_12332_logo.png",
 "name" : "kernel_555_number_of_sequence_12332",
 "ic" : "2.33",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCDGMG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m55_kernel_153_number_of_sequence_6756", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m55_kernel_153_number_of_sequence_6756_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m55_kernel_153_number_of_sequence_6756_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m55_kernel_153_number_of_sequence_6756_logo.png",
 "name" : "kernel_153_number_of_sequence_6756",
 "ic" : "3.97",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCSCMG"
 } 
 ] 
 },
 {
  "consensus" : "GGcksCG",
 "branch" : 16,
 "id" : "cluster_3_node_16",
 "ic" : "3.43",
 "size" : 7,
 "name" : "cluster_3_node_16_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_16_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_16_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m253_kernel_683_number_of_sequence_8235", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m253_kernel_683_number_of_sequence_8235_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m253_kernel_683_number_of_sequence_8235_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m253_kernel_683_number_of_sequence_8235_logo.png",
 "name" : "kernel_683_number_of_sequence_8235",
 "ic" : "4.15",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CGYMGCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m318_kernel_859_number_of_sequence_7344", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m318_kernel_859_number_of_sequence_7344_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m318_kernel_859_number_of_sequence_7344_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m318_kernel_859_number_of_sequence_7344_logo.png",
 "name" : "kernel_859_number_of_sequence_7344",
 "ic" : "3.48",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSSMGCC"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_3").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#489A6E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_3"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#489A6E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_3" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#489A6E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_3").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_3").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_3").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_3").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_4").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CmwGycsggrCwkG",
 "branch" : 1,
 "id" : "cluster_4_node_1",
 "ic" : "5.31",
 "size" : 14,
 "name" : "cluster_4",
 "image" : "matrix-clustering_aligned_logos/cluster_4_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_4_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m162_kernel_434_number_of_sequence_6452", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m162_kernel_434_number_of_sequence_6452_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m162_kernel_434_number_of_sequence_6452_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m162_kernel_434_number_of_sequence_6452_logo.png",
 "name" : "kernel_434_number_of_sequence_6452",
 "ic" : "5.56",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CATGYCCSRRCAKG"
 },
 {
  "label": "2020-03-04t14-27-25z_m212_kernel_565_number_of_sequence_8914", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m212_kernel_565_number_of_sequence_8914_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m212_kernel_565_number_of_sequence_8914_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m212_kernel_565_number_of_sequence_8914_logo.png",
 "name" : "kernel_565_number_of_sequence_8914",
 "ic" : "5.48",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMWGYCSGGRCHKG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_4").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#55986A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_4"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#55986A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_4" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#55986A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_4").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_4").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_4").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_4").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 22;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_5").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GGGgggGGgsgGG",
 "branch" : 19,
 "id" : "cluster_5_node_19",
 "ic" : "5.90",
 "size" : 13,
 "name" : "cluster_5",
 "image" : "matrix-clustering_aligned_logos/cluster_5_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGgggGGgsgGG",
 "branch" : 18,
 "id" : "cluster_5_node_18",
 "ic" : "6.01",
 "size" : 13,
 "name" : "cluster_5_node_18_19motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_18_19motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_18_19motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGgggGGgsgGG",
 "branch" : 17,
 "id" : "cluster_5_node_17",
 "ic" : "6.07",
 "size" : 13,
 "name" : "cluster_5_node_17_18motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_17_18motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_17_18motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGgggGGgsgGG",
 "branch" : 16,
 "id" : "cluster_5_node_16",
 "ic" : "6.05",
 "size" : 13,
 "name" : "cluster_5_node_16_17motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_16_17motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_16_17motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGggGGGssGGG",
 "branch" : 13,
 "id" : "cluster_5_node_13",
 "ic" : "6.28",
 "size" : 13,
 "name" : "cluster_5_node_13_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_13_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_13_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGggGGGssGGG",
 "branch" : 9,
 "id" : "cluster_5_node_9",
 "ic" : "6.36",
 "size" : 13,
 "name" : "cluster_5_node_9_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_9_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_9_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GgggGGGcsGG",
 "branch" : 5,
 "id" : "cluster_5_node_5",
 "ic" : "5.71",
 "size" : 13,
 "name" : "cluster_5_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m285_kernel_769_number_of_sequence_11655", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m285_kernel_769_number_of_sequence_11655_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m285_kernel_769_number_of_sequence_11655_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m285_kernel_769_number_of_sequence_11655_logo.png",
 "name" : "kernel_769_number_of_sequence_11655",
 "ic" : "5.99",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGGGRSCGGR"
 },
 {
  "label": "2020-03-04t14-27-25z_m37_kernel_95_number_of_sequence_11260", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m37_kernel_95_number_of_sequence_11260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m37_kernel_95_number_of_sequence_11260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m37_kernel_95_number_of_sequence_11260_logo.png",
 "name" : "kernel_95_number_of_sequence_11260",
 "ic" : "6.39",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSGCCCSSCC"
 } 
 ] 
 },
 {
  "consensus" : "GGGsgGGGssGGG",
 "branch" : 8,
 "id" : "cluster_5_node_8",
 "ic" : "6.42",
 "size" : 13,
 "name" : "cluster_5_node_8_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_8_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_8_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGGsgGGGssgrG",
 "branch" : 3,
 "id" : "cluster_5_node_3",
 "ic" : "6.74",
 "size" : 13,
 "name" : "cluster_5_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GrgsgGGGssGGG",
 "branch" : 2,
 "id" : "cluster_5_node_2",
 "ic" : "7.10",
 "size" : 13,
 "name" : "cluster_5_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m250_kernel_676_number_of_sequence_8968", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m250_kernel_676_number_of_sequence_8968_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m250_kernel_676_number_of_sequence_8968_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m250_kernel_676_number_of_sequence_8968_logo.png",
 "name" : "kernel_676_number_of_sequence_8968",
 "ic" : "7.55",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRGSKGGGGSGGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m249_kernel_675_number_of_sequence_8898", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m249_kernel_675_number_of_sequence_8898_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m249_kernel_675_number_of_sequence_8898_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m249_kernel_675_number_of_sequence_8898_logo.png",
 "name" : "kernel_675_number_of_sequence_8898",
 "ic" : "7.43",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRGGGGGGYGGRR"
 } 
 ] 
 },
 {
  "consensus" : "GGGbGGGGscgrG",
 "branch" : 1,
 "id" : "cluster_5_node_1",
 "ic" : "7.29",
 "size" : 13,
 "name" : "cluster_5_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m169_kernel_450_number_of_sequence_7056", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m169_kernel_450_number_of_sequence_7056_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m169_kernel_450_number_of_sequence_7056_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m169_kernel_450_number_of_sequence_7056_logo.png",
 "name" : "kernel_450_number_of_sequence_7056",
 "ic" : "8.00",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGYGGGGCSGRG"
 },
 {
  "label": "2020-03-04t14-27-25z_m149_kernel_389_number_of_sequence_10748", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m149_kernel_389_number_of_sequence_10748_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m149_kernel_389_number_of_sequence_10748_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m149_kernel_389_number_of_sequence_10748_logo.png",
 "name" : "kernel_389_number_of_sequence_10748",
 "ic" : "7.38",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGKGGGGBCSRG"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GgrrgGGgsGGG",
 "branch" : 7,
 "id" : "cluster_5_node_7",
 "ic" : "6.01",
 "size" : 13,
 "name" : "cluster_5_node_7_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_7_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_7_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m240_kernel_649_number_of_sequence_8108", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m240_kernel_649_number_of_sequence_8108_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m240_kernel_649_number_of_sequence_8108_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m240_kernel_649_number_of_sequence_8108_logo.png",
 "name" : "kernel_649_number_of_sequence_8108",
 "ic" : "6.43",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCCCCCYYCCC"
 },
 {
  "consensus" : "GgrgGGGscGGG",
 "branch" : 6,
 "id" : "cluster_5_node_6",
 "ic" : "6.39",
 "size" : 13,
 "name" : "cluster_5_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m155_kernel_406_number_of_sequence_12618", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m155_kernel_406_number_of_sequence_12618_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m155_kernel_406_number_of_sequence_12618_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m155_kernel_406_number_of_sequence_12618_logo.png",
 "name" : "kernel_406_number_of_sequence_12618",
 "ic" : "6.87",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGRGGGGGCGGR"
 },
 {
  "label": "2020-03-04t14-27-25z_m296_kernel_799_number_of_sequence_7901", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m296_kernel_799_number_of_sequence_7901_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m296_kernel_799_number_of_sequence_7901_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m296_kernel_799_number_of_sequence_7901_logo.png",
 "name" : "kernel_799_number_of_sequence_7901",
 "ic" : "7.05",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCVSCCCYCYC"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m44_kernel_115_number_of_sequence_8285", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m44_kernel_115_number_of_sequence_8285_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m44_kernel_115_number_of_sequence_8285_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m44_kernel_115_number_of_sequence_8285_logo.png",
 "name" : "kernel_115_number_of_sequence_8285",
 "ic" : "7.08",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYCCKCCCCCTC"
 } 
 ] 
 },
 {
  "consensus" : "GgrgGGgsgG",
 "branch" : 15,
 "id" : "cluster_5_node_15",
 "ic" : "3.91",
 "size" : 13,
 "name" : "cluster_5_node_15_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_15_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_15_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GrrggGssgG",
 "branch" : 12,
 "id" : "cluster_5_node_12",
 "ic" : "3.96",
 "size" : 13,
 "name" : "cluster_5_node_12_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_12_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_12_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GrrGgGgsGG",
 "branch" : 11,
 "id" : "cluster_5_node_11",
 "ic" : "4.38",
 "size" : 13,
 "name" : "cluster_5_node_11_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_11_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_11_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GrrGrGGcGG",
 "branch" : 10,
 "id" : "cluster_5_node_10",
 "ic" : "5.20",
 "size" : 13,
 "name" : "cluster_5_node_10_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_10_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_10_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m201_kernel_538_number_of_sequence_9956", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m201_kernel_538_number_of_sequence_9956_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m201_kernel_538_number_of_sequence_9956_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m201_kernel_538_number_of_sequence_9956_logo.png",
 "name" : "kernel_538_number_of_sequence_9956",
 "ic" : "6.50",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRSGRGGMGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m320_kernel_867_number_of_sequence_8336", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m320_kernel_867_number_of_sequence_8336_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m320_kernel_867_number_of_sequence_8336_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m320_kernel_867_number_of_sequence_8336_logo.png",
 "name" : "kernel_867_number_of_sequence_8336",
 "ic" : "4.91",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSVCYCTYC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m54_kernel_151_number_of_sequence_13482", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m54_kernel_151_number_of_sequence_13482_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m54_kernel_151_number_of_sequence_13482_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m54_kernel_151_number_of_sequence_13482_logo.png",
 "name" : "kernel_151_number_of_sequence_13482",
 "ic" : "4.40",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GWKGGGSSGG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m111_kernel_286_number_of_sequence_9209", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m111_kernel_286_number_of_sequence_9209_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m111_kernel_286_number_of_sequence_9209_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m111_kernel_286_number_of_sequence_9209_logo.png",
 "name" : "kernel_286_number_of_sequence_9209",
 "ic" : "3.75",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "SKKRGGSCSG"
 } 
 ] 
 },
 {
  "consensus" : "GGrgGGGggG",
 "branch" : 14,
 "id" : "cluster_5_node_14",
 "ic" : "4.68",
 "size" : 13,
 "name" : "cluster_5_node_14_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_14_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_14_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGgggGGgrG",
 "branch" : 4,
 "id" : "cluster_5_node_4",
 "ic" : "5.01",
 "size" : 13,
 "name" : "cluster_5_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m239_kernel_646_number_of_sequence_9243", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m239_kernel_646_number_of_sequence_9243_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m239_kernel_646_number_of_sequence_9243_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m239_kernel_646_number_of_sequence_9243_logo.png",
 "name" : "kernel_646_number_of_sequence_9243",
 "ic" : "5.06",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCCCCMKCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m81_kernel_214_number_of_sequence_4823", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m81_kernel_214_number_of_sequence_4823_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m81_kernel_214_number_of_sequence_4823_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m81_kernel_214_number_of_sequence_4823_logo.png",
 "name" : "kernel_214_number_of_sequence_4823",
 "ic" : "5.94",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGKGRGGGMG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m134_kernel_339_number_of_sequence_9493", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m134_kernel_339_number_of_sequence_9493_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m134_kernel_339_number_of_sequence_9493_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m134_kernel_339_number_of_sequence_9493_logo.png",
 "name" : "kernel_339_number_of_sequence_9493",
 "ic" : "5.50",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCMSCCYCC"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m142_kernel_358_number_of_sequence_8490", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m142_kernel_358_number_of_sequence_8490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m142_kernel_358_number_of_sequence_8490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m142_kernel_358_number_of_sequence_8490_logo.png",
 "name" : "kernel_358_number_of_sequence_8490",
 "ic" : "5.95",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCBCCCCYYCC"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m272_kernel_736_number_of_sequence_10683", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m272_kernel_736_number_of_sequence_10683_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m272_kernel_736_number_of_sequence_10683_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m272_kernel_736_number_of_sequence_10683_logo.png",
 "name" : "kernel_736_number_of_sequence_10683",
 "ic" : "5.74",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSCMCCCMYY"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m273_kernel_741_number_of_sequence_13343", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m273_kernel_741_number_of_sequence_13343_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m273_kernel_741_number_of_sequence_13343_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m273_kernel_741_number_of_sequence_13343_logo.png",
 "name" : "kernel_741_number_of_sequence_13343",
 "ic" : "4.52",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGWRGSGSSRG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_5").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#619666");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_5"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#619666"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_5" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#619666")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_5").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_5").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_5").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_5").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 5;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_6").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "TstcyCC",
 "branch" : 2,
 "id" : "cluster_6_node_2",
 "ic" : "3.20",
 "size" : 7,
 "name" : "cluster_6",
 "image" : "matrix-clustering_aligned_logos/cluster_6_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m222_kernel_604_number_of_sequence_3306", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m222_kernel_604_number_of_sequence_3306_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m222_kernel_604_number_of_sequence_3306_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m222_kernel_604_number_of_sequence_3306_logo.png",
 "name" : "kernel_604_number_of_sequence_3306",
 "ic" : "3.38",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGAGARA"
 },
 {
  "consensus" : "TsysyC",
 "branch" : 1,
 "id" : "cluster_6_node_1",
 "ic" : "2.73",
 "size" : 7,
 "name" : "cluster_6_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m20_kernel_58_number_of_sequence_3048", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m20_kernel_58_number_of_sequence_3048_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m20_kernel_58_number_of_sequence_3048_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m20_kernel_58_number_of_sequence_3048_logo.png",
 "name" : "kernel_58_number_of_sequence_3048",
 "ic" : "2.69",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRSASA"
 },
 {
  "label": "2020-03-04t14-27-25z_m232_kernel_630_number_of_sequence_1182", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m232_kernel_630_number_of_sequence_1182_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m232_kernel_630_number_of_sequence_1182_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m232_kernel_630_number_of_sequence_1182_logo.png",
 "name" : "kernel_630_number_of_sequence_1182",
 "ic" : "3.74",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGYCYC"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_6").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#6B9461");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_6"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#6B9461"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_6" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#6B9461")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_6").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_6").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_6").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_6").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 7;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_7").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CCyccccCcsscCC",
 "branch" : 4,
 "id" : "cluster_7_node_4",
 "ic" : "5.30",
 "size" : 14,
 "name" : "cluster_7",
 "image" : "matrix-clustering_aligned_logos/cluster_7_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_logo_rc.png",

  "children": [
  {
  "consensus" : "CCyccsCCcssCcC",
 "branch" : 3,
 "id" : "cluster_7_node_3",
 "ic" : "6.08",
 "size" : 14,
 "name" : "cluster_7_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m61_kernel_170_number_of_sequence_7481", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m61_kernel_170_number_of_sequence_7481_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m61_kernel_170_number_of_sequence_7481_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m61_kernel_170_number_of_sequence_7481_logo.png",
 "name" : "kernel_170_number_of_sequence_7481",
 "ic" : "6.51",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGSKKGGRYGSGG"
 },
 {
  "consensus" : "CCtccsCCsssCcC",
 "branch" : 2,
 "id" : "cluster_7_node_2",
 "ic" : "6.52",
 "size" : 14,
 "name" : "cluster_7_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m41_kernel_107_number_of_sequence_9254", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m41_kernel_107_number_of_sequence_9254_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m41_kernel_107_number_of_sequence_9254_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m41_kernel_107_number_of_sequence_9254_logo.png",
 "name" : "kernel_107_number_of_sequence_9254",
 "ic" : "7.78",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCTYCKCCCCGCCC"
 },
 {
  "consensus" : "CtcccCCssCCcC",
 "branch" : 1,
 "id" : "cluster_7_node_1",
 "ic" : "5.95",
 "size" : 14,
 "name" : "cluster_7_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m275_kernel_747_number_of_sequence_8557", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m275_kernel_747_number_of_sequence_8557_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m275_kernel_747_number_of_sequence_8557_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m275_kernel_747_number_of_sequence_8557_logo.png",
 "name" : "kernel_747_number_of_sequence_8557",
 "ic" : "6.68",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CTCCCCCSSSCCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m24_kernel_67_number_of_sequence_7001", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m24_kernel_67_number_of_sequence_7001_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m24_kernel_67_number_of_sequence_7001_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m24_kernel_67_number_of_sequence_7001_logo.png",
 "name" : "kernel_67_number_of_sequence_7001",
 "ic" : "6.65",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGGSGGGGMGVG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m95_kernel_252_number_of_sequence_12175", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m95_kernel_252_number_of_sequence_12175_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m95_kernel_252_number_of_sequence_12175_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m95_kernel_252_number_of_sequence_12175_logo.png",
 "name" : "kernel_252_number_of_sequence_12175",
 "ic" : "4.75",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGRSSKSRRGSKG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_7").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#74925D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_7"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#74925D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_7" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#74925D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_7").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_7").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_7").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_7").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 6;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_8").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "mcCakcysC",
 "branch" : 3,
 "id" : "cluster_8_node_3",
 "ic" : "3.23",
 "size" : 9,
 "name" : "cluster_8",
 "image" : "matrix-clustering_aligned_logos/cluster_8_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m314_kernel_849_number_of_sequence_8376", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m314_kernel_849_number_of_sequence_8376_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m314_kernel_849_number_of_sequence_8376_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m314_kernel_849_number_of_sequence_8376_logo.png",
 "name" : "kernel_849_number_of_sequence_8376",
 "ic" : "3.46",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GVRGCWGRK"
 },
 {
  "consensus" : "CCatstcC",
 "branch" : 2,
 "id" : "cluster_8_node_2",
 "ic" : "3.10",
 "size" : 9,
 "name" : "cluster_8_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m23_kernel_66_number_of_sequence_1076", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m23_kernel_66_number_of_sequence_1076_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m23_kernel_66_number_of_sequence_1076_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m23_kernel_66_number_of_sequence_1076_logo.png",
 "name" : "kernel_66_number_of_sequence_1076",
 "ic" : "2.98",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSASHGRG"
 },
 {
  "consensus" : "CCaysycC",
 "branch" : 1,
 "id" : "cluster_8_node_1",
 "ic" : "3.41",
 "size" : 9,
 "name" : "cluster_8_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m205_kernel_546_number_of_sequence_2938", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m205_kernel_546_number_of_sequence_2938_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m205_kernel_546_number_of_sequence_2938_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m205_kernel_546_number_of_sequence_2938_logo.png",
 "name" : "kernel_546_number_of_sequence_2938",
 "ic" : "3.82",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGKGMKGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m88_kernel_241_number_of_sequence_4599", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m88_kernel_241_number_of_sequence_4599_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m88_kernel_241_number_of_sequence_4599_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m88_kernel_241_number_of_sequence_4599_logo.png",
 "name" : "kernel_241_number_of_sequence_4599",
 "ic" : "3.87",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCAYSTSC"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_8").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#7C9059");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_8"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#7C9059"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_8" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#7C9059")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_8").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_8").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_8").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_8").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_9").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "AywwGG",
 "branch" : 1,
 "id" : "cluster_9_node_1",
 "ic" : "2.67",
 "size" : 6,
 "name" : "cluster_9",
 "image" : "matrix-clustering_aligned_logos/cluster_9_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m188_kernel_498_number_of_sequence_1395", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m188_kernel_498_number_of_sequence_1395_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m188_kernel_498_number_of_sequence_1395_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m188_kernel_498_number_of_sequence_1395_logo.png",
 "name" : "kernel_498_number_of_sequence_1395",
 "ic" : "3.08",
 "size" : 6,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCHWRT"
 },
 {
  "label": "2020-03-04t14-27-25z_m298_kernel_805_number_of_sequence_1073", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m298_kernel_805_number_of_sequence_1073_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m298_kernel_805_number_of_sequence_1073_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m298_kernel_805_number_of_sequence_1073_logo.png",
 "name" : "kernel_805_number_of_sequence_1073",
 "ic" : "2.80",
 "size" : 6,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCAART"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_9").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#848E55");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_9"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#848E55"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_9" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#848E55")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_9").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_9").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_9").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_9").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 7;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_10").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CCasssgGGsGssG",
 "branch" : 4,
 "id" : "cluster_10_node_4",
 "ic" : "5.48",
 "size" : 14,
 "name" : "cluster_10",
 "image" : "matrix-clustering_aligned_logos/cluster_10_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_logo_rc.png",

  "children": [
  {
  "consensus" : "CCmsssgGGsGsgG",
 "branch" : 3,
 "id" : "cluster_10_node_3",
 "ic" : "6.02",
 "size" : 14,
 "name" : "cluster_10_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "CCmsssGGGsGsGG",
 "branch" : 2,
 "id" : "cluster_10_node_2",
 "ic" : "6.44",
 "size" : 14,
 "name" : "cluster_10_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m251_kernel_677_number_of_sequence_7850", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m251_kernel_677_number_of_sequence_7850_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m251_kernel_677_number_of_sequence_7850_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m251_kernel_677_number_of_sequence_7850_logo.png",
 "name" : "kernel_677_number_of_sequence_7850",
 "ic" : "6.60",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSCGCCCSSSKSG"
 },
 {
  "consensus" : "CysssGGGsGsGG",
 "branch" : 1,
 "id" : "cluster_10_node_1",
 "ic" : "5.96",
 "size" : 14,
 "name" : "cluster_10_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m137_kernel_349_number_of_sequence_9664", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m137_kernel_349_number_of_sequence_9664_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m137_kernel_349_number_of_sequence_9664_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m137_kernel_349_number_of_sequence_9664_logo.png",
 "name" : "kernel_349_number_of_sequence_9664",
 "ic" : "6.07",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSSCSCCCSSSSG"
 },
 {
  "label": "2020-03-04t14-27-25z_m301_kernel_813_number_of_sequence_6743", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m301_kernel_813_number_of_sequence_6743_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m301_kernel_813_number_of_sequence_6743_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m301_kernel_813_number_of_sequence_6743_logo.png",
 "name" : "kernel_813_number_of_sequence_6743",
 "ic" : "5.97",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSCSYSCSSSWG"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m163_kernel_438_number_of_sequence_7816", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m163_kernel_438_number_of_sequence_7816_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m163_kernel_438_number_of_sequence_7816_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m163_kernel_438_number_of_sequence_7816_logo.png",
 "name" : "kernel_438_number_of_sequence_7816",
 "ic" : "6.05",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSSSSCCYYWCKGG"
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m206_kernel_547_number_of_sequence_8723", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m206_kernel_547_number_of_sequence_8723_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m206_kernel_547_number_of_sequence_8723_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m206_kernel_547_number_of_sequence_8723_logo.png",
 "name" : "kernel_547_number_of_sequence_8723",
 "ic" : "4.92",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CRRSRGSRKGRSG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_10").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#8B8B50");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_10"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#8B8B50"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_10" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#8B8B50")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_10").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_10").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_10").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_10").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 5;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_11").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CysbgsggG",
 "branch" : 2,
 "id" : "cluster_11_node_2",
 "ic" : "2.73",
 "size" : 9,
 "name" : "cluster_11",
 "image" : "matrix-clustering_aligned_logos/cluster_11_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m150_kernel_393_number_of_sequence_5820", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m150_kernel_393_number_of_sequence_5820_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m150_kernel_393_number_of_sequence_5820_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m150_kernel_393_number_of_sequence_5820_logo.png",
 "name" : "kernel_393_number_of_sequence_5820",
 "ic" : "3.63",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCMYMASHG"
 },
 {
  "consensus" : "CyssgsgsG",
 "branch" : 1,
 "id" : "cluster_11_node_1",
 "ic" : "2.97",
 "size" : 9,
 "name" : "cluster_11_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m69_kernel_182_number_of_sequence_8597", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m69_kernel_182_number_of_sequence_8597_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m69_kernel_182_number_of_sequence_8597_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m69_kernel_182_number_of_sequence_8597_logo.png",
 "name" : "kernel_182_number_of_sequence_8597",
 "ic" : "3.32",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYCSCSCRG"
 },
 {
  "label": "2020-03-04t14-27-25z_m92_kernel_247_number_of_sequence_11023", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m92_kernel_247_number_of_sequence_11023_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m92_kernel_247_number_of_sequence_11023_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m92_kernel_247_number_of_sequence_11023_logo.png",
 "name" : "kernel_247_number_of_sequence_11023",
 "ic" : "3.54",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSYGBKSG"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_11").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#92894C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_11"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#92894C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_11" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#92894C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_11").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_11").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_11").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_11").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_12").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m218_kernel_596_number_of_sequence_11187",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m218_kernel_596_number_of_sequence_11187_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m218_kernel_596_number_of_sequence_11187_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m218_kernel_596_number_of_sequence_11187_logo.png",
 "name" : "kernel_596_number_of_sequence_11187",
 "ic" : "5.89",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCKCCCMKYYCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_12").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#988648");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_12"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#988648"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_12" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#988648")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_12").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_12").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_12").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_12").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 7;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_13").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "scsssscccsccsCsCsC",
 "branch" : 4,
 "id" : "cluster_13_node_4",
 "ic" : "6.52",
 "size" : 18,
 "name" : "cluster_13",
 "image" : "matrix-clustering_aligned_logos/cluster_13_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_13_logo_rc.png",

  "children": [
  {
  "consensus" : "SCsssscccscccCsCsC",
 "branch" : 3,
 "id" : "cluster_13_node_3",
 "ic" : "6.61",
 "size" : 18,
 "name" : "cluster_13_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_13_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_13_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "SsCsscCCcssccCsscC",
 "branch" : 2,
 "id" : "cluster_13_node_2",
 "ic" : "7.97",
 "size" : 18,
 "name" : "cluster_13_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_13_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_13_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m246_kernel_671_number_of_sequence_11218", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m246_kernel_671_number_of_sequence_11218_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m246_kernel_671_number_of_sequence_11218_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m246_kernel_671_number_of_sequence_11218_logo.png",
 "name" : "kernel_671_number_of_sequence_11218",
 "ic" : "8.97",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCSSSCCCSSCSCSSSS"
 },
 {
  "label": "2020-03-04t14-27-25z_m83_kernel_224_number_of_sequence_4724", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m83_kernel_224_number_of_sequence_4724_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m83_kernel_224_number_of_sequence_4724_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m83_kernel_224_number_of_sequence_4724_logo.png",
 "name" : "kernel_224_number_of_sequence_4724",
 "ic" : "10.22",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "SSSMKCCCMGCCCCSCCC"
 } 
 ] 
 },
 {
  "consensus" : "CksssyyCsCcsCgCsC",
 "branch" : 1,
 "id" : "cluster_13_node_1",
 "ic" : "6.46",
 "size" : 18,
 "name" : "cluster_13_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_13_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_13_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m77_kernel_207_number_of_sequence_8824", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m77_kernel_207_number_of_sequence_8824_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m77_kernel_207_number_of_sequence_8824_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m77_kernel_207_number_of_sequence_8824_logo.png",
 "name" : "kernel_207_number_of_sequence_8824",
 "ic" : "6.86",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSGCGSGGCSRRCBVMG"
 },
 {
  "label": "2020-03-04t14-27-25z_m135_kernel_343_number_of_sequence_13197", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m135_kernel_343_number_of_sequence_13197_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m135_kernel_343_number_of_sequence_13197_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m135_kernel_343_number_of_sequence_13197_logo.png",
 "name" : "kernel_343_number_of_sequence_13197",
 "ic" : "7.48",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CKSSSCYCSCCCCSCYC"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m6_kernel_16_number_of_sequence_7625", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m6_kernel_16_number_of_sequence_7625_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m6_kernel_16_number_of_sequence_7625_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m6_kernel_16_number_of_sequence_7625_logo.png",
 "name" : "kernel_16_number_of_sequence_7625",
 "ic" : "10.09",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSSCYSSSSGSSSSSGSC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_13").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9F8443");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_13"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9F8443"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_13" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9F8443")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_13").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_13").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_13").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_13").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_14").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m269_kernel_726_number_of_sequence_20611",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m269_kernel_726_number_of_sequence_20611_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m269_kernel_726_number_of_sequence_20611_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m269_kernel_726_number_of_sequence_20611_logo.png",
 "name" : "kernel_726_number_of_sequence_20611",
 "ic" : "3.76",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMCCKSYRSCCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_14").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A5813F");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_14"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A5813F"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_14" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A5813F")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_14").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_14").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_14").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_14").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 6;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_15").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CsscscsgC",
 "branch" : 3,
 "id" : "cluster_15_node_3",
 "ic" : "2.83",
 "size" : 9,
 "name" : "cluster_15",
 "image" : "matrix-clustering_aligned_logos/cluster_15_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_15_logo_rc.png",

  "children": [
  {
  "consensus" : "CksmhcygC",
 "branch" : 1,
 "id" : "cluster_15_node_1",
 "ic" : "2.50",
 "size" : 9,
 "name" : "cluster_15_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_15_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_15_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m128_kernel_332_number_of_sequence_10621", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m128_kernel_332_number_of_sequence_10621_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m128_kernel_332_number_of_sequence_10621_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m128_kernel_332_number_of_sequence_10621_logo.png",
 "name" : "kernel_332_number_of_sequence_10621",
 "ic" : "3.20",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSBMYCYGC"
 },
 {
  "label": "2020-03-04t14-27-25z_m30_kernel_79_number_of_sequence_7529", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m30_kernel_79_number_of_sequence_7529_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m30_kernel_79_number_of_sequence_7529_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m30_kernel_79_number_of_sequence_7529_logo.png",
 "name" : "kernel_79_number_of_sequence_7529",
 "ic" : "2.44",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCRSWSSWG"
 } 
 ] 
 },
 {
  "consensus" : "CsCsscssC",
 "branch" : 2,
 "id" : "cluster_15_node_2",
 "ic" : "4.06",
 "size" : 9,
 "name" : "cluster_15_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_15_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_15_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m257_kernel_696_number_of_sequence_10264", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m257_kernel_696_number_of_sequence_10264_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m257_kernel_696_number_of_sequence_10264_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m257_kernel_696_number_of_sequence_10264_logo.png",
 "name" : "kernel_696_number_of_sequence_10264",
 "ic" : "4.21",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCYSKGGSG"
 },
 {
  "label": "2020-03-04t14-27-25z_m324_kernel_891_number_of_sequence_13811", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m324_kernel_891_number_of_sequence_13811_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m324_kernel_891_number_of_sequence_13811_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m324_kernel_891_number_of_sequence_13811_logo.png",
 "name" : "kernel_891_number_of_sequence_13811",
 "ic" : "5.25",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSSGSSGSG"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_15").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AA7E3A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_15"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AA7E3A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_15" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AA7E3A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_15").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_15").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_15").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_15").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_16").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "AGgscsrG",
 "branch" : 1,
 "id" : "cluster_16_node_1",
 "ic" : "3.44",
 "size" : 8,
 "name" : "cluster_16",
 "image" : "matrix-clustering_aligned_logos/cluster_16_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m244_kernel_669_number_of_sequence_6602", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m244_kernel_669_number_of_sequence_6602_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m244_kernel_669_number_of_sequence_6602_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m244_kernel_669_number_of_sequence_6602_logo.png",
 "name" : "kernel_669_number_of_sequence_6602",
 "ic" : "3.58",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYGKSCCT"
 },
 {
  "label": "2020-03-04t14-27-25z_m290_kernel_783_number_of_sequence_11559", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m290_kernel_783_number_of_sequence_11559_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m290_kernel_783_number_of_sequence_11559_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m290_kernel_783_number_of_sequence_11559_logo.png",
 "name" : "kernel_783_number_of_sequence_11559",
 "ic" : "2.98",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYCGSCC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_16").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B07C36");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_16"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B07C36"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_16" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B07C36")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_16").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_16").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_16").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_16").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 8;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_17").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GCcgskG",
 "branch" : 5,
 "id" : "cluster_17_node_5",
 "ic" : "2.65",
 "size" : 7,
 "name" : "cluster_17",
 "image" : "matrix-clustering_aligned_logos/cluster_17_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_17_logo_rc.png",

  "children": [
  {
  "consensus" : "GCcgskG",
 "branch" : 4,
 "id" : "cluster_17_node_4",
 "ic" : "2.66",
 "size" : 7,
 "name" : "cluster_17_node_4_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_17_node_4_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_17_node_4_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GcygskG",
 "branch" : 2,
 "id" : "cluster_17_node_2",
 "ic" : "2.55",
 "size" : 7,
 "name" : "cluster_17_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_17_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_17_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m36_kernel_94_number_of_sequence_6969", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m36_kernel_94_number_of_sequence_6969_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m36_kernel_94_number_of_sequence_6969_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m36_kernel_94_number_of_sequence_6969_logo.png",
 "name" : "kernel_94_number_of_sequence_6969",
 "ic" : "3.14",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CHSCWKC"
 },
 {
  "consensus" : "GCbbsbG",
 "branch" : 1,
 "id" : "cluster_17_node_1",
 "ic" : "2.88",
 "size" : 7,
 "name" : "cluster_17_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_17_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_17_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m27_kernel_71_number_of_sequence_10569", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m27_kernel_71_number_of_sequence_10569_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m27_kernel_71_number_of_sequence_10569_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m27_kernel_71_number_of_sequence_10569_logo.png",
 "name" : "kernel_71_number_of_sequence_10569",
 "ic" : "3.04",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CRSVMGC"
 },
 {
  "label": "2020-03-04t14-27-25z_m68_kernel_178_number_of_sequence_4317", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m68_kernel_178_number_of_sequence_4317_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m68_kernel_178_number_of_sequence_4317_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m68_kernel_178_number_of_sequence_4317_logo.png",
 "name" : "kernel_178_number_of_sequence_4317",
 "ic" : "3.90",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMGCGSC"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "CsgsgG",
 "branch" : 3,
 "id" : "cluster_17_node_3",
 "ic" : "2.52",
 "size" : 7,
 "name" : "cluster_17_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_17_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_17_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m118_kernel_308_number_of_sequence_7500", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m118_kernel_308_number_of_sequence_7500_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m118_kernel_308_number_of_sequence_7500_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m118_kernel_308_number_of_sequence_7500_logo.png",
 "name" : "kernel_308_number_of_sequence_7500",
 "ic" : "3.45",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSSCSG"
 },
 {
  "label": "2020-03-04t14-27-25z_m313_kernel_847_number_of_sequence_4968", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m313_kernel_847_number_of_sequence_4968_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m313_kernel_847_number_of_sequence_4968_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m313_kernel_847_number_of_sequence_4968_logo.png",
 "name" : "kernel_847_number_of_sequence_4968",
 "ic" : "2.79",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMGMKG"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "2020-03-04t14-27-25z_m158_kernel_424_number_of_sequence_7267", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m158_kernel_424_number_of_sequence_7267_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m158_kernel_424_number_of_sequence_7267_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m158_kernel_424_number_of_sequence_7267_logo.png",
 "name" : "kernel_424_number_of_sequence_7267",
 "ic" : "2.68",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CASCRG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_17").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B57931");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_17"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B57931"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_17" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B57931")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_17").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_17").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_17").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_17").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_18").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CCrssmGGgGG",
 "branch" : 1,
 "id" : "cluster_18_node_1",
 "ic" : "5.26",
 "size" : 11,
 "name" : "cluster_18",
 "image" : "matrix-clustering_aligned_logos/cluster_18_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m261_kernel_705_number_of_sequence_7964", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m261_kernel_705_number_of_sequence_7964_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m261_kernel_705_number_of_sequence_7964_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m261_kernel_705_number_of_sequence_7964_logo.png",
 "name" : "kernel_705_number_of_sequence_7964",
 "ic" : "4.91",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCVYCTRGYGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m49_kernel_139_number_of_sequence_11588", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m49_kernel_139_number_of_sequence_11588_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m49_kernel_139_number_of_sequence_11588_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m49_kernel_139_number_of_sequence_11588_logo.png",
 "name" : "kernel_139_number_of_sequence_11588",
 "ic" : "5.58",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCCKSSCGG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_18").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BB762C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_18"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BB762C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_18" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BB762C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_18").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_18").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_18").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_18").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 5;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_19").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GsgcmsmrCC",
 "branch" : 2,
 "id" : "cluster_19_node_2",
 "ic" : "2.66",
 "size" : 10,
 "name" : "cluster_19",
 "image" : "matrix-clustering_aligned_logos/cluster_19_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m303_kernel_823_number_of_sequence_6664", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m303_kernel_823_number_of_sequence_6664_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m303_kernel_823_number_of_sequence_6664_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m303_kernel_823_number_of_sequence_6664_logo.png",
 "name" : "kernel_823_number_of_sequence_6664",
 "ic" : "3.21",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSYSSYRYGC"
 },
 {
  "consensus" : "GsscmshgC",
 "branch" : 1,
 "id" : "cluster_19_node_1",
 "ic" : "2.38",
 "size" : 10,
 "name" : "cluster_19_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m50_kernel_140_number_of_sequence_6887", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m50_kernel_140_number_of_sequence_6887_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m50_kernel_140_number_of_sequence_6887_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m50_kernel_140_number_of_sequence_6887_logo.png",
 "name" : "kernel_140_number_of_sequence_6887",
 "ic" : "2.77",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GYTBKGKGC"
 },
 {
  "label": "2020-03-04t14-27-25z_m51_kernel_147_number_of_sequence_8517", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m51_kernel_147_number_of_sequence_8517_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m51_kernel_147_number_of_sequence_8517_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m51_kernel_147_number_of_sequence_8517_logo.png",
 "name" : "kernel_147_number_of_sequence_8517",
 "ic" : "2.99",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSDGDGVSC"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_19").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C07227");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_19"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C07227"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_19" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C07227")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_19").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_19").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_19").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_19").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_20").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CsSssbckvcagsG",
 "branch" : 1,
 "id" : "cluster_20_node_1",
 "ic" : "4.36",
 "size" : 14,
 "name" : "cluster_20",
 "image" : "matrix-clustering_aligned_logos/cluster_20_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m175_kernel_466_number_of_sequence_12402", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m175_kernel_466_number_of_sequence_12402_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m175_kernel_466_number_of_sequence_12402_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m175_kernel_466_number_of_sequence_12402_logo.png",
 "name" : "kernel_466_number_of_sequence_12402",
 "ic" : "4.78",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSCMGKMSMGSSSG"
 },
 {
  "label": "2020-03-04t14-27-25z_m62_kernel_171_number_of_sequence_6555", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m62_kernel_171_number_of_sequence_6555_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m62_kernel_171_number_of_sequence_6555_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m62_kernel_171_number_of_sequence_6555_logo.png",
 "name" : "kernel_171_number_of_sequence_6555",
 "ic" : "5.46",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSYKVYAGSSSGSG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_20").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C56F21");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_20"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C56F21"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_20" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C56F21")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_20").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_20").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_20").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_20").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_21").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GGgvmkggrG",
 "branch" : 1,
 "id" : "cluster_21_node_1",
 "ic" : "3.86",
 "size" : 10,
 "name" : "cluster_21",
 "image" : "matrix-clustering_aligned_logos/cluster_21_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_21_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m145_kernel_371_number_of_sequence_14518", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m145_kernel_371_number_of_sequence_14518_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m145_kernel_371_number_of_sequence_14518_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m145_kernel_371_number_of_sequence_14518_logo.png",
 "name" : "kernel_371_number_of_sequence_14518",
 "ic" : "4.26",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYCMMSKCCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m3_kernel_6_number_of_sequence_5269", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m3_kernel_6_number_of_sequence_5269_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m3_kernel_6_number_of_sequence_5269_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m3_kernel_6_number_of_sequence_5269_logo.png",
 "name" : "kernel_6_number_of_sequence_5269",
 "ic" : "4.99",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCCCKSYCC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_21").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CA6B1C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_21"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CA6B1C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_21" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CA6B1C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_21").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_21").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_21").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_21").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_22").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m260_kernel_703_number_of_sequence_5384",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m260_kernel_703_number_of_sequence_5384_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m260_kernel_703_number_of_sequence_5384_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m260_kernel_703_number_of_sequence_5384_logo.png",
 "name" : "kernel_703_number_of_sequence_5384",
 "ic" : "4.97",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGGGSMKSAG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_22").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CE6715");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_22"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CE6715"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_22" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CE6715")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_22").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_22").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_22").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_22").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_23").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m223_kernel_607_number_of_sequence_10017",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m223_kernel_607_number_of_sequence_10017_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m223_kernel_607_number_of_sequence_10017_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m223_kernel_607_number_of_sequence_10017_logo.png",
 "name" : "kernel_607_number_of_sequence_10017",
 "ic" : "4.23",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GKRGCCCHDG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_23").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D3630D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_23"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D3630D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_23" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D3630D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_23").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_23").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_23").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_23").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_24").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CkwGtCysgsC",
 "branch" : 1,
 "id" : "cluster_24_node_1",
 "ic" : "3.66",
 "size" : 11,
 "name" : "cluster_24",
 "image" : "matrix-clustering_aligned_logos/cluster_24_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m170_kernel_451_number_of_sequence_6565", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m170_kernel_451_number_of_sequence_6565_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m170_kernel_451_number_of_sequence_6565_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m170_kernel_451_number_of_sequence_6565_logo.png",
 "name" : "kernel_451_number_of_sequence_6565",
 "ic" : "4.50",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSSSGGACWTG"
 },
 {
  "label": "2020-03-04t14-27-25z_m291_kernel_784_number_of_sequence_8270", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m291_kernel_784_number_of_sequence_8270_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m291_kernel_784_number_of_sequence_8270_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m291_kernel_784_number_of_sequence_8270_logo.png",
 "name" : "kernel_784_number_of_sequence_8270",
 "ic" : "4.33",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSYSWGMCRMG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_24").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D85F03");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_24"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D85F03"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_24" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D85F03")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_24").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_24").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_24").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_24").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_25").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m207_kernel_550_number_of_sequence_6023",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m207_kernel_550_number_of_sequence_6023_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m207_kernel_550_number_of_sequence_6023_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m207_kernel_550_number_of_sequence_6023_logo.png",
 "name" : "kernel_550_number_of_sequence_6023",
 "ic" : "5.52",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GMGGSGYC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_25").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D65F11");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_25"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D65F11"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_25" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D65F11")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_25").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_25").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_25").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_25").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_26").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m234_kernel_636_number_of_sequence_8803",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m234_kernel_636_number_of_sequence_8803_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m234_kernel_636_number_of_sequence_8803_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m234_kernel_636_number_of_sequence_8803_logo.png",
 "name" : "kernel_636_number_of_sequence_8803",
 "ic" : "3.77",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCAYDCSMYCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_26").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D4601E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_26"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D4601E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_26" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D4601E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_26").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_26").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_26").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_26").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_27").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "TtkkkA",
 "branch" : 1,
 "id" : "cluster_27_node_1",
 "ic" : "2.22",
 "size" : 6,
 "name" : "cluster_27",
 "image" : "matrix-clustering_aligned_logos/cluster_27_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_27_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m102_kernel_266_number_of_sequence_1637", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m102_kernel_266_number_of_sequence_1637_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m102_kernel_266_number_of_sequence_1637_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m102_kernel_266_number_of_sequence_1637_logo.png",
 "name" : "kernel_266_number_of_sequence_1637",
 "ic" : "2.47",
 "size" : 6,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TMMWAA"
 },
 {
  "label": "2020-03-04t14-27-25z_m186_kernel_492_number_of_sequence_1572", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m186_kernel_492_number_of_sequence_1572_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m186_kernel_492_number_of_sequence_1572_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m186_kernel_492_number_of_sequence_1572_logo.png",
 "name" : "kernel_492_number_of_sequence_1572",
 "ic" : "2.81",
 "size" : 6,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TCCCWA"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_27").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D16127");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_27"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D16127"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_27" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D16127")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_27").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_27").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_27").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_27").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_28").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "sGCGsssmsckC",
 "branch" : 1,
 "id" : "cluster_28_node_1",
 "ic" : "4.57",
 "size" : 12,
 "name" : "cluster_28",
 "image" : "matrix-clustering_aligned_logos/cluster_28_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_28_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m178_kernel_475_number_of_sequence_11771", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m178_kernel_475_number_of_sequence_11771_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m178_kernel_475_number_of_sequence_11771_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m178_kernel_475_number_of_sequence_11771_logo.png",
 "name" : "kernel_475_number_of_sequence_11771",
 "ic" : "3.90",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GARGWSVKCGC"
 },
 {
  "label": "2020-03-04t14-27-25z_m229_kernel_625_number_of_sequence_9753", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m229_kernel_625_number_of_sequence_9753_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m229_kernel_625_number_of_sequence_9753_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m229_kernel_625_number_of_sequence_9753_logo.png",
 "name" : "kernel_625_number_of_sequence_9753",
 "ic" : "5.88",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GMGSSMGSSGCS"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_28").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CE6130");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_28"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CE6130"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_28" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CE6130")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_28").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_28").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_28").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_28").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_29").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "kGscCycyscCC",
 "branch" : 1,
 "id" : "cluster_29_node_1",
 "ic" : "3.96",
 "size" : 12,
 "name" : "cluster_29",
 "image" : "matrix-clustering_aligned_logos/cluster_29_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_29_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m182_kernel_483_number_of_sequence_9967", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m182_kernel_483_number_of_sequence_9967_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m182_kernel_483_number_of_sequence_9967_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m182_kernel_483_number_of_sequence_9967_logo.png",
 "name" : "kernel_483_number_of_sequence_9967",
 "ic" : "4.38",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSRBHGGRGMCM"
 },
 {
  "label": "2020-03-04t14-27-25z_m299_kernel_806_number_of_sequence_8504", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m299_kernel_806_number_of_sequence_8504_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m299_kernel_806_number_of_sequence_8504_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m299_kernel_806_number_of_sequence_8504_logo.png",
 "name" : "kernel_806_number_of_sequence_8504",
 "ic" : "4.16",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGCRGWGRSC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_29").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CB6238");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_29"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CB6238"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_29" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CB6238")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_29").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_29").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_29").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_29").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_30").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "AyacmrA",
 "branch" : 1,
 "id" : "cluster_30_node_1",
 "ic" : "2.58",
 "size" : 7,
 "name" : "cluster_30",
 "image" : "matrix-clustering_aligned_logos/cluster_30_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_30_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m1_kernel_1_number_of_sequence_1840", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m1_kernel_1_number_of_sequence_1840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m1_kernel_1_number_of_sequence_1840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m1_kernel_1_number_of_sequence_1840_logo.png",
 "name" : "kernel_1_number_of_sequence_1840",
 "ic" : "2.94",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TTKGKGT"
 },
 {
  "label": "2020-03-04t14-27-25z_m70_kernel_187_number_of_sequence_1433", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m70_kernel_187_number_of_sequence_1433_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m70_kernel_187_number_of_sequence_1433_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m70_kernel_187_number_of_sequence_1433_logo.png",
 "name" : "kernel_187_number_of_sequence_1433",
 "ic" : "3.16",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TCTKMRT"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_30").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C8633F");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_30"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C8633F"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_30" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C8633F")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_30").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_30").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_30").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_30").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_31").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m306_kernel_832_number_of_sequence_8412",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m306_kernel_832_number_of_sequence_8412_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m306_kernel_832_number_of_sequence_8412_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m306_kernel_832_number_of_sequence_8412_logo.png",
 "name" : "kernel_832_number_of_sequence_8412",
 "ic" : "4.56",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GYSYCRCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_31").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C56446");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_31"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C56446"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_31" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C56446")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_31").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_31").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_31").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_31").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_32").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m307_kernel_833_number_of_sequence_2062",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m307_kernel_833_number_of_sequence_2062_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m307_kernel_833_number_of_sequence_2062_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m307_kernel_833_number_of_sequence_2062_logo.png",
 "name" : "kernel_833_number_of_sequence_2062",
 "ic" : "4.22",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRCYCMCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_32").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C2644D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_32"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C2644D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_32" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C2644D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_32").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_32").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_32").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_32").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_33").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m22_kernel_64_number_of_sequence_10583",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m22_kernel_64_number_of_sequence_10583_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m22_kernel_64_number_of_sequence_10583_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m22_kernel_64_number_of_sequence_10583_logo.png",
 "name" : "kernel_64_number_of_sequence_10583",
 "ic" : "4.38",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCKSRSTCCSCG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_33").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BF6554");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_33"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BF6554"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_33" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BF6554")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_33").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_33").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_33").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_33").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_34").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GGargkG",
 "branch" : 1,
 "id" : "cluster_34_node_1",
 "ic" : "3.59",
 "size" : 7,
 "name" : "cluster_34",
 "image" : "matrix-clustering_aligned_logos/cluster_34_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_34_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m287_kernel_776_number_of_sequence_11654", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m287_kernel_776_number_of_sequence_11654_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m287_kernel_776_number_of_sequence_11654_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m287_kernel_776_number_of_sequence_11654_logo.png",
 "name" : "kernel_776_number_of_sequence_11654",
 "ic" : "4.46",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMCYTCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m317_kernel_855_number_of_sequence_3539", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m317_kernel_855_number_of_sequence_3539_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m317_kernel_855_number_of_sequence_3539_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m317_kernel_855_number_of_sequence_3539_logo.png",
 "name" : "kernel_855_number_of_sequence_3539",
 "ic" : "3.02",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYMTCCC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_34").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BB665B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_34"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BB665B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_34" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BB665B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_34").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_34").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_34").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_34").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_35").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m129_kernel_333_number_of_sequence_10892",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m129_kernel_333_number_of_sequence_10892_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m129_kernel_333_number_of_sequence_10892_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m129_kernel_333_number_of_sequence_10892_logo.png",
 "name" : "kernel_333_number_of_sequence_10892",
 "ic" : "6.39",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSSRRMGGGGGCGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_35").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B86761");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_35"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B86761"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_35" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B86761")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_35").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_35").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_35").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_35").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_36").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m233_kernel_631_number_of_sequence_2750",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m233_kernel_631_number_of_sequence_2750_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m233_kernel_631_number_of_sequence_2750_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m233_kernel_631_number_of_sequence_2750_logo.png",
 "name" : "kernel_631_number_of_sequence_2750",
 "ic" : "8.22",
 "size" : 16,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CTGCCCCCCCCCCGSG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_36").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B46768");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_36"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B46768"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_36" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B46768")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_36").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_36").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_36").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_36").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_37").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m323_kernel_889_number_of_sequence_5628",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m323_kernel_889_number_of_sequence_5628_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m323_kernel_889_number_of_sequence_5628_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m323_kernel_889_number_of_sequence_5628_logo.png",
 "name" : "kernel_889_number_of_sequence_5628",
 "ic" : "6.61",
 "size" : 16,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMSCCCCCSCCCCCAA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_37").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B0686F");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_37"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B0686F"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_37" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B0686F")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_37").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_37").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_37").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_37").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_38").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m280_kernel_753_number_of_sequence_1865",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m280_kernel_753_number_of_sequence_1865_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m280_kernel_753_number_of_sequence_1865_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m280_kernel_753_number_of_sequence_1865_logo.png",
 "name" : "kernel_753_number_of_sequence_1865",
 "ic" : "10.04",
 "size" : 16,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGGDGGGGGGRGGGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_38").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AC6975");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_38"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AC6975"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_38" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AC6975")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_38").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_38").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_38").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_38").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_39").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m133_kernel_338_number_of_sequence_12567",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m133_kernel_338_number_of_sequence_12567_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m133_kernel_338_number_of_sequence_12567_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m133_kernel_338_number_of_sequence_12567_logo.png",
 "name" : "kernel_338_number_of_sequence_12567",
 "ic" : "7.15",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCCCCTYYSYSCYSMGS"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_39").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A8697C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_39"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A8697C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_39" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A8697C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_39").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_39").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_39").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_39").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_40").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m166_kernel_444_number_of_sequence_6236",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m166_kernel_444_number_of_sequence_6236_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m166_kernel_444_number_of_sequence_6236_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m166_kernel_444_number_of_sequence_6236_logo.png",
 "name" : "kernel_444_number_of_sequence_6236",
 "ic" : "8.98",
 "size" : 20,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GVSGGRGKRGGRRGKGGSGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_40").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A36A82");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_40"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A36A82"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_40" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A36A82")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_40").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_40").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_40").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_40").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_41").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GrycysrsgscC",
 "branch" : 1,
 "id" : "cluster_41_node_1",
 "ic" : "3.57",
 "size" : 12,
 "name" : "cluster_41",
 "image" : "matrix-clustering_aligned_logos/cluster_41_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_41_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m58_kernel_158_number_of_sequence_11658", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m58_kernel_158_number_of_sequence_11658_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m58_kernel_158_number_of_sequence_11658_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m58_kernel_158_number_of_sequence_11658_logo.png",
 "name" : "kernel_158_number_of_sequence_11658",
 "ic" : "4.75",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGVCSCSRGDYC"
 },
 {
  "label": "2020-03-04t14-27-25z_m9_kernel_22_number_of_sequence_8273", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m9_kernel_22_number_of_sequence_8273_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m9_kernel_22_number_of_sequence_8273_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m9_kernel_22_number_of_sequence_8273_logo.png",
 "name" : "kernel_22_number_of_sequence_8273",
 "ic" : "3.93",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSBSSYGAKSCC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_41").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9E6B89");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_41"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9E6B89"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_41" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9E6B89")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_41").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_41").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_41").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_41").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_42").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GrGGsmdG",
 "branch" : 1,
 "id" : "cluster_42_node_1",
 "ic" : "3.60",
 "size" : 8,
 "name" : "cluster_42",
 "image" : "matrix-clustering_aligned_logos/cluster_42_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_42_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m127_kernel_331_number_of_sequence_5427", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m127_kernel_331_number_of_sequence_5427_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m127_kernel_331_number_of_sequence_5427_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m127_kernel_331_number_of_sequence_5427_logo.png",
 "name" : "kernel_331_number_of_sequence_5427",
 "ic" : "2.93",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CHTSCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m217_kernel_588_number_of_sequence_5855", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m217_kernel_588_number_of_sequence_5855_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m217_kernel_588_number_of_sequence_5855_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m217_kernel_588_number_of_sequence_5855_logo.png",
 "name" : "kernel_588_number_of_sequence_5855",
 "ic" : "3.49",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYKSCCYC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_42").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#996C8F");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_42"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#996C8F"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_42" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#996C8F")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_42").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_42").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_42").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_42").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_43").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CybCmGG",
 "branch" : 1,
 "id" : "cluster_43_node_1",
 "ic" : "3.34",
 "size" : 7,
 "name" : "cluster_43",
 "image" : "matrix-clustering_aligned_logos/cluster_43_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_43_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m221_kernel_601_number_of_sequence_5549", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m221_kernel_601_number_of_sequence_5549_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m221_kernel_601_number_of_sequence_5549_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m221_kernel_601_number_of_sequence_5549_logo.png",
 "name" : "kernel_601_number_of_sequence_5549",
 "ic" : "4.17",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYBCMGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m87_kernel_240_number_of_sequence_2398", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m87_kernel_240_number_of_sequence_2398_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m87_kernel_240_number_of_sequence_2398_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m87_kernel_240_number_of_sequence_2398_logo.png",
 "name" : "kernel_240_number_of_sequence_2398",
 "ic" : "3.52",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCWRRWG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_43").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#936C96");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_43"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#936C96"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_43" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#936C96")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_43").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_43").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_43").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_43").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_44").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m241_kernel_659_number_of_sequence_8543",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m241_kernel_659_number_of_sequence_8543_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m241_kernel_659_number_of_sequence_8543_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m241_kernel_659_number_of_sequence_8543_logo.png",
 "name" : "kernel_659_number_of_sequence_8543",
 "ic" : "4.75",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCAMSYAGSSG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_44").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#8D6D9D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_44"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#8D6D9D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_44" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#8D6D9D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_44").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_44").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_44").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_44").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_45").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m213_kernel_566_number_of_sequence_14127",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m213_kernel_566_number_of_sequence_14127_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m213_kernel_566_number_of_sequence_14127_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m213_kernel_566_number_of_sequence_14127_logo.png",
 "name" : "kernel_566_number_of_sequence_14127",
 "ic" : "2.82",
 "size" : 6,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRCSGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_45").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#866EA3");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_45"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#866EA3"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_45" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#866EA3")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_45").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_45").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_45").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_45").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_46").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m7_kernel_19_number_of_sequence_16071",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m7_kernel_19_number_of_sequence_16071_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m7_kernel_19_number_of_sequence_16071_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m7_kernel_19_number_of_sequence_16071_logo.png",
 "name" : "kernel_19_number_of_sequence_16071",
 "ic" : "5.13",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRGSCCSSSC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_46").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#7F6FAA");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_46"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#7F6FAA"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_46" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#7F6FAA")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_46").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_46").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_46").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_46").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_47").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m211_kernel_563_number_of_sequence_12635",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m211_kernel_563_number_of_sequence_12635_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m211_kernel_563_number_of_sequence_12635_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m211_kernel_563_number_of_sequence_12635_logo.png",
 "name" : "kernel_563_number_of_sequence_12635",
 "ic" : "5.28",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "SCSGCSMCGCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_47").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#776FB1");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_47"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#776FB1"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_47" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#776FB1")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_47").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_47").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_47").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_47").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_48").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m254_kernel_684_number_of_sequence_4687",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m254_kernel_684_number_of_sequence_4687_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m254_kernel_684_number_of_sequence_4687_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m254_kernel_684_number_of_sequence_4687_logo.png",
 "name" : "kernel_684_number_of_sequence_4687",
 "ic" : "5.44",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGAYYCCYGCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_48").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#796EB1");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_48"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#796EB1"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_48" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#796EB1")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_48").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_48").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_48").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_48").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_49").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m72_kernel_197_number_of_sequence_3773",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m72_kernel_197_number_of_sequence_3773_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m72_kernel_197_number_of_sequence_3773_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m72_kernel_197_number_of_sequence_3773_logo.png",
 "name" : "kernel_197_number_of_sequence_3773",
 "ic" : "4.82",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GASMGGGGRSC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_49").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#806DAF");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_49"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#806DAF"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_49" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#806DAF")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_49").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_49").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_49").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_49").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_50").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m53_kernel_149_number_of_sequence_8182",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m53_kernel_149_number_of_sequence_8182_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m53_kernel_149_number_of_sequence_8182_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m53_kernel_149_number_of_sequence_8182_logo.png",
 "name" : "kernel_149_number_of_sequence_8182",
 "ic" : "6.33",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GMKKGRGHSKGRSG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_50").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#866BAE");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_50"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#866BAE"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_50" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#866BAE")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_50").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_50").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_50").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_50").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_51").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "ATkTtwttT",
 "branch" : 1,
 "id" : "cluster_51_node_1",
 "ic" : "3.64",
 "size" : 9,
 "name" : "cluster_51",
 "image" : "matrix-clustering_aligned_logos/cluster_51_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_51_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m326_kernel_742_number_of_sequence_319", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m326_kernel_742_number_of_sequence_319_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m326_kernel_742_number_of_sequence_319_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m326_kernel_742_number_of_sequence_319_logo.png",
 "name" : "kernel_742_number_of_sequence_319",
 "ic" : "4.76",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AWWYYAAAT"
 },
 {
  "label": "2020-03-04t14-27-25z_m84_kernel_228_number_of_sequence_820", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m84_kernel_228_number_of_sequence_820_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m84_kernel_228_number_of_sequence_820_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m84_kernel_228_number_of_sequence_820_logo.png",
 "name" : "kernel_228_number_of_sequence_820",
 "ic" : "4.07",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AAVWAAMAT"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_51").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#8C69AC");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_51"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#8C69AC"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_51" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#8C69AC")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_51").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_51").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_51").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_51").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_52").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m109_kernel_283_number_of_sequence_6957",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m109_kernel_283_number_of_sequence_6957_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m109_kernel_283_number_of_sequence_6957_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m109_kernel_283_number_of_sequence_6957_logo.png",
 "name" : "kernel_283_number_of_sequence_6957",
 "ic" : "4.81",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMTGSSCYCYCYSC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_52").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9267AA");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_52"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9267AA"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_52" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9267AA")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_52").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_52").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_52").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_52").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_53").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m119_kernel_312_number_of_sequence_5905",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m119_kernel_312_number_of_sequence_5905_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m119_kernel_312_number_of_sequence_5905_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m119_kernel_312_number_of_sequence_5905_logo.png",
 "name" : "kernel_312_number_of_sequence_5905",
 "ic" : "6.25",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGMGGGRMMWRCMGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_53").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9866A8");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_53"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9866A8"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_53" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9866A8")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_53").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_53").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_53").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_53").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_54").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m288_kernel_779_number_of_sequence_9496",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m288_kernel_779_number_of_sequence_9496_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m288_kernel_779_number_of_sequence_9496_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m288_kernel_779_number_of_sequence_9496_logo.png",
 "name" : "kernel_779_number_of_sequence_9496",
 "ic" : "5.74",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYCSTSCSCSSYCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_54").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9D64A6");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_54"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9D64A6"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_54" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9D64A6")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_54").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_54").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_54").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_54").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_55").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m131_kernel_336_number_of_sequence_6081",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m131_kernel_336_number_of_sequence_6081_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m131_kernel_336_number_of_sequence_6081_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m131_kernel_336_number_of_sequence_6081_logo.png",
 "name" : "kernel_336_number_of_sequence_6081",
 "ic" : "6.14",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TSCCCTCCCKGCYSC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_55").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A262A5");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_55"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A262A5"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_55" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A262A5")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_55").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_55").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_55").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_55").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_56").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GssasakG",
 "branch" : 1,
 "id" : "cluster_56_node_1",
 "ic" : "2.75",
 "size" : 8,
 "name" : "cluster_56",
 "image" : "matrix-clustering_aligned_logos/cluster_56_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_56_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m103_kernel_267_number_of_sequence_3168", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m103_kernel_267_number_of_sequence_3168_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m103_kernel_267_number_of_sequence_3168_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m103_kernel_267_number_of_sequence_3168_logo.png",
 "name" : "kernel_267_number_of_sequence_3168",
 "ic" : "3.07",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSKMCRKG"
 },
 {
  "label": "2020-03-04t14-27-25z_m97_kernel_259_number_of_sequence_1647", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m97_kernel_259_number_of_sequence_1647_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m97_kernel_259_number_of_sequence_1647_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m97_kernel_259_number_of_sequence_1647_logo.png",
 "name" : "kernel_259_number_of_sequence_1647",
 "ic" : "4.02",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMWSTKCC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_56").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A75FA3");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_56"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A75FA3"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_56" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A75FA3")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_56").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_56").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_56").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_56").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_57").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GggsycC",
 "branch" : 1,
 "id" : "cluster_57_node_1",
 "ic" : "2.84",
 "size" : 7,
 "name" : "cluster_57",
 "image" : "matrix-clustering_aligned_logos/cluster_57_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_57_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m144_kernel_368_number_of_sequence_6601", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m144_kernel_368_number_of_sequence_6601_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m144_kernel_368_number_of_sequence_6601_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m144_kernel_368_number_of_sequence_6601_logo.png",
 "name" : "kernel_368_number_of_sequence_6601",
 "ic" : "2.61",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGMSCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m282_kernel_759_number_of_sequence_4640", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m282_kernel_759_number_of_sequence_4640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m282_kernel_759_number_of_sequence_4640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m282_kernel_759_number_of_sequence_4640_logo.png",
 "name" : "kernel_759_number_of_sequence_4640",
 "ic" : "2.76",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRRCSCC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_57").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AC5DA1");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_57"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AC5DA1"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_57" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AC5DA1")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_57").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_57").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_57").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_57").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_58").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m98_kernel_261_number_of_sequence_1130",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m98_kernel_261_number_of_sequence_1130_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m98_kernel_261_number_of_sequence_1130_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m98_kernel_261_number_of_sequence_1130_logo.png",
 "name" : "kernel_261_number_of_sequence_1130",
 "ic" : "2.91",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARMMTSA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_58").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B15B9F");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_58"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B15B9F"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_58" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B15B9F")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_58").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_58").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_58").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_58").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_59").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CcsmmwyyT",
 "branch" : 1,
 "id" : "cluster_59_node_1",
 "ic" : "3.25",
 "size" : 9,
 "name" : "cluster_59",
 "image" : "matrix-clustering_aligned_logos/cluster_59_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_59_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m108_kernel_279_number_of_sequence_1145", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m108_kernel_279_number_of_sequence_1145_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m108_kernel_279_number_of_sequence_1145_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m108_kernel_279_number_of_sequence_1145_logo.png",
 "name" : "kernel_279_number_of_sequence_1145",
 "ic" : "3.91",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARSWKTSGG"
 },
 {
  "label": "2020-03-04t14-27-25z_m152_kernel_401_number_of_sequence_1050", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m152_kernel_401_number_of_sequence_1050_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m152_kernel_401_number_of_sequence_1050_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m152_kernel_401_number_of_sequence_1050_logo.png",
 "name" : "kernel_401_number_of_sequence_1050",
 "ic" : "4.06",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARRADKKRG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_59").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B6589D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_59"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B6589D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_59" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B6589D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_59").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_59").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_59").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_59").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_60").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m57_kernel_157_number_of_sequence_1274",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m57_kernel_157_number_of_sequence_1274_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m57_kernel_157_number_of_sequence_1274_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m57_kernel_157_number_of_sequence_1274_logo.png",
 "name" : "kernel_157_number_of_sequence_1274",
 "ic" : "2.56",
 "size" : 6,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "KTKGKT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_60").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BA559C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_60"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BA559C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_60" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BA559C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_60").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_60").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_60").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_60").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_61").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m283_kernel_761_number_of_sequence_9728",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m283_kernel_761_number_of_sequence_9728_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m283_kernel_761_number_of_sequence_9728_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m283_kernel_761_number_of_sequence_9728_logo.png",
 "name" : "kernel_761_number_of_sequence_9728",
 "ic" : "3.16",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARKCSCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_61").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BF539A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_61"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BF539A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_61" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BF539A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_61").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_61").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_61").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_61").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_62").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CtCmssrkywkG",
 "branch" : 1,
 "id" : "cluster_62_node_1",
 "ic" : "4.15",
 "size" : 12,
 "name" : "cluster_62",
 "image" : "matrix-clustering_aligned_logos/cluster_62_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_62_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m165_kernel_440_number_of_sequence_1543", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m165_kernel_440_number_of_sequence_1543_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m165_kernel_440_number_of_sequence_1543_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m165_kernel_440_number_of_sequence_1543_logo.png",
 "name" : "kernel_440_number_of_sequence_1543",
 "ic" : "4.43",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CTYWMARTYKKG"
 },
 {
  "label": "2020-03-04t14-27-25z_m80_kernel_211_number_of_sequence_4230", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m80_kernel_211_number_of_sequence_4230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m80_kernel_211_number_of_sequence_4230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m80_kernel_211_number_of_sequence_4230_logo.png",
 "name" : "kernel_211_number_of_sequence_4230",
 "ic" : "4.98",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMTDMYSSKGAG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_62").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C35098");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_62"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C35098"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_62" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C35098")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_62").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_62").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_62").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_62").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_63").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CdgrGrcssrG",
 "branch" : 1,
 "id" : "cluster_63_node_1",
 "ic" : "3.35",
 "size" : 11,
 "name" : "cluster_63",
 "image" : "matrix-clustering_aligned_logos/cluster_63_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_63_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m122_kernel_318_number_of_sequence_5506", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m122_kernel_318_number_of_sequence_5506_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m122_kernel_318_number_of_sequence_5506_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m122_kernel_318_number_of_sequence_5506_logo.png",
 "name" : "kernel_318_number_of_sequence_5506",
 "ic" : "3.61",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CBSCKSCKCHG"
 },
 {
  "label": "2020-03-04t14-27-25z_m202_kernel_540_number_of_sequence_7296", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m202_kernel_540_number_of_sequence_7296_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m202_kernel_540_number_of_sequence_7296_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m202_kernel_540_number_of_sequence_7296_logo.png",
 "name" : "kernel_540_number_of_sequence_7296",
 "ic" : "4.42",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CRGGGASVSRG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_63").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C84C96");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_63"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C84C96"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_63" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C84C96")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_63").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_63").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_63").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_63").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_64").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GGmctcgsybtsC",
 "branch" : 1,
 "id" : "cluster_64_node_1",
 "ic" : "3.56",
 "size" : 13,
 "name" : "cluster_64",
 "image" : "matrix-clustering_aligned_logos/cluster_64_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_64_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m177_kernel_468_number_of_sequence_9637", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m177_kernel_468_number_of_sequence_9637_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m177_kernel_468_number_of_sequence_9637_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m177_kernel_468_number_of_sequence_9637_logo.png",
 "name" : "kernel_468_number_of_sequence_9637",
 "ic" : "4.08",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GSTSRSMGASBCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m189_kernel_500_number_of_sequence_10227", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m189_kernel_500_number_of_sequence_10227_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m189_kernel_500_number_of_sequence_10227_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m189_kernel_500_number_of_sequence_10227_logo.png",
 "name" : "kernel_500_number_of_sequence_10227",
 "ic" : "4.88",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGAMWGSRAGKCC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_64").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CC4995");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_64"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CC4995"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_64" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CC4995")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_64").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_64").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_64").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_64").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_65").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m219_kernel_597_number_of_sequence_3070",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m219_kernel_597_number_of_sequence_3070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m219_kernel_597_number_of_sequence_3070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m219_kernel_597_number_of_sequence_3070_logo.png",
 "name" : "kernel_597_number_of_sequence_3070",
 "ic" : "2.86",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TYMSAWGT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_65").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D04593");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_65"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D04593"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_65" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D04593")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_65").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_65").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_65").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_65").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_66").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m228_kernel_624_number_of_sequence_6311",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m228_kernel_624_number_of_sequence_6311_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m228_kernel_624_number_of_sequence_6311_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m228_kernel_624_number_of_sequence_6311_logo.png",
 "name" : "kernel_624_number_of_sequence_6311",
 "ic" : "6.27",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AMMWGVKGRGDGGRGRKG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_66").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D54191");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_66"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D54191"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_66" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D54191")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_66").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_66").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_66").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_66").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_67").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m180_kernel_479_number_of_sequence_7131",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m180_kernel_479_number_of_sequence_7131_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m180_kernel_479_number_of_sequence_7131_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m180_kernel_479_number_of_sequence_7131_logo.png",
 "name" : "kernel_479_number_of_sequence_7131",
 "ic" : "5.24",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGCCYYCWGRGSC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_67").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D93D8F");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_67"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D93D8F"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_67" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D93D8F")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_67").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_67").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_67").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_67").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_68").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m29_kernel_74_number_of_sequence_5220",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m29_kernel_74_number_of_sequence_5220_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m29_kernel_74_number_of_sequence_5220_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m29_kernel_74_number_of_sequence_5220_logo.png",
 "name" : "kernel_74_number_of_sequence_5220",
 "ic" : "5.04",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARMKGRGGSS"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_68").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#DD388E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_68"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#DD388E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_68" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#DD388E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_68").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_68").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_68").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_68").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_69").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m309_kernel_837_number_of_sequence_4599",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m309_kernel_837_number_of_sequence_4599_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m309_kernel_837_number_of_sequence_4599_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m309_kernel_837_number_of_sequence_4599_logo.png",
 "name" : "kernel_837_number_of_sequence_4599",
 "ic" : "4.55",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AKGRGMRRGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_69").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E1328C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_69"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E1328C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_69" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E1328C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_69").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_69").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_69").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_69").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_70").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m47_kernel_129_number_of_sequence_2038",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m47_kernel_129_number_of_sequence_2038_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m47_kernel_129_number_of_sequence_2038_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m47_kernel_129_number_of_sequence_2038_logo.png",
 "name" : "kernel_129_number_of_sequence_2038",
 "ic" : "5.64",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCCCYDSWCYBT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_70").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E52C8A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_70"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E52C8A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_70" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E52C8A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_70").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_70").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_70").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_70").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_71").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m46_kernel_126_number_of_sequence_2930",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m46_kernel_126_number_of_sequence_2930_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m46_kernel_126_number_of_sequence_2930_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m46_kernel_126_number_of_sequence_2930_logo.png",
 "name" : "kernel_126_number_of_sequence_2930",
 "ic" : "3.20",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CAGRSWRVKGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_71").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E43187");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_71"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E43187"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_71" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E43187")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_71").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_71").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_71").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_71").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_72").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m34_kernel_89_number_of_sequence_908",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m34_kernel_89_number_of_sequence_908_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m34_kernel_89_number_of_sequence_908_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m34_kernel_89_number_of_sequence_908_logo.png",
 "name" : "kernel_89_number_of_sequence_908",
 "ic" : "4.15",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMYAYTVMRT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_72").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E03D84");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_72"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E03D84"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_72" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E03D84")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_72").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_72").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_72").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_72").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_73").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m315_kernel_850_number_of_sequence_2010",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m315_kernel_850_number_of_sequence_2010_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m315_kernel_850_number_of_sequence_2010_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m315_kernel_850_number_of_sequence_2010_logo.png",
 "name" : "kernel_850_number_of_sequence_2010",
 "ic" : "3.83",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARKGGGWCRG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_73").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#DC4780");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_73"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#DC4780"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_73" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#DC4780")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_73").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_73").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_73").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_73").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_74").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GCssssgsbcsrtyGG",
 "branch" : 1,
 "id" : "cluster_74_node_1",
 "ic" : "5.44",
 "size" : 16,
 "name" : "cluster_74",
 "image" : "matrix-clustering_aligned_logos/cluster_74_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_74_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m121_kernel_316_number_of_sequence_4744", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m121_kernel_316_number_of_sequence_4744_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m121_kernel_316_number_of_sequence_4744_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m121_kernel_316_number_of_sequence_4744_logo.png",
 "name" : "kernel_316_number_of_sequence_4744",
 "ic" : "7.41",
 "size" : 16,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCGCGSGCKYSCSKSG"
 },
 {
  "label": "2020-03-04t14-27-25z_m85_kernel_236_number_of_sequence_12391", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m85_kernel_236_number_of_sequence_12391_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m85_kernel_236_number_of_sequence_12391_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m85_kernel_236_number_of_sequence_12391_logo.png",
 "name" : "kernel_236_number_of_sequence_12391",
 "ic" : "6.01",
 "size" : 16,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCRAYMGGSCSBSSGC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_74").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D74F7C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_74"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D74F7C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_74" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D74F7C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_74").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_74").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_74").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_74").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_75").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m112_kernel_293_number_of_sequence_11260",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m112_kernel_293_number_of_sequence_11260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m112_kernel_293_number_of_sequence_11260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m112_kernel_293_number_of_sequence_11260_logo.png",
 "name" : "kernel_293_number_of_sequence_11260",
 "ic" : "8.15",
 "size" : 17,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSKCSCSGSCSSGSSSG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_75").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D35778");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_75"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D35778"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_75" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D35778")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_75").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_75").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_75").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_75").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_76").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m242_kernel_664_number_of_sequence_5488",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m242_kernel_664_number_of_sequence_5488_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m242_kernel_664_number_of_sequence_5488_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m242_kernel_664_number_of_sequence_5488_logo.png",
 "name" : "kernel_664_number_of_sequence_5488",
 "ic" : "8.49",
 "size" : 19,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSSSSCCSSSCCGGSTSYT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_76").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CF5D74");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_76"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CF5D74"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_76" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CF5D74")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_76").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_76").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_76").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_76").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_77").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m5_kernel_9_number_of_sequence_969",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m5_kernel_9_number_of_sequence_969_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m5_kernel_9_number_of_sequence_969_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m5_kernel_9_number_of_sequence_969_logo.png",
 "name" : "kernel_9_number_of_sequence_969",
 "ic" : "3.49",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TMYCYYAA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_77").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CA6470");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_77"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CA6470"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_77" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CA6470")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_77").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_77").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_77").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_77").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_78").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m78_kernel_208_number_of_sequence_2838",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m78_kernel_208_number_of_sequence_2838_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m78_kernel_208_number_of_sequence_2838_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m78_kernel_208_number_of_sequence_2838_logo.png",
 "name" : "kernel_208_number_of_sequence_2838",
 "ic" : "3.62",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TTYCYYMSAT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_78").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C5696D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_78"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C5696D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_78" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C5696D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_78").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_78").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_78").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_78").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_79").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m264_kernel_709_number_of_sequence_973",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m264_kernel_709_number_of_sequence_973_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m264_kernel_709_number_of_sequence_973_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m264_kernel_709_number_of_sequence_973_logo.png",
 "name" : "kernel_709_number_of_sequence_973",
 "ic" : "4.40",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AWWARGWCAGAWA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_79").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C16F69");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_79"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C16F69"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_79" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C16F69")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_79").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_79").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_79").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_79").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_80").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m226_kernel_618_number_of_sequence_11256",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m226_kernel_618_number_of_sequence_11256_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m226_kernel_618_number_of_sequence_11256_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m226_kernel_618_number_of_sequence_11256_logo.png",
 "name" : "kernel_618_number_of_sequence_11256",
 "ic" : "6.25",
 "size" : 19,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSSTDCYSRGRSCSSSMSG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_80").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BC7465");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_80"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BC7465"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_80" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BC7465")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_80").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_80").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_80").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_80").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_81").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m60_kernel_167_number_of_sequence_5040",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m60_kernel_167_number_of_sequence_5040_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m60_kernel_167_number_of_sequence_5040_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m60_kernel_167_number_of_sequence_5040_logo.png",
 "name" : "kernel_167_number_of_sequence_5040",
 "ic" : "7.73",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCSRTCCSMMCKCCSBSC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_81").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B77860");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_81"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B77860"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_81" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B77860")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_81").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_81").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_81").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_81").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_82").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m17_kernel_54_number_of_sequence_10281",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m17_kernel_54_number_of_sequence_10281_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m17_kernel_54_number_of_sequence_10281_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m17_kernel_54_number_of_sequence_10281_logo.png",
 "name" : "kernel_54_number_of_sequence_10281",
 "ic" : "6.35",
 "size" : 17,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSKSCYYSSWYCCCMMS"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_82").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B27D5C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_82"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B27D5C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_82" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B27D5C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_82").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_82").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_82").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_82").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_83").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m277_kernel_749_number_of_sequence_4981",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m277_kernel_749_number_of_sequence_4981_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m277_kernel_749_number_of_sequence_4981_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m277_kernel_749_number_of_sequence_4981_logo.png",
 "name" : "kernel_749_number_of_sequence_4981",
 "ic" : "5.03",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCBYYCTTCYHTCCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_83").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AD8158");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_83"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AD8158"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_83" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AD8158")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_83").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_83").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_83").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_83").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_84").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m90_kernel_243_number_of_sequence_8335",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m90_kernel_243_number_of_sequence_8335_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m90_kernel_243_number_of_sequence_8335_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m90_kernel_243_number_of_sequence_8335_logo.png",
 "name" : "kernel_243_number_of_sequence_8335",
 "ic" : "5.29",
 "size" : 17,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGGBWBCCHSRRYKCCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_84").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A78554");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_84"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A78554"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_84" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A78554")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_84").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_84").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_84").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_84").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_85").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m14_kernel_49_number_of_sequence_9075",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m14_kernel_49_number_of_sequence_9075_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m14_kernel_49_number_of_sequence_9075_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m14_kernel_49_number_of_sequence_9075_logo.png",
 "name" : "kernel_49_number_of_sequence_9075",
 "ic" : "5.55",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGGCYYYSMGGWWTGMSG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_85").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A2894F");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_85"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A2894F"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_85" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A2894F")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_85").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_85").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_85").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_85").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_86").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m274_kernel_744_number_of_sequence_1913",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m274_kernel_744_number_of_sequence_1913_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m274_kernel_744_number_of_sequence_1913_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m274_kernel_744_number_of_sequence_1913_logo.png",
 "name" : "kernel_744_number_of_sequence_1913",
 "ic" : "4.28",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYCTWMRYYRGRAG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_86").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9C8D4B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_86"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9C8D4B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_86" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9C8D4B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_86").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_86").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_86").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_86").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_87").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "GgCgsgCyC",
 "branch" : 1,
 "id" : "cluster_87_node_1",
 "ic" : "4.73",
 "size" : 9,
 "name" : "cluster_87",
 "image" : "matrix-clustering_aligned_logos/cluster_87_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_87_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m289_kernel_782_number_of_sequence_14563", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m289_kernel_782_number_of_sequence_14563_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m289_kernel_782_number_of_sequence_14563_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m289_kernel_782_number_of_sequence_14563_logo.png",
 "name" : "kernel_782_number_of_sequence_14563",
 "ic" : "4.69",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGCRSKCCC"
 },
 {
  "label": "2020-03-04t14-27-25z_m32_kernel_87_number_of_sequence_4714", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m32_kernel_87_number_of_sequence_4714_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m32_kernel_87_number_of_sequence_4714_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m32_kernel_87_number_of_sequence_4714_logo.png",
 "name" : "kernel_87_number_of_sequence_4714",
 "ic" : "5.74",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GMGSGCG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_87").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#969046");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_87"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#969046"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_87" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#969046")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_87").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_87").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_87").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_87").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_88").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m73_kernel_201_number_of_sequence_4270",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m73_kernel_201_number_of_sequence_4270_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m73_kernel_201_number_of_sequence_4270_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m73_kernel_201_number_of_sequence_4270_logo.png",
 "name" : "kernel_201_number_of_sequence_4270",
 "ic" : "4.48",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYSYGSKKCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_88").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#909441");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_88"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#909441"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_88" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#909441")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_88").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_88").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_88").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_88").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_89").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m86_kernel_237_number_of_sequence_3946",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m86_kernel_237_number_of_sequence_3946_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m86_kernel_237_number_of_sequence_3946_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m86_kernel_237_number_of_sequence_3946_logo.png",
 "name" : "kernel_237_number_of_sequence_3946",
 "ic" : "3.40",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "MYRWGRCYC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_89").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#89973C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_89"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#89973C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_89" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#89973C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_89").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_89").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_89").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_89").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_90").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m235_kernel_639_number_of_sequence_9073",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m235_kernel_639_number_of_sequence_9073_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m235_kernel_639_number_of_sequence_9073_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m235_kernel_639_number_of_sequence_9073_logo.png",
 "name" : "kernel_639_number_of_sequence_9073",
 "ic" : "4.12",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGCWGHKSC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_90").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#829B36");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_90"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#829B36"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_90" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#829B36")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_90").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_90").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_90").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_90").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_91").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "AgrsckcyT",
 "branch" : 1,
 "id" : "cluster_91_node_1",
 "ic" : "2.98",
 "size" : 9,
 "name" : "cluster_91",
 "image" : "matrix-clustering_aligned_logos/cluster_91_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_91_logo_rc.png",

  "children": [
  {
  "label": "2020-03-04t14-27-25z_m105_kernel_274_number_of_sequence_1126", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m105_kernel_274_number_of_sequence_1126_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m105_kernel_274_number_of_sequence_1126_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m105_kernel_274_number_of_sequence_1126_logo.png",
 "name" : "kernel_274_number_of_sequence_1126",
 "ic" : "3.09",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AGAKSYCT"
 },
 {
  "label": "2020-03-04t14-27-25z_m203_kernel_541_number_of_sequence_1977", 
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m203_kernel_541_number_of_sequence_1977_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m203_kernel_541_number_of_sequence_1977_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m203_kernel_541_number_of_sequence_1977_logo.png",
 "name" : "kernel_541_number_of_sequence_1977",
 "ic" : "3.16",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AGGSCKCYT"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_91").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#7B9E30");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_91"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#7B9E30"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_91" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#7B9E30")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_91").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_91").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_91").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_91").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_92").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m39_kernel_103_number_of_sequence_6756",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m39_kernel_103_number_of_sequence_6756_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m39_kernel_103_number_of_sequence_6756_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m39_kernel_103_number_of_sequence_6756_logo.png",
 "name" : "kernel_103_number_of_sequence_6756",
 "ic" : "3.48",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARRMYKBSCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_92").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#73A12A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_92"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#73A12A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_92" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#73A12A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_92").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_92").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_92").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_92").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_93").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m4_kernel_8_number_of_sequence_1311",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m4_kernel_8_number_of_sequence_1311_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m4_kernel_8_number_of_sequence_1311_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m4_kernel_8_number_of_sequence_1311_logo.png",
 "name" : "kernel_8_number_of_sequence_1311",
 "ic" : "4.32",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TYYWAWSTCWG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_93").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#6BA422");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_93"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#6BA422"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_93" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#6BA422")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_93").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_93").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_93").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_93").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_94").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m321_kernel_872_number_of_sequence_3540",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m321_kernel_872_number_of_sequence_3540_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m321_kernel_872_number_of_sequence_3540_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m321_kernel_872_number_of_sequence_3540_logo.png",
 "name" : "kernel_872_number_of_sequence_3540",
 "ic" : "4.73",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CWKYMRWGWSGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_94").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#68A61D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_94"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#68A61D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_94" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#68A61D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_94").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_94").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_94").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_94").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_95").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m143_kernel_364_number_of_sequence_3931",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m143_kernel_364_number_of_sequence_3931_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m143_kernel_364_number_of_sequence_3931_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m143_kernel_364_number_of_sequence_3931_logo.png",
 "name" : "kernel_364_number_of_sequence_3931",
 "ic" : "5.21",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYTRSWSKGSWGSSC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_95").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#6FA61C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_95"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#6FA61C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_95" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#6FA61C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_95").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_95").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_95").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_95").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_96").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m308_kernel_834_number_of_sequence_10347",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m308_kernel_834_number_of_sequence_10347_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m308_kernel_834_number_of_sequence_10347_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m308_kernel_834_number_of_sequence_10347_logo.png",
 "name" : "kernel_834_number_of_sequence_10347",
 "ic" : "6.06",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYSRYRCCGCDGCYCCKC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_96").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#75A71C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_96"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#75A71C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_96" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#75A71C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_96").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_96").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_96").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_96").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_97").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m40_kernel_104_number_of_sequence_5233",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m40_kernel_104_number_of_sequence_5233_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m40_kernel_104_number_of_sequence_5233_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m40_kernel_104_number_of_sequence_5233_logo.png",
 "name" : "kernel_104_number_of_sequence_5233",
 "ic" : "2.63",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AWTSSSGS"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_97").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#7CA71B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_97"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#7CA71B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_97" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#7CA71B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_97").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_97").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_97").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_97").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_98").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m63_kernel_173_number_of_sequence_13852",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m63_kernel_173_number_of_sequence_13852_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m63_kernel_173_number_of_sequence_13852_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m63_kernel_173_number_of_sequence_13852_logo.png",
 "name" : "kernel_173_number_of_sequence_13852",
 "ic" : "2.52",
 "size" : 6,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TKSSKG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_98").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#82A81A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_98"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#82A81A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_98" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#82A81A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_98").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_98").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_98").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_98").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_99").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m38_kernel_99_number_of_sequence_5594",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m38_kernel_99_number_of_sequence_5594_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m38_kernel_99_number_of_sequence_5594_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m38_kernel_99_number_of_sequence_5594_logo.png",
 "name" : "kernel_99_number_of_sequence_5594",
 "ic" : "5.00",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGRKSCYBARSSKRG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_99").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#88A819");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_99"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#88A819"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_99" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#88A819")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_99").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_99").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_99").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_99").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_100").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m185_kernel_490_number_of_sequence_4606",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m185_kernel_490_number_of_sequence_4606_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m185_kernel_490_number_of_sequence_4606_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m185_kernel_490_number_of_sequence_4606_logo.png",
 "name" : "kernel_490_number_of_sequence_4606",
 "ic" : "5.22",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGRGCKGVASAGRG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_100").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#8DA818");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_100"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#8DA818"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_100" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#8DA818")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_100").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_100").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_100").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_100").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_101").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m132_kernel_337_number_of_sequence_4620",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m132_kernel_337_number_of_sequence_4620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m132_kernel_337_number_of_sequence_4620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m132_kernel_337_number_of_sequence_4620_logo.png",
 "name" : "kernel_337_number_of_sequence_4620",
 "ic" : "4.20",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGKMYCASMRBSGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_101").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#93A917");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_101"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#93A917"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_101" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#93A917")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_101").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_101").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_101").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_101").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_102").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m93_kernel_249_number_of_sequence_8045",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m93_kernel_249_number_of_sequence_8045_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m93_kernel_249_number_of_sequence_8045_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m93_kernel_249_number_of_sequence_8045_logo.png",
 "name" : "kernel_249_number_of_sequence_8045",
 "ic" : "4.96",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCSMCCMGSASSG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_102").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#99A916");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_102"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#99A916"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_102" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#99A916")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_102").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_102").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_102").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_102").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_103").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m258_kernel_699_number_of_sequence_5543",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m258_kernel_699_number_of_sequence_5543_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m258_kernel_699_number_of_sequence_5543_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m258_kernel_699_number_of_sequence_5543_logo.png",
 "name" : "kernel_699_number_of_sequence_5543",
 "ic" : "3.76",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCTGYCWGSAG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_103").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9EA915");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_103"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9EA915"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_103" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9EA915")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_103").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_103").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_103").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_103").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_104").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m198_kernel_528_number_of_sequence_1194",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m198_kernel_528_number_of_sequence_1194_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m198_kernel_528_number_of_sequence_1194_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m198_kernel_528_number_of_sequence_1194_logo.png",
 "name" : "kernel_528_number_of_sequence_1194",
 "ic" : "3.45",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GMHKYARKSA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_104").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A4AA14");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_104"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A4AA14"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_104" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A4AA14")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_104").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_104").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_104").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_104").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_105").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m139_kernel_352_number_of_sequence_2332",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m139_kernel_352_number_of_sequence_2332_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m139_kernel_352_number_of_sequence_2332_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m139_kernel_352_number_of_sequence_2332_logo.png",
 "name" : "kernel_352_number_of_sequence_2332",
 "ic" : "3.29",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYSCARMDC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_105").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A9AA13");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_105"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A9AA13"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_105" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A9AA13")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_105").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_105").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_105").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_105").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_106").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m157_kernel_411_number_of_sequence_5341",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m157_kernel_411_number_of_sequence_5341_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m157_kernel_411_number_of_sequence_5341_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m157_kernel_411_number_of_sequence_5341_logo.png",
 "name" : "kernel_411_number_of_sequence_5341",
 "ic" : "3.90",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "SGVRWTTSTGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_106").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AEAA12");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_106"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AEAA12"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_106" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AEAA12")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_106").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_106").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_106").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_106").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_107").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m199_kernel_533_number_of_sequence_449",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m199_kernel_533_number_of_sequence_449_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m199_kernel_533_number_of_sequence_449_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m199_kernel_533_number_of_sequence_449_logo.png",
 "name" : "kernel_533_number_of_sequence_449",
 "ic" : "6.48",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TWAMMYARRWAWWTRRDT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_107").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B4AA11");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_107"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B4AA11"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_107" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B4AA11")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_107").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_107").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_107").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_107").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_108").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m45_kernel_120_number_of_sequence_116",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m45_kernel_120_number_of_sequence_116_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m45_kernel_120_number_of_sequence_116_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m45_kernel_120_number_of_sequence_116_logo.png",
 "name" : "kernel_120_number_of_sequence_116",
 "ic" : "8.59",
 "size" : 20,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TSAYMWAGBVAKWWWGGTKT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_108").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B9AA10");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_108"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B9AA10"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_108" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B9AA10")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_108").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_108").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_108").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_108").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_109").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m302_kernel_822_number_of_sequence_14974",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m302_kernel_822_number_of_sequence_14974_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m302_kernel_822_number_of_sequence_14974_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m302_kernel_822_number_of_sequence_14974_logo.png",
 "name" : "kernel_822_number_of_sequence_14974",
 "ic" : "4.79",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CHKVCCSCYGCACW"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_109").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BEAB0E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_109"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BEAB0E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_109" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BEAB0E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_109").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_109").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_109").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_109").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_110").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m42_kernel_108_number_of_sequence_4281",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m42_kernel_108_number_of_sequence_4281_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m42_kernel_108_number_of_sequence_4281_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m42_kernel_108_number_of_sequence_4281_logo.png",
 "name" : "kernel_108_number_of_sequence_4281",
 "ic" : "4.90",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARRSYCKRGRGRRG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_110").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C3AB0D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_110"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C3AB0D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_110" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C3AB0D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_110").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_110").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_110").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_110").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_111").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m130_kernel_335_number_of_sequence_1948",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m130_kernel_335_number_of_sequence_1948_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m130_kernel_335_number_of_sequence_1948_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m130_kernel_335_number_of_sequence_1948_logo.png",
 "name" : "kernel_335_number_of_sequence_1948",
 "ic" : "5.01",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYYCYTMAMYCCCT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_111").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C9AB0B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_111"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C9AB0B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_111" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C9AB0B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_111").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_111").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_111").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_111").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_112").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m15_kernel_50_number_of_sequence_3413",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m15_kernel_50_number_of_sequence_3413_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m15_kernel_50_number_of_sequence_3413_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m15_kernel_50_number_of_sequence_3413_logo.png",
 "name" : "kernel_50_number_of_sequence_3413",
 "ic" : "5.37",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCACGTSYVYYYC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_112").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CEAB0A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_112"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CEAB0A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_112" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CEAB0A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_112").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_112").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_112").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_112").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_113").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m227_kernel_622_number_of_sequence_2338",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m227_kernel_622_number_of_sequence_2338_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m227_kernel_622_number_of_sequence_2338_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m227_kernel_622_number_of_sequence_2338_logo.png",
 "name" : "kernel_622_number_of_sequence_2338",
 "ic" : "4.15",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GARRRGYMCWRG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_113").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D3AB08");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_113"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D3AB08"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_113" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D3AB08")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_113").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_113").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_113").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_113").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_114").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m248_kernel_674_number_of_sequence_4278",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m248_kernel_674_number_of_sequence_4278_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m248_kernel_674_number_of_sequence_4278_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m248_kernel_674_number_of_sequence_4278_logo.png",
 "name" : "kernel_674_number_of_sequence_4278",
 "ic" : "4.31",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GRRGRSRGMYG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_114").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D8AB06");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_114"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D8AB06"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_114" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D8AB06")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_114").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_114").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_114").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_114").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_115").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m107_kernel_278_number_of_sequence_2148",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m107_kernel_278_number_of_sequence_2148_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m107_kernel_278_number_of_sequence_2148_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m107_kernel_278_number_of_sequence_2148_logo.png",
 "name" : "kernel_278_number_of_sequence_2148",
 "ic" : "4.76",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AGAKGSCWKCKGMGA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_115").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#DDAB04");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_115"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#DDAB04"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_115" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#DDAB04")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_115").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_115").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_115").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_115").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_116").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m94_kernel_250_number_of_sequence_2570",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m94_kernel_250_number_of_sequence_2570_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m94_kernel_250_number_of_sequence_2570_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m94_kernel_250_number_of_sequence_2570_logo.png",
 "name" : "kernel_250_number_of_sequence_2570",
 "ic" : "3.62",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGCARWCCTC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_116").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E2AB03");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_116"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E2AB03"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_116" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E2AB03")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_116").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_116").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_116").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_116").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_117").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m89_kernel_242_number_of_sequence_593",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m89_kernel_242_number_of_sequence_593_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m89_kernel_242_number_of_sequence_593_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m89_kernel_242_number_of_sequence_593_logo.png",
 "name" : "kernel_242_number_of_sequence_593",
 "ic" : "4.40",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CTSMYMDYCYYA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_117").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E5AA02");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_117"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E5AA02"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_117" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E5AA02")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_117").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_117").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_117").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_117").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_118").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m125_kernel_327_number_of_sequence_10216",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m125_kernel_327_number_of_sequence_10216_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m125_kernel_327_number_of_sequence_10216_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m125_kernel_327_number_of_sequence_10216_logo.png",
 "name" : "kernel_327_number_of_sequence_10216",
 "ic" : "3.56",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "SYMSTSHCCHYC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_118").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E2A705");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_118"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E2A705"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_118" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E2A705")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_118").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_118").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_118").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_118").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_119").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m208_kernel_551_number_of_sequence_3861",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m208_kernel_551_number_of_sequence_3861_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m208_kernel_551_number_of_sequence_3861_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m208_kernel_551_number_of_sequence_3861_logo.png",
 "name" : "kernel_551_number_of_sequence_3861",
 "ic" : "3.27",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TYCMTAGGRAHA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_119").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#DFA507");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_119"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#DFA507"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_119" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#DFA507")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_119").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_119").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_119").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_119").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_120").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m300_kernel_808_number_of_sequence_1470",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m300_kernel_808_number_of_sequence_1470_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m300_kernel_808_number_of_sequence_1470_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m300_kernel_808_number_of_sequence_1470_logo.png",
 "name" : "kernel_808_number_of_sequence_1470",
 "ic" : "4.38",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TWDMBSAGDRARA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_120").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#DCA309");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_120"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#DCA309"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_120" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#DCA309")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_120").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_120").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_120").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_120").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_121").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m138_kernel_350_number_of_sequence_1426",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m138_kernel_350_number_of_sequence_1426_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m138_kernel_350_number_of_sequence_1426_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m138_kernel_350_number_of_sequence_1426_logo.png",
 "name" : "kernel_350_number_of_sequence_1426",
 "ic" : "4.44",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CTTCWTTAGRRYA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_121").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D9A00B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_121"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D9A00B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_121" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D9A00B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_121").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_121").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_121").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_121").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_122").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m325_kernel_195_number_of_sequence_221",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m325_kernel_195_number_of_sequence_221_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m325_kernel_195_number_of_sequence_221_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m325_kernel_195_number_of_sequence_221_logo.png",
 "name" : "kernel_195_number_of_sequence_221",
 "ic" : "5.76",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TTTCWKYMGWG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_122").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D79E0D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_122"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D79E0D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_122" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D79E0D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_122").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_122").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_122").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_122").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_123").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m311_kernel_842_number_of_sequence_4117",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m311_kernel_842_number_of_sequence_4117_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m311_kernel_842_number_of_sequence_4117_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m311_kernel_842_number_of_sequence_4117_logo.png",
 "name" : "kernel_842_number_of_sequence_4117",
 "ic" : "4.81",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGCYKSASAKGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_123").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D49C0F");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_123"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D49C0F"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_123" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D49C0F")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_123").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_123").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_123").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_123").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_124").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m65_kernel_175_number_of_sequence_2711",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m65_kernel_175_number_of_sequence_2711_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m65_kernel_175_number_of_sequence_2711_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m65_kernel_175_number_of_sequence_2711_logo.png",
 "name" : "kernel_175_number_of_sequence_2711",
 "ic" : "4.95",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ACSTGCCYMRCGWG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_124").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D19910");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_124"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D19910"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_124" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D19910")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_124").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_124").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_124").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_124").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_125").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m147_kernel_380_number_of_sequence_10271",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m147_kernel_380_number_of_sequence_10271_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m147_kernel_380_number_of_sequence_10271_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m147_kernel_380_number_of_sequence_10271_logo.png",
 "name" : "kernel_380_number_of_sequence_10271",
 "ic" : "4.70",
 "size" : 16,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CWRVWSGGSSAKKSRG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_125").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CE9712");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_125"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CE9712"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_125" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CE9712")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_125").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_125").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_125").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_125").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_126").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m167_kernel_445_number_of_sequence_2158",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m167_kernel_445_number_of_sequence_2158_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m167_kernel_445_number_of_sequence_2158_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m167_kernel_445_number_of_sequence_2158_logo.png",
 "name" : "kernel_445_number_of_sequence_2158",
 "ic" : "6.24",
 "size" : 17,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMMARCCYCKSSWCYKG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_126").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CB9513");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_126"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CB9513"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_126" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CB9513")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_126").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_126").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_126").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_126").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_127").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m25_kernel_69_number_of_sequence_560",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m25_kernel_69_number_of_sequence_560_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m25_kernel_69_number_of_sequence_560_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m25_kernel_69_number_of_sequence_560_logo.png",
 "name" : "kernel_69_number_of_sequence_560",
 "ic" : "6.87",
 "size" : 19,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMAAARKYGWGGRKYYGRA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_127").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C99314");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_127"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C99314"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_127" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C99314")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_127").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_127").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_127").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_127").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_128").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m146_kernel_376_number_of_sequence_2909",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m146_kernel_376_number_of_sequence_2909_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m146_kernel_376_number_of_sequence_2909_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m146_kernel_376_number_of_sequence_2909_logo.png",
 "name" : "kernel_376_number_of_sequence_2909",
 "ic" : "5.73",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AKYRGCGYDRRGWCRGRG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_128").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C69015");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_128"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C69015"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_128" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C69015")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_128").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_128").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_128").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_128").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_129").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m120_kernel_313_number_of_sequence_1947",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m120_kernel_313_number_of_sequence_1947_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m120_kernel_313_number_of_sequence_1947_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m120_kernel_313_number_of_sequence_1947_logo.png",
 "name" : "kernel_313_number_of_sequence_1947",
 "ic" : "5.79",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TSWSTRKSYBTGGKAYDG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_129").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C38E16");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_129"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C38E16"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_129" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C38E16")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_129").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_129").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_129").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_129").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_130").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m99_kernel_263_number_of_sequence_2858",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m99_kernel_263_number_of_sequence_2858_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m99_kernel_263_number_of_sequence_2858_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m99_kernel_263_number_of_sequence_2858_logo.png",
 "name" : "kernel_263_number_of_sequence_2858",
 "ic" : "4.71",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TTCWCYCACGWAGTT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_130").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C08C17");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_130"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C08C17"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_130" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C08C17")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_130").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_130").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_130").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_130").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_131").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m113_kernel_299_number_of_sequence_3070",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m113_kernel_299_number_of_sequence_3070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m113_kernel_299_number_of_sequence_3070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m113_kernel_299_number_of_sequence_3070_logo.png",
 "name" : "kernel_299_number_of_sequence_3070",
 "ic" : "4.09",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARRWKSSRTGYG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_131").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BE8918");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_131"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BE8918"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_131" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BE8918")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_131").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_131").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_131").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_131").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_132").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m312_kernel_844_number_of_sequence_9898",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m312_kernel_844_number_of_sequence_9898_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m312_kernel_844_number_of_sequence_9898_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m312_kernel_844_number_of_sequence_9898_logo.png",
 "name" : "kernel_844_number_of_sequence_9898",
 "ic" : "4.24",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "SSSRMYSGRYT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_132").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BB8718");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_132"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BB8718"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_132" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BB8718")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_132").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_132").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_132").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_132").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_133").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m237_kernel_643_number_of_sequence_8261",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m237_kernel_643_number_of_sequence_8261_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m237_kernel_643_number_of_sequence_8261_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m237_kernel_643_number_of_sequence_8261_logo.png",
 "name" : "kernel_643_number_of_sequence_8261",
 "ic" : "3.58",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AYMGSGSCG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_133").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B88519");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_133"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B88519"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_133" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B88519")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_133").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_133").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_133").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_133").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_134").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m174_kernel_465_number_of_sequence_8025",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m174_kernel_465_number_of_sequence_8025_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m174_kernel_465_number_of_sequence_8025_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m174_kernel_465_number_of_sequence_8025_logo.png",
 "name" : "kernel_465_number_of_sequence_8025",
 "ic" : "2.36",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ASSSKGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_134").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B5831A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_134"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B5831A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_134" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B5831A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_134").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_134").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_134").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_134").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_135").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m230_kernel_627_number_of_sequence_2998",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m230_kernel_627_number_of_sequence_2998_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m230_kernel_627_number_of_sequence_2998_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m230_kernel_627_number_of_sequence_2998_logo.png",
 "name" : "kernel_627_number_of_sequence_2998",
 "ic" : "4.31",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARWYDVAGSSRGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_135").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B3801A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_135"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B3801A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_135" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B3801A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_135").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_135").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_135").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_135").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_136").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m215_kernel_582_number_of_sequence_247",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m215_kernel_582_number_of_sequence_247_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m215_kernel_582_number_of_sequence_247_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m215_kernel_582_number_of_sequence_247_logo.png",
 "name" : "kernel_582_number_of_sequence_247",
 "ic" : "6.99",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYTYRSTBTBYKCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_136").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B07E1B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_136"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B07E1B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_136" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B07E1B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_136").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_136").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_136").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_136").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_137").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m214_kernel_579_number_of_sequence_2259",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m214_kernel_579_number_of_sequence_2259_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m214_kernel_579_number_of_sequence_2259_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m214_kernel_579_number_of_sequence_2259_logo.png",
 "name" : "kernel_579_number_of_sequence_2259",
 "ic" : "3.26",
 "size" : 8,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ARAWWRAG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_137").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AD7C1B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_137"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AD7C1B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_137" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AD7C1B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_137").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_137").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_137").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_137").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_138").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m117_kernel_307_number_of_sequence_2230",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m117_kernel_307_number_of_sequence_2230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m117_kernel_307_number_of_sequence_2230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m117_kernel_307_number_of_sequence_2230_logo.png",
 "name" : "kernel_307_number_of_sequence_2230",
 "ic" : "4.91",
 "size" : 10,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TCYYYSAGCT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_138").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AB7A1C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_138"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AB7A1C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_138" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AB7A1C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_138").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_138").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_138").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_138").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_139").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m284_kernel_763_number_of_sequence_1092",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m284_kernel_763_number_of_sequence_1092_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m284_kernel_763_number_of_sequence_1092_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m284_kernel_763_number_of_sequence_1092_logo.png",
 "name" : "kernel_763_number_of_sequence_1092",
 "ic" : "3.89",
 "size" : 13,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GTRWTBTKRMGHT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_139").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A8771C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_139"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A8771C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_139" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A8771C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_139").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_139").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_139").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_139").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_140").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m96_kernel_254_number_of_sequence_1500",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m96_kernel_254_number_of_sequence_1500_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m96_kernel_254_number_of_sequence_1500_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m96_kernel_254_number_of_sequence_1500_logo.png",
 "name" : "kernel_254_number_of_sequence_1500",
 "ic" : "3.69",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TKWKRKKWKKC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_140").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A5751D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_140"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A5751D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_140" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A5751D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_140").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_140").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_140").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_140").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_141").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m279_kernel_752_number_of_sequence_177",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m279_kernel_752_number_of_sequence_177_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m279_kernel_752_number_of_sequence_177_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m279_kernel_752_number_of_sequence_177_logo.png",
 "name" : "kernel_752_number_of_sequence_177",
 "ic" : "7.13",
 "size" : 16,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TKBATTTWAGCAKBSA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_141").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A37522");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_141"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A37522"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_141" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A37522")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_141").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_141").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_141").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_141").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_142").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m192_kernel_509_number_of_sequence_1169",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m192_kernel_509_number_of_sequence_1169_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m192_kernel_509_number_of_sequence_1169_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m192_kernel_509_number_of_sequence_1169_logo.png",
 "name" : "kernel_509_number_of_sequence_1169",
 "ic" : "5.70",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ATKYWWYHYMKRATSCRG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_142").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A07426");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_142"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A07426"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_142" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A07426")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_142").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_142").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_142").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_142").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_143").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m12_kernel_36_number_of_sequence_4219",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m12_kernel_36_number_of_sequence_4219_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m12_kernel_36_number_of_sequence_4219_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m12_kernel_36_number_of_sequence_4219_logo.png",
 "name" : "kernel_36_number_of_sequence_4219",
 "ic" : "4.19",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TTYMTKCMTYYCMRG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_143").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9E732A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_143"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9E732A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_143" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9E732A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_143").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_143").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_143").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_143").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_144").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m156_kernel_410_number_of_sequence_440",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m156_kernel_410_number_of_sequence_440_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m156_kernel_410_number_of_sequence_440_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m156_kernel_410_number_of_sequence_440_logo.png",
 "name" : "kernel_410_number_of_sequence_440",
 "ic" : "7.85",
 "size" : 20,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TKYYYTYRMWGKWKTTGARG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_144").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9C732E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_144"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9C732E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_144" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9C732E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_144").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_144").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_144").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_144").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_145").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m281_kernel_758_number_of_sequence_1574",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m281_kernel_758_number_of_sequence_1574_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m281_kernel_758_number_of_sequence_1574_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m281_kernel_758_number_of_sequence_1574_logo.png",
 "name" : "kernel_758_number_of_sequence_1574",
 "ic" : "6.16",
 "size" : 19,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYCWTTYMCMWMAYHMAAA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_145").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#997231");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_145"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#997231"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_145" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#997231")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_145").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_145").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_145").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_145").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_146").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m295_kernel_798_number_of_sequence_940",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m295_kernel_798_number_of_sequence_940_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m295_kernel_798_number_of_sequence_940_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m295_kernel_798_number_of_sequence_940_logo.png",
 "name" : "kernel_798_number_of_sequence_940",
 "ic" : "4.27",
 "size" : 12,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AYBSGCWKYCAA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_146").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#977135");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_146"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#977135"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_146" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#977135")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_146").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_146").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_146").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_146").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_147").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m91_kernel_246_number_of_sequence_2198",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m91_kernel_246_number_of_sequence_2198_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m91_kernel_246_number_of_sequence_2198_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m91_kernel_246_number_of_sequence_2198_logo.png",
 "name" : "kernel_246_number_of_sequence_2198",
 "ic" : "4.67",
 "size" : 14,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "AGASGGGSTYWCRA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_147").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#947038");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_147"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#947038"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_147" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#947038")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_147").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_147").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_147").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_147").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_148").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m159_kernel_429_number_of_sequence_2315",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m159_kernel_429_number_of_sequence_2315_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m159_kernel_429_number_of_sequence_2315_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m159_kernel_429_number_of_sequence_2315_logo.png",
 "name" : "kernel_429_number_of_sequence_2315",
 "ic" : "5.36",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TMKVRWSKTYCYCCA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_148").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#92703B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_148"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#92703B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_148" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#92703B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_148").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_148").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_148").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_148").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_149").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m140_kernel_355_number_of_sequence_9742",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m140_kernel_355_number_of_sequence_9742_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m140_kernel_355_number_of_sequence_9742_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m140_kernel_355_number_of_sequence_9742_logo.png",
 "name" : "kernel_355_number_of_sequence_9742",
 "ic" : "6.42",
 "size" : 19,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CCGCTCKKMCKYCAYCTCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_149").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#8F6F3E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_149"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#8F6F3E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_149" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#8F6F3E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_149").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_149").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_149").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_149").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_150").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m18_kernel_56_number_of_sequence_11315",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m18_kernel_56_number_of_sequence_11315_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m18_kernel_56_number_of_sequence_11315_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m18_kernel_56_number_of_sequence_11315_logo.png",
 "name" : "kernel_56_number_of_sequence_11315",
 "ic" : "4.68",
 "size" : 17,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSGSCCCKRMCBRHSKC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_150").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#8D6E42");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_150"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#8D6E42"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_150" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#8D6E42")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_150").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_150").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_150").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_150").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_151").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m265_kernel_716_number_of_sequence_5677",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m265_kernel_716_number_of_sequence_5677_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m265_kernel_716_number_of_sequence_5677_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m265_kernel_716_number_of_sequence_5677_logo.png",
 "name" : "kernel_716_number_of_sequence_5677",
 "ic" : "5.78",
 "size" : 16,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CGCRSSTVVCYGSCGC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_151").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#8A6E44");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_151"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#8A6E44"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_151" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#8A6E44")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_151").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_151").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_151").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_151").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_152").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m236_kernel_640_number_of_sequence_6397",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m236_kernel_640_number_of_sequence_6397_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m236_kernel_640_number_of_sequence_6397_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m236_kernel_640_number_of_sequence_6397_logo.png",
 "name" : "kernel_640_number_of_sequence_6397",
 "ic" : "6.67",
 "size" : 20,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGBCSKKYYAVWTGGSGSCG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_152").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#876D47");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_152"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#876D47"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_152" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#876D47")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_152").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_152").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_152").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_152").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_153").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m266_kernel_717_number_of_sequence_10667",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m266_kernel_717_number_of_sequence_10667_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m266_kernel_717_number_of_sequence_10667_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m266_kernel_717_number_of_sequence_10667_logo.png",
 "name" : "kernel_717_number_of_sequence_10667",
 "ic" : "6.13",
 "size" : 18,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGCYRMAGSYSCGGCCCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_153").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#856C4A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_153"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#856C4A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_153" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#856C4A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_153").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_153").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_153").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_153").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_154").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m67_kernel_177_number_of_sequence_2458",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m67_kernel_177_number_of_sequence_2458_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m67_kernel_177_number_of_sequence_2458_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m67_kernel_177_number_of_sequence_2458_logo.png",
 "name" : "kernel_177_number_of_sequence_2458",
 "ic" : "3.85",
 "size" : 11,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GCSWSTGTKSC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_154").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#826C4D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_154"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#826C4D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_154" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#826C4D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_154").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_154").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_154").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_154").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_155").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m56_kernel_154_number_of_sequence_5023",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m56_kernel_154_number_of_sequence_5023_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m56_kernel_154_number_of_sequence_5023_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m56_kernel_154_number_of_sequence_5023_logo.png",
 "name" : "kernel_154_number_of_sequence_5023",
 "ic" : "3.58",
 "size" : 7,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GASAGDG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_155").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#7F6B50");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_155"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#7F6B50"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_155" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#7F6B50")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_155").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_155").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_155").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_155").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_156").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m28_kernel_72_number_of_sequence_1637",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m28_kernel_72_number_of_sequence_1637_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m28_kernel_72_number_of_sequence_1637_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m28_kernel_72_number_of_sequence_1637_logo.png",
 "name" : "kernel_72_number_of_sequence_1637",
 "ic" : "2.81",
 "size" : 6,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "ATMACT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_156").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#7C6A53");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_156"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#7C6A53"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_156" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#7C6A53")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_156").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_156").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_156").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_156").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_157").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m196_kernel_522_number_of_sequence_7475",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m196_kernel_522_number_of_sequence_7475_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m196_kernel_522_number_of_sequence_7475_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m196_kernel_522_number_of_sequence_7475_logo.png",
 "name" : "kernel_522_number_of_sequence_7475",
 "ic" : "3.80",
 "size" : 9,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGACTYRMC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_157").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#796A55");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_157"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#796A55"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_157" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#796A55")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_157").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_157").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_157").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_157").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_158").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m204_kernel_544_number_of_sequence_5939",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m204_kernel_544_number_of_sequence_5939_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m204_kernel_544_number_of_sequence_5939_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m204_kernel_544_number_of_sequence_5939_logo.png",
 "name" : "kernel_544_number_of_sequence_5939",
 "ic" : "5.85",
 "size" : 19,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CSTSCYCACYYKGYASAGG"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_158").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#766958");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_158"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#766958"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_158" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#766958")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_158").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_158").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_158").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_158").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_159").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m190_kernel_501_number_of_sequence_2346",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m190_kernel_501_number_of_sequence_2346_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m190_kernel_501_number_of_sequence_2346_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m190_kernel_501_number_of_sequence_2346_logo.png",
 "name" : "kernel_501_number_of_sequence_2346",
 "ic" : "5.18",
 "size" : 16,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CMTYTYSWKWGRGRST"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_159").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#73685B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_159"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#73685B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_159" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#73685B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_159").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_159").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_159").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_159").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_160").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m71_kernel_190_number_of_sequence_1121",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m71_kernel_190_number_of_sequence_1121_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m71_kernel_190_number_of_sequence_1121_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m71_kernel_190_number_of_sequence_1121_logo.png",
 "name" : "kernel_190_number_of_sequence_1121",
 "ic" : "6.88",
 "size" : 19,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CTCCWGRGGHMTKRGKKMT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_160").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#70675E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_160"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#70675E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_160" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#70675E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_160").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_160").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_160").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_160").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_161").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m322_kernel_886_number_of_sequence_490",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m322_kernel_886_number_of_sequence_490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m322_kernel_886_number_of_sequence_490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m322_kernel_886_number_of_sequence_490_logo.png",
 "name" : "kernel_886_number_of_sequence_490",
 "ic" : "5.75",
 "size" : 15,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "CYAATKRAWKKHYHT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_161").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#6C6760");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_161"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#6C6760"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_161" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#6C6760")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_161").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_161").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_161").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_161").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_162").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m11_kernel_30_number_of_sequence_2559",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m11_kernel_30_number_of_sequence_2559_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m11_kernel_30_number_of_sequence_2559_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m11_kernel_30_number_of_sequence_2559_logo.png",
 "name" : "kernel_30_number_of_sequence_2559",
 "ic" : "4.92",
 "size" : 17,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "TGCYGCMHTARMTAKCC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_162").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#696663");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_162"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#696663"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_162" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#696663")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_162").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_162").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_162").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_162").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_163").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "2020-03-04t14-27-25z_m13_kernel_48_number_of_sequence_4073",
 
 "image" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m13_kernel_48_number_of_sequence_4073_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m13_kernel_48_number_of_sequence_4073_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/2020-03-04t14-27-25z_m13_kernel_48_number_of_sequence_4073_logo.png",
 "name" : "kernel_48_number_of_sequence_4073",
 "ic" : "2.18",
 "size" : 6,
 "title" : "2020-03-04t14-27-25z",
 "consensus_rc" : "GGYTYT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_163").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#666666");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_163"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 630)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 630 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#666666"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_163" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 615)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#666666")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_163").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_163").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_163").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_163").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	





</script>



<!-- Dynamic JQuery code -->
<script>



d3.select("#cluster_1").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_1") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_1').click(function() {
        $('.show_con_cluster_1').toggle();
    }); 
});



d3.select("#cluster_2").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_2") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_2').click(function() {
        $('.show_con_cluster_2').toggle();
    }); 
});



d3.select("#cluster_3").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_3") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_3').click(function() {
        $('.show_con_cluster_3').toggle();
    }); 
});



d3.select("#cluster_4").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_4") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_4').click(function() {
        $('.show_con_cluster_4').toggle();
    }); 
});



d3.select("#cluster_5").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_5") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_5').click(function() {
        $('.show_con_cluster_5').toggle();
    }); 
});



d3.select("#cluster_6").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_6") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_6').click(function() {
        $('.show_con_cluster_6').toggle();
    }); 
});



d3.select("#cluster_7").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_7") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_7').click(function() {
        $('.show_con_cluster_7').toggle();
    }); 
});



d3.select("#cluster_8").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_8") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_8').click(function() {
        $('.show_con_cluster_8').toggle();
    }); 
});



d3.select("#cluster_9").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_9") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_9').click(function() {
        $('.show_con_cluster_9').toggle();
    }); 
});



d3.select("#cluster_10").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_10") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_10').click(function() {
        $('.show_con_cluster_10').toggle();
    }); 
});



d3.select("#cluster_11").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_11") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_11').click(function() {
        $('.show_con_cluster_11').toggle();
    }); 
});



d3.select("#cluster_12").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_12") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_12').click(function() {
        $('.show_con_cluster_12').toggle();
    }); 
});



d3.select("#cluster_13").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_13") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_13').click(function() {
        $('.show_con_cluster_13').toggle();
    }); 
});



d3.select("#cluster_14").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_14") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_14').click(function() {
        $('.show_con_cluster_14').toggle();
    }); 
});



d3.select("#cluster_15").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_15") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_15').click(function() {
        $('.show_con_cluster_15').toggle();
    }); 
});



d3.select("#cluster_16").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_16") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_16').click(function() {
        $('.show_con_cluster_16').toggle();
    }); 
});



d3.select("#cluster_17").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_17") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_17').click(function() {
        $('.show_con_cluster_17').toggle();
    }); 
});



d3.select("#cluster_18").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_18") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_18').click(function() {
        $('.show_con_cluster_18').toggle();
    }); 
});



d3.select("#cluster_19").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_19") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_19').click(function() {
        $('.show_con_cluster_19').toggle();
    }); 
});



d3.select("#cluster_20").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_20") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_20').click(function() {
        $('.show_con_cluster_20').toggle();
    }); 
});



d3.select("#cluster_21").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_21") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_21').click(function() {
        $('.show_con_cluster_21').toggle();
    }); 
});



d3.select("#cluster_22").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_22") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_22').click(function() {
        $('.show_con_cluster_22').toggle();
    }); 
});



d3.select("#cluster_23").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_23") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_23').click(function() {
        $('.show_con_cluster_23').toggle();
    }); 
});



d3.select("#cluster_24").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_24") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_24').click(function() {
        $('.show_con_cluster_24').toggle();
    }); 
});



d3.select("#cluster_25").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_25") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_25').click(function() {
        $('.show_con_cluster_25').toggle();
    }); 
});



d3.select("#cluster_26").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_26") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_26').click(function() {
        $('.show_con_cluster_26').toggle();
    }); 
});



d3.select("#cluster_27").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_27") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_27').click(function() {
        $('.show_con_cluster_27').toggle();
    }); 
});



d3.select("#cluster_28").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_28") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_28').click(function() {
        $('.show_con_cluster_28').toggle();
    }); 
});



d3.select("#cluster_29").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_29") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_29').click(function() {
        $('.show_con_cluster_29').toggle();
    }); 
});



d3.select("#cluster_30").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_30") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_30').click(function() {
        $('.show_con_cluster_30').toggle();
    }); 
});



d3.select("#cluster_31").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_31") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_31').click(function() {
        $('.show_con_cluster_31').toggle();
    }); 
});



d3.select("#cluster_32").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_32") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_32').click(function() {
        $('.show_con_cluster_32').toggle();
    }); 
});



d3.select("#cluster_33").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_33") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_33').click(function() {
        $('.show_con_cluster_33').toggle();
    }); 
});



d3.select("#cluster_34").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_34") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_34').click(function() {
        $('.show_con_cluster_34').toggle();
    }); 
});



d3.select("#cluster_35").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_35") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_35').click(function() {
        $('.show_con_cluster_35').toggle();
    }); 
});



d3.select("#cluster_36").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_36") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_36').click(function() {
        $('.show_con_cluster_36').toggle();
    }); 
});



d3.select("#cluster_37").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_37") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_37').click(function() {
        $('.show_con_cluster_37').toggle();
    }); 
});



d3.select("#cluster_38").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_38") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_38').click(function() {
        $('.show_con_cluster_38').toggle();
    }); 
});



d3.select("#cluster_39").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_39") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_39').click(function() {
        $('.show_con_cluster_39').toggle();
    }); 
});



d3.select("#cluster_40").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_40") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_40').click(function() {
        $('.show_con_cluster_40').toggle();
    }); 
});



d3.select("#cluster_41").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_41") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_41').click(function() {
        $('.show_con_cluster_41').toggle();
    }); 
});



d3.select("#cluster_42").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_42") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_42').click(function() {
        $('.show_con_cluster_42').toggle();
    }); 
});



d3.select("#cluster_43").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_43") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_43').click(function() {
        $('.show_con_cluster_43').toggle();
    }); 
});



d3.select("#cluster_44").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_44") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_44').click(function() {
        $('.show_con_cluster_44').toggle();
    }); 
});



d3.select("#cluster_45").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_45") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_45').click(function() {
        $('.show_con_cluster_45').toggle();
    }); 
});



d3.select("#cluster_46").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_46") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_46').click(function() {
        $('.show_con_cluster_46').toggle();
    }); 
});



d3.select("#cluster_47").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_47") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_47').click(function() {
        $('.show_con_cluster_47').toggle();
    }); 
});



d3.select("#cluster_48").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_48") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_48').click(function() {
        $('.show_con_cluster_48').toggle();
    }); 
});



d3.select("#cluster_49").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_49") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_49').click(function() {
        $('.show_con_cluster_49').toggle();
    }); 
});



d3.select("#cluster_50").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_50") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_50').click(function() {
        $('.show_con_cluster_50').toggle();
    }); 
});



d3.select("#cluster_51").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_51") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_51').click(function() {
        $('.show_con_cluster_51').toggle();
    }); 
});



d3.select("#cluster_52").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_52") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_52').click(function() {
        $('.show_con_cluster_52').toggle();
    }); 
});



d3.select("#cluster_53").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_53") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_53').click(function() {
        $('.show_con_cluster_53').toggle();
    }); 
});



d3.select("#cluster_54").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_54") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_54').click(function() {
        $('.show_con_cluster_54').toggle();
    }); 
});



d3.select("#cluster_55").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_55") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_55').click(function() {
        $('.show_con_cluster_55').toggle();
    }); 
});



d3.select("#cluster_56").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_56") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_56').click(function() {
        $('.show_con_cluster_56').toggle();
    }); 
});



d3.select("#cluster_57").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_57") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_57').click(function() {
        $('.show_con_cluster_57').toggle();
    }); 
});



d3.select("#cluster_58").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_58") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_58').click(function() {
        $('.show_con_cluster_58').toggle();
    }); 
});



d3.select("#cluster_59").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_59") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_59').click(function() {
        $('.show_con_cluster_59').toggle();
    }); 
});



d3.select("#cluster_60").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_60") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_60').click(function() {
        $('.show_con_cluster_60').toggle();
    }); 
});



d3.select("#cluster_61").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_61") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_61').click(function() {
        $('.show_con_cluster_61').toggle();
    }); 
});



d3.select("#cluster_62").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_62") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_62').click(function() {
        $('.show_con_cluster_62').toggle();
    }); 
});



d3.select("#cluster_63").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_63") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_63').click(function() {
        $('.show_con_cluster_63').toggle();
    }); 
});



d3.select("#cluster_64").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_64") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_64').click(function() {
        $('.show_con_cluster_64').toggle();
    }); 
});



d3.select("#cluster_65").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_65") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_65').click(function() {
        $('.show_con_cluster_65').toggle();
    }); 
});



d3.select("#cluster_66").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_66") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_66').click(function() {
        $('.show_con_cluster_66').toggle();
    }); 
});



d3.select("#cluster_67").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_67") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_67').click(function() {
        $('.show_con_cluster_67').toggle();
    }); 
});



d3.select("#cluster_68").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_68") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_68').click(function() {
        $('.show_con_cluster_68').toggle();
    }); 
});



d3.select("#cluster_69").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_69") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_69').click(function() {
        $('.show_con_cluster_69').toggle();
    }); 
});



d3.select("#cluster_70").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_70") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_70').click(function() {
        $('.show_con_cluster_70').toggle();
    }); 
});



d3.select("#cluster_71").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_71") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_71').click(function() {
        $('.show_con_cluster_71').toggle();
    }); 
});



d3.select("#cluster_72").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_72") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_72').click(function() {
        $('.show_con_cluster_72').toggle();
    }); 
});



d3.select("#cluster_73").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_73") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_73').click(function() {
        $('.show_con_cluster_73').toggle();
    }); 
});



d3.select("#cluster_74").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_74") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_74').click(function() {
        $('.show_con_cluster_74').toggle();
    }); 
});



d3.select("#cluster_75").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_75") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_75').click(function() {
        $('.show_con_cluster_75').toggle();
    }); 
});



d3.select("#cluster_76").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_76") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_76').click(function() {
        $('.show_con_cluster_76').toggle();
    }); 
});



d3.select("#cluster_77").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_77") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_77').click(function() {
        $('.show_con_cluster_77').toggle();
    }); 
});



d3.select("#cluster_78").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_78") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_78').click(function() {
        $('.show_con_cluster_78').toggle();
    }); 
});



d3.select("#cluster_79").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_79") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_79').click(function() {
        $('.show_con_cluster_79').toggle();
    }); 
});



d3.select("#cluster_80").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_80") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_80').click(function() {
        $('.show_con_cluster_80').toggle();
    }); 
});



d3.select("#cluster_81").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_81") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_81').click(function() {
        $('.show_con_cluster_81').toggle();
    }); 
});



d3.select("#cluster_82").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_82") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_82').click(function() {
        $('.show_con_cluster_82').toggle();
    }); 
});



d3.select("#cluster_83").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_83") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_83').click(function() {
        $('.show_con_cluster_83').toggle();
    }); 
});



d3.select("#cluster_84").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_84") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_84').click(function() {
        $('.show_con_cluster_84').toggle();
    }); 
});



d3.select("#cluster_85").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_85") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_85').click(function() {
        $('.show_con_cluster_85').toggle();
    }); 
});



d3.select("#cluster_86").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_86") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_86').click(function() {
        $('.show_con_cluster_86').toggle();
    }); 
});



d3.select("#cluster_87").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_87") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_87').click(function() {
        $('.show_con_cluster_87').toggle();
    }); 
});



d3.select("#cluster_88").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_88") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_88').click(function() {
        $('.show_con_cluster_88').toggle();
    }); 
});



d3.select("#cluster_89").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_89") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_89').click(function() {
        $('.show_con_cluster_89').toggle();
    }); 
});



d3.select("#cluster_90").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_90") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_90').click(function() {
        $('.show_con_cluster_90').toggle();
    }); 
});



d3.select("#cluster_91").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_91") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_91').click(function() {
        $('.show_con_cluster_91').toggle();
    }); 
});



d3.select("#cluster_92").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_92") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_92').click(function() {
        $('.show_con_cluster_92').toggle();
    }); 
});



d3.select("#cluster_93").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_93") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_93').click(function() {
        $('.show_con_cluster_93').toggle();
    }); 
});



d3.select("#cluster_94").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_94") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_94').click(function() {
        $('.show_con_cluster_94').toggle();
    }); 
});



d3.select("#cluster_95").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_95") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_95').click(function() {
        $('.show_con_cluster_95').toggle();
    }); 
});



d3.select("#cluster_96").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_96") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_96').click(function() {
        $('.show_con_cluster_96').toggle();
    }); 
});



d3.select("#cluster_97").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_97") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_97').click(function() {
        $('.show_con_cluster_97').toggle();
    }); 
});



d3.select("#cluster_98").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_98") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_98').click(function() {
        $('.show_con_cluster_98').toggle();
    }); 
});



d3.select("#cluster_99").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_99") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_99').click(function() {
        $('.show_con_cluster_99').toggle();
    }); 
});



d3.select("#cluster_100").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_100") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_100').click(function() {
        $('.show_con_cluster_100').toggle();
    }); 
});



d3.select("#cluster_101").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_101") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_101').click(function() {
        $('.show_con_cluster_101').toggle();
    }); 
});



d3.select("#cluster_102").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_102") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_102').click(function() {
        $('.show_con_cluster_102').toggle();
    }); 
});



d3.select("#cluster_103").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_103") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_103').click(function() {
        $('.show_con_cluster_103').toggle();
    }); 
});



d3.select("#cluster_104").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_104") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_104').click(function() {
        $('.show_con_cluster_104').toggle();
    }); 
});



d3.select("#cluster_105").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_105") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_105').click(function() {
        $('.show_con_cluster_105').toggle();
    }); 
});



d3.select("#cluster_106").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_106") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_106').click(function() {
        $('.show_con_cluster_106').toggle();
    }); 
});



d3.select("#cluster_107").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_107") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_107').click(function() {
        $('.show_con_cluster_107').toggle();
    }); 
});



d3.select("#cluster_108").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_108") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_108').click(function() {
        $('.show_con_cluster_108').toggle();
    }); 
});



d3.select("#cluster_109").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_109") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_109').click(function() {
        $('.show_con_cluster_109').toggle();
    }); 
});



d3.select("#cluster_110").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_110") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_110').click(function() {
        $('.show_con_cluster_110').toggle();
    }); 
});



d3.select("#cluster_111").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_111") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_111').click(function() {
        $('.show_con_cluster_111').toggle();
    }); 
});



d3.select("#cluster_112").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_112") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_112').click(function() {
        $('.show_con_cluster_112').toggle();
    }); 
});



d3.select("#cluster_113").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_113") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_113').click(function() {
        $('.show_con_cluster_113').toggle();
    }); 
});



d3.select("#cluster_114").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_114") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_114').click(function() {
        $('.show_con_cluster_114').toggle();
    }); 
});



d3.select("#cluster_115").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_115") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_115').click(function() {
        $('.show_con_cluster_115').toggle();
    }); 
});



d3.select("#cluster_116").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_116") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_116').click(function() {
        $('.show_con_cluster_116').toggle();
    }); 
});



d3.select("#cluster_117").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_117") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_117').click(function() {
        $('.show_con_cluster_117').toggle();
    }); 
});



d3.select("#cluster_118").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_118") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_118').click(function() {
        $('.show_con_cluster_118').toggle();
    }); 
});



d3.select("#cluster_119").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_119") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_119').click(function() {
        $('.show_con_cluster_119').toggle();
    }); 
});



d3.select("#cluster_120").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_120") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_120').click(function() {
        $('.show_con_cluster_120').toggle();
    }); 
});



d3.select("#cluster_121").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_121") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_121').click(function() {
        $('.show_con_cluster_121').toggle();
    }); 
});



d3.select("#cluster_122").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_122") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_122').click(function() {
        $('.show_con_cluster_122').toggle();
    }); 
});



d3.select("#cluster_123").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_123") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_123').click(function() {
        $('.show_con_cluster_123').toggle();
    }); 
});



d3.select("#cluster_124").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_124") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_124').click(function() {
        $('.show_con_cluster_124').toggle();
    }); 
});



d3.select("#cluster_125").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_125") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_125').click(function() {
        $('.show_con_cluster_125').toggle();
    }); 
});



d3.select("#cluster_126").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_126") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_126').click(function() {
        $('.show_con_cluster_126').toggle();
    }); 
});



d3.select("#cluster_127").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_127") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_127').click(function() {
        $('.show_con_cluster_127').toggle();
    }); 
});



d3.select("#cluster_128").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_128") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_128').click(function() {
        $('.show_con_cluster_128').toggle();
    }); 
});



d3.select("#cluster_129").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_129") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_129').click(function() {
        $('.show_con_cluster_129').toggle();
    }); 
});



d3.select("#cluster_130").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_130") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_130').click(function() {
        $('.show_con_cluster_130').toggle();
    }); 
});



d3.select("#cluster_131").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_131") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_131').click(function() {
        $('.show_con_cluster_131').toggle();
    }); 
});



d3.select("#cluster_132").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_132") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_132').click(function() {
        $('.show_con_cluster_132').toggle();
    }); 
});



d3.select("#cluster_133").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_133") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_133').click(function() {
        $('.show_con_cluster_133').toggle();
    }); 
});



d3.select("#cluster_134").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_134") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_134').click(function() {
        $('.show_con_cluster_134').toggle();
    }); 
});



d3.select("#cluster_135").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_135") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_135').click(function() {
        $('.show_con_cluster_135').toggle();
    }); 
});



d3.select("#cluster_136").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_136") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_136').click(function() {
        $('.show_con_cluster_136').toggle();
    }); 
});



d3.select("#cluster_137").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_137") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_137').click(function() {
        $('.show_con_cluster_137').toggle();
    }); 
});



d3.select("#cluster_138").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_138") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_138').click(function() {
        $('.show_con_cluster_138').toggle();
    }); 
});



d3.select("#cluster_139").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_139") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_139').click(function() {
        $('.show_con_cluster_139').toggle();
    }); 
});



d3.select("#cluster_140").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_140") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_140').click(function() {
        $('.show_con_cluster_140').toggle();
    }); 
});



d3.select("#cluster_141").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_141") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_141').click(function() {
        $('.show_con_cluster_141').toggle();
    }); 
});



d3.select("#cluster_142").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_142") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_142').click(function() {
        $('.show_con_cluster_142').toggle();
    }); 
});



d3.select("#cluster_143").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_143") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_143').click(function() {
        $('.show_con_cluster_143').toggle();
    }); 
});



d3.select("#cluster_144").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_144") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_144').click(function() {
        $('.show_con_cluster_144').toggle();
    }); 
});



d3.select("#cluster_145").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_145") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_145').click(function() {
        $('.show_con_cluster_145').toggle();
    }); 
});



d3.select("#cluster_146").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_146") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_146').click(function() {
        $('.show_con_cluster_146').toggle();
    }); 
});



d3.select("#cluster_147").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_147") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_147').click(function() {
        $('.show_con_cluster_147').toggle();
    }); 
});



d3.select("#cluster_148").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_148") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_148').click(function() {
        $('.show_con_cluster_148').toggle();
    }); 
});



d3.select("#cluster_149").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_149") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_149').click(function() {
        $('.show_con_cluster_149').toggle();
    }); 
});



d3.select("#cluster_150").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_150") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_150').click(function() {
        $('.show_con_cluster_150').toggle();
    }); 
});



d3.select("#cluster_151").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_151") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_151').click(function() {
        $('.show_con_cluster_151').toggle();
    }); 
});



d3.select("#cluster_152").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_152") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_152').click(function() {
        $('.show_con_cluster_152').toggle();
    }); 
});



d3.select("#cluster_153").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_153") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_153').click(function() {
        $('.show_con_cluster_153').toggle();
    }); 
});



d3.select("#cluster_154").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_154") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_154').click(function() {
        $('.show_con_cluster_154').toggle();
    }); 
});



d3.select("#cluster_155").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_155") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_155').click(function() {
        $('.show_con_cluster_155').toggle();
    }); 
});



d3.select("#cluster_156").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_156") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_156').click(function() {
        $('.show_con_cluster_156').toggle();
    }); 
});



d3.select("#cluster_157").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_157") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_157').click(function() {
        $('.show_con_cluster_157').toggle();
    }); 
});



d3.select("#cluster_158").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_158") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_158').click(function() {
        $('.show_con_cluster_158').toggle();
    }); 
});



d3.select("#cluster_159").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_159") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_159').click(function() {
        $('.show_con_cluster_159').toggle();
    }); 
});



d3.select("#cluster_160").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_160") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_160').click(function() {
        $('.show_con_cluster_160').toggle();
    }); 
});



d3.select("#cluster_161").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_161") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_161').click(function() {
        $('.show_con_cluster_161').toggle();
    }); 
});



d3.select("#cluster_162").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_162") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_162').click(function() {
        $('.show_con_cluster_162').toggle();
    }); 
});



d3.select("#cluster_163").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_163") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_163').click(function() {
        $('.show_con_cluster_163').toggle();
    }); 
});



</script>
